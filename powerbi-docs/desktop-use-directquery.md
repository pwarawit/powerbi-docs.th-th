---
title: ใช้ DirectQuery ใน Power BI Desktop
description: ใช้ DirectQuery หรือที่เรียกว่า การเชื่อมต่อสด ใน Power BI Desktop
author: davidiseminger
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-desktop
ms.topic: conceptual
ms.date: 12/18/2019
ms.author: davidi
LocalizationGroup: Connect to data
ms.openlocfilehash: cfde935b2cec6e86b56b4f70865ff2d02b5ce27a
ms.sourcegitcommit: 97597ff7d9ac2c08c364ecf0c729eab5d59850ce
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 01/09/2020
ms.locfileid: "75759210"
---
# <a name="use-directquery-in-power-bi-desktop"></a>ใช้ DirectQuery ใน Power BI Desktop
ด้วย *Power BI Desktop* เมื่อคุณเชื่อมต่อกับแหล่งข้อมูลของคุณ คุณสามารถนำเข้าสำเนาของข้อมูลลงใน Power BI Desktop ได้ สำหรับบางแหล่งข้อมูล คุณสามารถเลือกวิธีการอื่นได้: เชื่อมต่อโดยตรงกับแหล่งข้อมูลโดยใช้ DirectQuery

## <a name="supported-data-sources"></a>แหล่งข้อมูลที่ได้รับการสนับสนุน
สำหรับรายการของแหล่งข้อมูลที่สนับสนุน DirectQuery โปรดดู[แหล่งข้อมูลที่ DirectQuery สนับสนุน](power-bi-data-sources.md)

## <a name="how-to-connect-using-directquery"></a>วิธีการเชื่อมต่อโดยใช้ DirectQuery
เมื่อคุณใช้**รับข้อมูล**เพื่อเชื่อมต่อกับแหล่งข้อมูลที่ได้รับการสนับสนุนโดย DirectQuery กล่องโต้ตอบการเชื่อมต่อจะช่วยให้คุณสามารถเลือกวิธีที่คุณต้องการจะเชื่อมต่อ ตัวอย่างเช่นใน Power BI Desktop ภายใต้ ribbon **Home** เลือก **รับข้อมูล** > **SQL Server** ในกล่องโต้ตอบ **SQL Server Database** **โหมดการเชื่อมต่อข้อมูล** แสดงตัวเลือกของ **นำเข้า** และ **DirectQuery**:

![ตัวเลือกนำเข้าและ DirectQuery, กล่องโต้ตอบ SQL Server Database, Power BI Desktop](media/desktop-use-directquery/directquery_sqlserverdb.png)

ต่อไปนี้คือความแตกต่างระหว่างการเลือก**นำเข้า**และ **DirectQuery** มีดังนี้:

- **นำเข้า**: มีการนำเข้าตารางและคอลัมน์ที่เลือกลงใน Power BI Desktop เมื่อคุณสร้างหรือโต้ตอบกับภาพข้อมูล Power BI Desktop จะใช้ข้อมูลที่นำเข้า เพื่อดูการเปลี่ยนแปลงใดๆ ที่เกิดขึ้นกับข้อมูลเบื้องต้น ตั้งแต่การนำเข้าเริ่มต้นหรือการรีเฟรชล่าสุด คุณต้องรีเฟรชข้อมูล ซึ่งจะนำเข้าชุดข้อมูลเต็มรูปแบบอีกครั้ง

- **DirectQuery**: ไม่มีการนำเข้าหรือคัดลอกข้อมูลลงใน Power BI Desktop สำหรับแหล่งข้อมูลเชิงสัมพันธ์ จะปรากฏตารางและคอลัมน์ที่เลือกในรายการ**เขตข้อมูล** สำหรับแหล่งข้อมูลหลายมิติ เช่น SAP Business Warehouse มิติและการวัดของคิวบ์ที่ถูกเลือกจะปรากฏในรายการ**เขตข้อมูล** เมื่อคุณสร้างหรือโต้ตอบกับภาพข้อมูล Power BI Desktop จะคิวรีแหล่งข้อมูลเบื้องต้น ซึ่งหมายความว่า คุณกำลังดูข้อมูลที่เป็นปัจจุบันอยู่เสมอ

แบบจำลองข้อมูลและการแปลงข้อมูลจำนวนมากมีพร้อมให้บริการเมื่อใช้ DirectQuery แม้ว่าจะมีข้อจำกัดบ้าง เมื่อคุณสร้างหรือโต้ตอบกับภาพข้อมูล คุณต้องคิวรีแหล่งข้อมูลเบื้องต้น เวลาที่จำเป็นต้องรีเฟรชภาพข้อมูล จะขึ้นอยู่กับประสิทธิภาพของแหล่งข้อมูลเบื้องต้น เมื่อมีการร้องขอข้อมูลที่ให้บริการ Power BI Desktop ใช้ข้อมูลล่าสุดเพื่อลดเวลาที่ใช้ประมวลการแสดงภาพข้อมูล หากคุณเลือก**รีเฟรช**จาก ribbon ของ**Home** จะทำให้ภาพข้อมูลทั้งหมดถูกรีเฟรชด้วยข้อมูลปัจจุบัน

บทความ [Power BI และ DirectQuery](desktop-directquery-about.md) อธิบายเรื่อง DirectQuery โดยละเอียด สำหรับข้อมูลเพิ่มเติมเกี่ยวกับข้อดี ข้อจำกัด และข้อควรพิจารณาสำคัญเมื่อใช้ DirectQuery โปรดดูส่วนต่อไปนี้

## <a name="benefits-of-using-directquery"></a>ข้อดีของการใช้ DirectQuery
ประโยชน์บางอย่างเมื่อใช้ DirectQuery:

- DirectQuery ช่วยให้คุณสามารถสร้างภาพข้อมูลจากชุดข้อมูลที่มีขนาดใหญ่มาก ซึ่งตามปกติแล้ว การนำเข้าข้อมูลขนาดใหญ่ที่มีการรวมข้อมูลไว้ก่อนในตอนแรกอาจทำได้ยาก
- การเปลี่ยนแปลงข้อมูลเบื้องต้นอาจจำเป็นต้องมีการรีเฟรชข้อมูล สำหรับรายงานบางอย่าง การแสดงข้อมูลปัจจุบันอาจต้องมีการถ่ายโอนข้อมูลขนาดใหญ่ ซึ่งอาจทำใหไม่สามารถนำเข้าข้อมูลอีกครั้งได้ ในทางตรงกันข้าม รายงาน DirectQuery มักใช้ข้อมูลปัจจุบันเสมอ
- ข้อจำกัดของชุดข้อมูลที่ 1 GB *ไม่สามารถ* ใช้กับ DirectQuery ได้

## <a name="limitations-of-directquery"></a>ขีดจำกัดของ DirectQuery
ปัจจุบัน มีข้อจำกัดบางประการในการใช้ DirectQuery ดังนี้:

- ตารางทั้งหมดต้องมาจากฐานข้อมูลเดียว เว้นแต่ว่าใช้ [โมเดลแบบรวม](desktop-composite-models.md)

- ถ้าคิวรีของ**ตัวแก้ไขคิวรี**ซับซ้อนเกินไป จะเกิดข้อผิดพลาด เมื่อต้องแก้ไขข้อผิดพลาด คุณต้องลบในขั้นตอนที่มีปัญหาใน**ตัวแก้ไขคิวรี**หรือ*นำเข้า*ข้อมูลแทนที่จะใช้ DirectQuery สำหรับแหล่งข้อมูลหลายมิติ เช่น SAP Business Warehouse ไม่มี**ตัวแก้ไขคิวรี**

- ความสามารถด้านเวลาจะไม่พร้อมใช้งานใน DirectQuery ตัวอย่างเช่น การจัดการพิเศษของคอลัมน์วันที่ (เช่น ปี ไตรมาส เดือน หรือวัน) ไม่รองรับในโหมด DirectQuery

- ข้อจำกัดจะถูกใส่ไว้ในนิพจน์ DAX ที่ได้รับอนุญาตในหน่วยวัดเพื่อให้แน่ใจว่าคิวรีที่ส่งไปยังแหล่งข้อมูลเบื้องต้นมีประสิทธิภาพที่ยอมรับได้

- มีข้อจำกัดของแถวที่ 1 ล้านแถวสำหรับการส่งคืนข้อมูลเมื่อใช้ DirectQuery ข้อจำกัดนี้ไม่มีผลต่อการรวมหรือการคำนวณที่ใช้ในการสร้างชุดข้อมูลที่ DirectQuery ส่งค่ากลับคืน เฉพาะแถวเท่านั้นที่จะถูกส่งคืน

    ตัวอย่างเช่น คุณสามารถรวมแถว 10,000,000 แถวกับคิวรีของคุณที่เปิดใช้งานบนแหล่งข้อมูลของคุณได้ คิวรีจะแสดงผลลัพธ์ของการรวมดังกล่าวไปยัง Power BI อย่างถูกต้องแม่นยำโดยใช้ DirectQuery หากข้อมูล Power BI ที่แสดงน้อยกว่า 1,000,000 แถว หากมีการแสดงแถวมากกว่า 1,000,000 แถวจาก DirectQuery Power BI จะแสดงข้อผิดพลาด

## <a name="important-considerations-when-using-directquery"></a>ข้อควรพิจารณาเมื่อใช้ DirectQuery
ควรคำนึงถึงสามข้อต่อไปนี้เมื่อใช้ DirectQuery:

- **ประสิทธิภาพและภาระ**: คำขอ DirectQuery ทั้งหมดจะถูกส่งไปยังฐานข้อมูลต้นฉบับ ดังนั้นเวลาที่ใช้รีเฟรชภาพข้อมูลจะขึ้นอยู่กับความยาวนานที่แหล่งข้อมูล back-end ใช้เพื่อตอบสนองกับผลลัพธ์จากคิวรี ห้าวินาทีหรือน้อยกว่า เป็นเวลาตอบสนองที่แนะนำ (พร้อมข้อมูลที่ร้องขอที่แสดง) สำหรับการใช้ DirectQuery สำหรับวิชวล โดยเวลาที่แนะนำสูงสุดคือ 30 วินาที ยิ่งนานเท่าไร ผู้ใช้รายงานก็จะรู้สึกไม่พอใจ หลังจากตีพิมพ์รายงานไปยังบริการของ Power BI คิวรีที่ใช้เวลานานกว่าสองสามนาทีจะหมดเวลา และผู้ใช้จะได้รับข้อผิดพลาด
  
    ภาระต่อฐานข้อมูลต้นฉบับก็เป็นเรื่องที่ควรพิจารณา ทั้งนี้ขึ้นอยู่กับจำนวนผู้ใช้ Power BI ที่จะใช้รายงานที่ตีพิมพ์ การใช้ **การรักษาความปลอดภัยระดับแถว** (RLS) อาจมีผลกระทบที่สำคัญเช่นกัน ไทล์แดชบอร์ดที่ไม่ใช่ RLS ที่ใช้ร่วมกันโดยผู้ใช้หลายคน จะแสดงผลลัพธ์ในคิวรีเดียวไปยังฐานข้อมูล อย่างไรก็ตาม การใช้ RLS บนไทล์แดชบอร์ด หมายความว่า การรีเฟรชไทล์จำเป็นต้องมีหนึ่งคิวรี*ต่อผู้ใช้* ซึ่งจะเพิ่มโหลดอย่างมากต่อฐานข้อมูลต้นฉบับและอาจส่งผลต่อประสิทธิภาพการทำงานด้วย
  
    Power BI สร้างคิวรีที่มีประสิทธิภาพเท่าที่เป็นไปได้ ในบางกรณี คิวรีที่สร้างอาจไม่มีประสิทธิภาพเพียงพอและจึงอาจทำให้การรีเฟรชล้มเหลว ตัวอย่างหนึ่งของสถานการณ์นี้คือ เมื่อคิวรีที่สร้างขึ้นค้นคืนจำนวนแถวที่มากเกินไปจากแหล่งข้อมูล back-end ซึ่งในกรณีดังกล่าวจะเกิดข้อผิดพลาดต่อไปนี้:

    ```output
    The resultset of a query to external data source has exceeded
    ```
  
    สถานการณ์นี้อาจเกิดขึ้นได้กับแผนภูมิแบบง่ายๆ ที่มีแถวในคอลัมน์หนึ่งๆ อย่างมาก โดยมีตัวเลือกการรวมกำหนดเป็น**อย่าสรุป** ภาพจะมีคอลัมน์ที่มีแถวต่ำกว่า 1 ล้านหรือต้องมีการใช้ตัวกรองที่เหมาะสม

- **ความปลอดภัย**: ตามค่าเริ่มต้น ผู้ใช้ทั้งหมดที่ใช้รายงานที่เผยแพร่จะเชื่อมต่อกับแหล่งข้อมูล back-end โดยใช้ข้อมูลประจำตัวที่ถูกป้อนหลังจากการเผยแพร่ไปยังบริการ Power BI กระบวนการนี้เป็นแบบเดียวกันสำหรับข้อมูลที่นำเข้า: ผู้ใช้ทุกคนเห็นข้อมูลเดียวกันโดยไม่คำนึงถึงกฎความปลอดภัยใดๆ ที่กำหนดไว้ในแหล่งข้อมูล backend

    ลูกค้าที่ต้องการนำความปลอดภัยต่อผู้ใช้ไปใช้กับแหล่งข้อมูล DirectQuery ควรใช้ RLS หรือกำหนดค่าการรับรองความถูกต้องแบบจำกัดของ Kerberos กับแหล่งข้อมูล Kerberos ไม่สามารถใช้ได้กับทุกแหล่งข้อมูล [เรียนรู้เพิ่มเติมเกี่ยวกับ RLS](service-admin-rls.md) [เรียนรู้เพิ่มเติมเกี่ยวกับ Kerberos ใน DirectQuery](service-gateway-sso-kerberos.md)

- **คุณลักษณะที่ได้รับการสนับสนุน**: คุณลักษณะบางอย่างใน Power BI Desktop ไม่ได้รับการสนับสนุนในโหมด DirectQuery หรือมีข้อจำกัด นอกจากนี้ ความสามารถบางอย่างในบริการ Power BI (เช่น *ข้อมูลเชิงลึกด่วน*) ไม่สามารถใช้งานได้สำหรับชุดข้อมูลที่ใช้ DirectQuery เมื่อต้องพิจารณาว่าจะใช้ DirectQuery หรือไม่ คุณควรพิจารณาข้อจำกัดของคุณลักษณะเหล่านี้ด้วย

## <a name="publish-to-the-power-bi-service"></a>เผยแพร่ไปยังบริการ Power BI
รายงานที่สร้างขึ้นโดยใช้ DirectQuery สามารถเผยแพร่ไปยังบริการของ Power BI ได้

หากแหล่งข้อมูลที่ใช้ไม่จำเป็นต้องใช้ **เกตเวย์ข้อมูลในองค์กร** (**Azure SQL Database**, **Azure SQL Data Warehouse** หรือ **Redshift**) คุณต้องให้ข้อมูลประจำตัวก่อนที่บริการ Power BI จะแสดงรายงานที่แผยแพร่ การระบุข้อมูลประจำตัว โปรดทำตามคำแนะนำต่อไปนี้:

1. ลงชื่อเข้าใช้ [Power BI](https://www.powerbi.com/)
2. ในบริการ Power BI เลือกไอคอนรูปเฟือง **การตั้งค่า** และเลือกหน่วยข้อมูลเมนู **การตั้งค่า**

    ![การตั้งค่า, บริการของ Power BI](media/desktop-use-directquery/directquery_pbiservicesettings.png)

3. ในหน้า **การตั้งค่า** ของบริการ Power BI เลือกแท็บ **ชุดข้อมูล** เลือกชุดข้อมูลที่ใช้ DirectQuery และเลือก **แก้ไขข้อมูลประจำตัว**

4. เพิ่มข้อมูลประจำตัว มิฉะนั้น ข้อผิดพลาดจะเกิดขึ้นเมื่อคุณเปิดรายงานที่เผยแพร่หรือสำรวจชุดข้อมูลที่สร้างขึ้นด้วยการเชื่อมต่อ DirectQuery

เมื่อต้องการทำการเชื่อมต่อข้อมูลสำหรับแหล่งข้อมูลอื่นที่ไม่ใช่ **Azure SQL Database**, **Azure SQL Data Warehouse** และ **Redshift** ที่ใช้ DirectQuery ต้องติดตั้ง**เกตเวย์ข้อมูลภายในองค์กร**และต้องลงทะเบียนแหล่งข้อมูล สำหรับข้อมูลเพิ่มเติม ดูที่ [เกตเวย์ข้อมูลภายในองค์กรคืออะไร](service-gateway-onprem.md)

## <a name="next-steps"></a>ขั้นตอนถัดไป
สำหรับข้อมูลเพิ่มเติมเกี่ยวกับ DirectQuery โปรดดูที่ทรัพยากรดังต่อไปนี้:

- [การใช้ DirectQuery ใน Power BI](desktop-directquery-about.md)
- [แหล่งข้อมูลที่สนับสนุนโดย DirectQuery](power-bi-data-sources.md)
- [DirectQuery และ SAP Business Warehouse (BW)](desktop-directquery-sap-bw.md)
- [DirectQuery และ SAP HANA](desktop-directquery-sap-hana.md)
- [เกตเวย์ข้อมูลภายในองค์กรคืออะไร](service-gateway-onprem.md)
