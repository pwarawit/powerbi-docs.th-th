---
title: จัดการแหล่งข้อมูลของคุณ - Analysis Services
description: วิธีการจัดการเกตเวย์ข้อมูลภายในองค์กร และข้อมูลแหล่งข้อมูลที่เป็นของเกตเวย์นั้น ๆ ซึ่งมีไว้สำหรับ Analysis Services ทั้งโหมดหลายมิติ และโหมดแบบตาราง
author: mgblythe
manager: kfile
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-gateways
ms.topic: conceptual
ms.date: 07/15/2019
ms.author: mblythe
LocalizationGroup: Gateways
ms.openlocfilehash: 93475f6476f8baad73229473bd3ce60db68a320b
ms.sourcegitcommit: 277fadf523e2555004f074ec36054bbddec407f8
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 07/16/2019
ms.locfileid: "68271638"
---
# <a name="manage-your-data-source---analysis-services"></a>จัดการแหล่งข้อมูลของคุณ - Analysis Services

[!INCLUDE [gateway-rewrite](includes/gateway-rewrite.md)]

เมื่อคุณได้[ติดตั้งเกตเวย์ข้อมูลภายในองค์กรแล้ว](/data-integration/gateway/service-gateway-install) คุณจะต้อง[เพิ่มแหล่งข้อมูล](service-gateway-data-sources.md#add-a-data-source)ที่สามารถใช้ได้กับเกตเวย์ดังกล่าว บทความนี้จะดูวิธีการทำงานกับเกตเวย์และแหล่งข้อมูล Analysis Services ที่ใช้สำหรับการรีเฟรชตามกำหนดการหรือสำหรับการเชื่อมต่อสด

หากต้องการเรียนรู้เพิ่มเติมเกี่ยวกับวิธีการตั้งค่าการเชื่อมต่อสดไปยัง Analysis Services [ดูวิดีโอนี้](https://www.youtube.com/watch?v=GPf0YS-Xbyo&feature=youtu.be)

> [!NOTE]
> ถ้าคุณมีแหล่งข้อมูล Analysis Services คุณจะต้องติดตั้งเกตเวย์บนคอมพิวเตอร์ที่เข้าร่วมฟอเรสต์/โดเมนเดียวกับเซิร์ฟเวอร์ Analysis Services ของคุณ

## <a name="add-a-data-source"></a>เพิ่มแหล่งข้อมูล

สำหรับข้อมูลเกี่ยวกับวิธีการเพิ่มแหล่งข้อมูล ให้ดู[เพิ่มแหล่งข้อมูล](service-gateway-data-sources.md#add-a-data-source) เลือก Analysis Services สำหรับ**ชนิดแหล่งข้อมูล**ถ้าคุณกำลังเชื่อมต่อกับเซิร์ฟเวอร์หลายมิติ หรือเซิร์ฟเวอร์แบบตาราง

![เพิ่มแหล่งข้อมูล Analysis Services](media/service-gateway-enterprise-manage-ssas/datasourcesettings2-ssas.png)

จากนั้นคุณจะต้องกรอกข้อมูลเกี่ยวกับแหล่งข้อมูล ซึ่งประกอบด้วย**เซิร์ฟเวอร์**และ**ฐานข้อมูล** เกตเวย์จะนำ**ชื่อผู้ใช้**และ**รหัสผ่าน**ที่คุณกรอกมาใช้ในการเชื่อมต่อกับอินสแตนซ์ Analysis Services

> [!NOTE]
> บัญชีผู้ใช้ Windows คุณกรอกนั้นจะต้องได้รับอนุญาตจากผู้ดูแลเซิร์ฟเวอร์สำหรับอินสแตนซ์ที่คุณกำลังทำการเชื่อมต่อด้วย ถ้ารหัสผ่านของบัญชีนี้ถูกตั้งค่าให้หมดอายุ ผู้ใช้อาจจะเจอข้อผิดพลาดในการเชื่อมต่อหากไม่มีการอัปเดตรหัสผ่านสำหรับแหล่งข้อมูลนั้น ๆ หากต้องการเรียนรู้เพิ่มเติมเกี่ยวกับวิธีการจัดเก็บข้อมูลประจำตัว ให้ดู[การจัดเก็บข้อมูลประจำตัวที่เข้ารหัสไว้ในระบบคลาวด์](service-gateway-data-sources.md#storing-encrypted-credentials-in-the-cloud)

![การกรอกข้อมูลในการตั้งค่าแหล่งข้อมูล](media/service-gateway-enterprise-manage-ssas/datasourcesettings3-ssas.png)

เลือก**เพิ่ม**หลังจากที่คุณได้กรอกทุกอย่างครบถ้วนแล้ว ในตอนนี้ คุณสามารถใช้แหล่งข้อมูลนี้ในการรีเฟรชตามกำหนดการ หรือ การเชื่อมต่อแบบสด กับอินสแตนซ์ Analysis Services ที่อยู่ภายในองค์กรแล้ว คุณจะเห็น*การเชื่อมต่อสำเร็จ* หากการดำเนินการเสร็จสมบูรณ์แล้ว

![การแสดงสถานะการเชื่อมต่อ](media/service-gateway-enterprise-manage-ssas/datasourcesettings4.png)

### <a name="advanced-settings"></a>การตั้งค่าขั้นสูง

อีกทางหนึ่งคือคุณสามารถกำหนดค่าระดับความเป็นส่วนตัวให้กับแหล่งข้อมูลของคุณ ซึ่งจะช่วยควบคุมการรวมข้อมูลได้ และใช้ได้เฉพาะกับการรีเฟรชตามกำหนดการเท่านั้น จะไม่นำไปใช้กับการเชื่อมต่อสด หากต้องการเรียนรู้เพิ่มเติมเกี่ยวกับระดับความเป็นส่วนตัวสำหรับแหล่งข้อมูลของคุณ ให้ดู [ระดับความเป็นส่วนตัว (Power Query)](https://support.office.com/article/Privacy-levels-Power-Query-CC3EDE4D-359E-4B28-BC72-9BEE7900B540)

![การตั้งค่าระดับความเป็นส่วนตัว](media/service-gateway-enterprise-manage-ssas/datasourcesettings9.png)

## <a name="usernames-with-analysis-services"></a>ชื่อผู้ใช้ โดย Analysis Services

<iframe width="560" height="315" src="https://www.youtube.com/embed/Qb5EEjkHoLg" frameborder="0" allowfullscreen></iframe>

แต่ละครั้งที่ผู้ใช้โต้ตอบกับรายงานที่เชื่อมต่อกับ Analysis Services ชื่อผู้ใช้ที่มีผลบังคับใช้ถูกส่งผ่านไปยังเกตเวย์ แล้วไปยังเซิร์ฟเวอร์ Analysis Services ภายในองค์กรของคุณ ที่อยู่อีเมลที่คุณนำมาลงชื่อเข้าใช้กับ Power BI คือข้อมูลที่เราจะส่งผ่านไปยัง Analysis Services ในฐานะที่เป็นผู้ใช้ที่มีผลบังคับใช้ ซึ่งจะถูกส่งผ่านในคุณสมบัติการเชื่อมต่อ[EffectiveUserName](https://msdn.microsoft.com/library/dn140245.aspx#bkmk_auth) ที่อยู่อีเมลนี้ควรตรงกับชื่อหลักของผู้ใช้ (UPN) ที่กำหนดไว้ภายในโดเมน Active Directory ภายในเครื่อง UPN เป็นคุณสมบัติของบัญชีผู้ใช้ Active Directory บัญชีผู้ใช้ Windows นั้นจึงจำเป็นต้องมีอยู่ในบทบาท Analysis Services ถ้าหาค่าตรงกันไม่พบใน Active Directory การเข้าสู่ระบบจะไม่ประสบความสำเร็จ หากต้องการเรียนรู้เพิ่มเติมเกี่ยวกับ Active Directory และการตั้งชื่อผู้ใช้ ให้ดู [แอตทริบิวต์การตั้งชื่อผู้ใช้](https://msdn.microsoft.com/library/ms677605.aspx)

คุณยังสามารถ[แมปชื่อที่ใช้ในการลงชื่อเข้าใช้ใน Power BI กับไดเรกทอรีภายในเครื่อง UPN ได้ด้วย](service-gateway-enterprise-manage-ssas.md#mapping-usernames-for-analysis-services-data-sources)

## <a name="mapping-usernames-for-analysis-services-data-sources"></a>การแมปชื่อผู้ใช้สำหรับแหล่งข้อมูล Analysis Services

<iframe width="560" height="315" src="https://www.youtube.com/embed/eATPS-c7YRU" frameborder="0" allowfullscreen></iframe>

Power BI อนุญาตสำหรับการแมปชื่อผู้ใช้สำหรับแหล่งข้อมูล Analysis Services คุณสามารถกำหนดค่ากฎการแมปชื่อผู้ใช้ที่ลงชื่อเข้าสู่ระบบด้วย Power BI เป็นชื่อที่ถูกส่งผ่านสำหรับ EffectiveUserName บนการเชื่อมต่อ Analysis Services ได้ คุณลักษณะการแมปชื่อผู้ใช้เป็นวิธีที่ยอดเยี่ยมในการแก้ไขปัญหาเมื่อชื่อผู้ใช้ของคุณใน AAD ไม่ตรงกับ UPN ใน Active Directory ภายในเครื่องของคุณ ตัวอย่างเช่น ถ้าที่อยู่อีเมลของคุณคือnancy@contoso.onmicrsoft.com คุณสามารถแมปเข้ากับnancy@contoso.com และค่านั้นจะถูกส่งผ่านไปยังเกตเวย์

คุณสามารถแมปชื่อผู้ใช้สำหรับ Analysis Services ได้สองวิธี:

* แมปผู้ใช้ด้วยตนเองอีกครั้ง
* ใช้ On-premises Active Directory Property Lookup ในการแมป ADD UPNs ไปยังผู้ใช้ Active Directory (การแมปแบบ AD Lookup)

ในขณะที่เป็นไปได้ที่จะทำการแมปด้วยตนเองโดยใช้วิธีที่สอง การทำเช่นนั้นจะใช้เวลานานและยากต่อการบำรุงรักษา ซึ่งจะยุ่งยากเป็นอย่างยิ่งเมื่อการจับคู่รูปแบบไม่พอเพียง - เช่นเมื่อชื่อโดเมนแตกต่างกันระหว่าง AAD และ AD ภายในองค์กรหรือเมื่อชื่อบัญชีผู้ใช้แตกต่างกันระหว่าง AAD และ AD ดังนั้น การแมปด้วยวิธีที่สองจึงไม่เป็นที่แนะนำ

เราอธิบายวิธีการสองแบบนี้ไว้ในสองหัวข้อด้านล่างตามลำดับ

### <a name="manual-user-name-re-mapping"></a>แมปผู้ใช้ด้วยตนเองอีกครั้ง

สำหรับแหล่งข้อมูล Analysis Services คุณสามารถกำหนดค่ากฎต่าง ๆ ของชื่อหลักของผู้ใช้ (UPN) แบบกำหนดเอง ซึ่งจะช่วยให้คุณถ้าชื่อที่ใช้ในการเข้าสู่ระบบบริการของ Power BI ไม่ตรงกับไดเรกทอรีภายในเครื่อง UPN ตัวอย่างเช่น ถ้าคุณลงชื่อเข้าสู่ Power BI ด้วยjohn@contoso.comแต่ไดเรกทอรี UPN ภายในเครื่องของคุณคือjohn@contoso.localคุณสามารถกำหนดค่ากฎการแมปให้john@contoso.localส่งผ่านไปยัง Analysis Services ได้

เมื่อต้องรับไปยังหน้าจอการแมป UPN ทำสิ่งต่อไปนี้

1. ไป**ไอคอนรูปเฟือง**และเลือก**จัดการเกตเวย์**
2. ขยายเกตเวย์ที่ประกอบด้วยแหล่งข้อมูล Analysis Services หรือ ถ้าคุณยังไม่ได้สร้างแหล่งข้อมูล Analysis Services ใด ๆ คุณจะสามารถทำได้ในขั้นตอนนี้
3. เลือกแหล่งข้อมูล จากนั้น เลือกแท็บ**ผู้ใช้**
4. เลือก**แมปชื่อผู้ใช้**

    ![หน้าจอการแมป UPN](media/service-gateway-enterprise-manage-ssas/gateway-enterprise-map-user-names_02.png)

จากนั้นคุณจะเห็นตัวเลือกให้เพิ่มกฎ ตลอดจนบททดสอบสำหรับผู้ใช้ที่กำหนด

> [!NOTE]
> คุณอาจเปลี่ยนแปลงผู้ใชโดยไม่ได้ตั้งใจ ตัวอย่างเช่น ถ้าค่า**ที่นำมาแทน (ค่าเริ่มต้น)ของคุณ**คือ<em>@contoso.com</em>และ**ของคุณ ด้วย(ชื่อใหม่)** คือ <em>@contoso.local</em>ดังนั้น ผู้ใช้ทั้งหมดที่มีเครื่องหมายอยู่<em>@contoso.com</em>จะถูกแทนที่ด้วย<em>@contoso.local</em> นอกจากนี้ยัง ถ้าชื่อ**ที่นำมาแทน (ชื่อเดิม)ของคุณ**คือ<em>dave@contoso.com</em>และ**ของคุณ ด้วย(ชื่อใหม่)** คือ <em>dave@contoso.local</em>ผู้ใช้ที่มีเครื่องหมายอยู่v-dave@contoso.comจะถูกส่งเป็น v-dave<em>@contoso.local</em>

### <a name="ad-lookup-mapping"></a>การแมปแบบค้นหา AD

เพื่อทำการค้นหาคุณสมบัติ on-premises AD เพื่อแมป AAD UPNs อีกครั้ง ผู้ใช้ Active Directory ต้องทำตามขั้นตอนในส่วนนี้ เริ่มแรก มาตรวจสอบวิธีการทำงานกัน

ในการ**บริการ Power BI**จะมีสิ่งต่อไปนี้เกิดขึ้น:

* สำหรับแต่ละคิวรีโดยผู้ใช้ Power BI AAD ไปยังเซิร์ฟเวอร์ on-premises SSAS สตริง UPN จะถูกส่งผ่านตามไปด้วย เช่น:      firstName.lastName@contoso.com

> [!NOTE]
> การแมปผู้ใช้ UPN แบบกำหนดเองใด ๆ ที่ระบุอยู่ในกำหนดค่าแหล่งข้อมูล Power BI จะยังคงใช้ถูกนำมาใช้*ก่อน*ที่จะส่งสตริงชื่อผู้ใช้ไปยังเกตเวย์ข้อมูลภายในองค์กร

บนเกตเวย์ข้อมูลภายในองค์กรที่มีการแมปผู้ใช้แบบกำหนดเองที่สามารถกำหนดค่าได้ ให้ทำดังต่อไปนี้:

1. ค้นหา Active Directory เพื่อค้นหา (อัตโนมัติ หรือกำหนดค่าได้)
2. ค้นหาแอตทริบิวต์ของบุคคล AD (เช่น*อีเมล*) ตามสตริง UPN ขาเข้า ("firstName.lastName@contoso.com") จากตัว**บริการ Power BI**
3. ถ้าการค้นหา AD ล้มเหลว ระบบจะพยายามใช้ UPN ผ่านตามเป็น EffectiveUser เพื่อ SSAS
4. ถ้าการค้นหา AD ประสบความสำเร็จ จะดึง*UserPrincipalName*ของบุคคล AD ดังกล่าว
5. ระบบจะส่งผ่านอีเมล*UserPrincipalName* เป็น*EffectiveUser*ไปยัง SSAS เช่น: <em>Alias@corp.on-prem.contoso</em>

วิธีการกำหนดค่าเกตเวย์ของคุณเพื่อดำเนินการค้นหา AD:

1. [ดาวน์โหลดและติดตั้งเกตเวย์ล่าสุด](/data-integration/gateway/service-gateway-install)

2. ในเกตเวย์ คุณจำเป็นต้องเปลี่ยน**บริการเกตเวย์ข้อมูลภายในองค์กร**เพื่อเรียกใช้ด้วยบัญชีโดเมน (แทนบัญชีบริการภายในเครื่อง – มิฉะนั้นการค้นหา AD จะไม่ทำงานอย่างเหมาะสมในเวลาที่กำลังดำเนินการ) ไปที่[แอปเกตเวย์ข้อมูลภายในองค์กร](/data-integration/gateway/service-gateway-app)บนเครื่องของคุณ จากนั้นไปที่**การตั้งค่าบริการ > เปลี่ยนบัญชีบริการ** ตรวจสอบให้แน่ใจว่า คุณมีรหัสสำหรับการกู้คืนของเกตเวย์นีอยู่ เนื่องจากคุณจะต้องทำการคืนค่าบนเครื่องเดียวกันเว้นแต่ว่าคุณต้องการสร้างเกตเวย์ใหม่แทน คุณจะต้องปิดและเปิดบริการเกตเวย์ใหม่เพื่อให้การเปลี่ยนแปลงมีผลบังคับใช้

3. นำทางไปยังโฟลเดอร์การติดตั้งของเกตเวย์*C:\Program Files\On-premises data gateway* การที่เป็นผู้ดูแล เพื่อให้แน่ใจว่า คุณมีสิทธิ์เขียน และเปิดไฟล์ *Microsoft.PowerBI.DataMovement.Pipeline.GatewayCore.dll.config*

4. แก้ไขการกำหนดค่าสองค่าต่อไปนี้ตาม*ค่า* การกำหนดค่าแอตทริบิวต์ของ Active Directory สำหรับผู้ใช้ AD ของคุณ ค่ากำหนดค่าที่แสดงด้านล่างเป็นเพียงตัวอย่าง คุณจำเป็นต้องระบุเหล่านั้นโดยยึดตามการกำหนดค่า Active Directory การกำหนดค่าเหล่านี้จะตรงตามตัวพิมพ์ใหญ่-เล็ก ดังนั้นตรวจสอบให้แน่ใจว่าตรงกับค่าใน Active Directory

    ![การตั้งค่า Azure Active Directory](media/service-gateway-enterprise-manage-ssas/gateway-enterprise-map-user-names_03.png)

    ถ้าไม่มีค่าไว้สำหรับการกำหนดค่า ADServerPath เกตเวย์ใช้ค่าเริ่มต้นของ Global Catalog คุณยังสามารถระบุค่าหลายค่าสำหรับ ADServerPath ได้ แต่ละค่าต้องคั่นด้วยเครื่องหมายอัฒภาคตามตัวอย่างต่อไปนี้

    ```xml
    <setting name="ADServerPath" serializeAs="String">
        <value> >GC://serverpath1; GC://serverpath2;GC://serverpath3</value>
    </setting>
    ```

    เกตเวย์แยกวิเคราะห์ค่าสำหรับ ADServerPath จากซ้ายไปขวาจนกว่าจะพบรายการตรงกัน ถ้าไม่ตรงกัน คือใช้ UPN ต้นฉบับ ตรวจสอบให้แน่ใจว่าบัญชีผู้ใช้เรียกใช้บริการเกตเวย์ (PBIEgwService) มีสิทธิ์แบบสอบถามไปยังเซิร์ฟเวอร์ AD ทั้งหมดที่คุณระบุใน ADServerPath

    เกตเวย์สนับสนุนสองชนิด ADServerPath ตามตัวอย่างต่อไปนี้

    **WinNT**

    ```xml
    <value="WinNT://usa.domain.corp.contoso.com,computer"/>
    ```

    **GC**

    ```xml
    <value> GC://USA.domain.com </value>
    ```

5. เริ่มสตาร์ทบริการ**เกตเวย์ข้อมูลภายในองค์กร**สำหรับการเปลี่ยนแปลงการกำหนดค่าเพื่อให้มีผลบังคับใช้

### <a name="working-with-mapping-rules"></a>ทำงานกับกฎการแมป

เมื่อต้องสร้างกฎการแมป ใส่ค่าสำหรับ**ชื่อเดิม**และ**ชื่อใหม่**แล้ว เลือก**เพิ่ม**

| เขตข้อมูล | คำอธิบาย |
| --- | --- |
| แทน (ชื่อเดิม) |อยู่อีเมลที่คุณลงชื่อเข้า Power BI ด้วย |
| กับ (ชื่อใหม่) |ค่าที่คุณต้องการนำมาแทนที่ ผลลัพธ์ของการแทนที่เป็นสิ่งที่จะส่งผ่านไปยัง*EffectiveUserName*คุณสมบัติสำหรับการเชื่อมต่อ Analysis Services |

![การสร้างกฎการแมป](media/service-gateway-enterprise-manage-ssas/gateway-enterprise-map-user-names-effective-user-names.png)

เมื่อคุณเลือกสิ่งของในรายการ คุณสามารถเลือกที่จะเรียงลำดับใหม่ได้ โดยใช้**ไอคอนรูปบั้ง**หรือ**ลบ**รายการได้

![การจัดลำดับรายการในรายการ](media/service-gateway-enterprise-manage-ssas/gateway-enterprise-map-user-names-entry-selected.png)

### <a name="using-wildcard-"></a>ใช้อักขระตัวแทน (*)

คุณสามารถใช้อักขระตัวแทนสำหรับสตริง**แทน (ชื่อเดิม)** ของคุณได้ ซึ่งอักขระนี้สามารถใช้เดี่ยว ๆ ได้ด้วยตัวมันเอง และไม่ใช้กับส่วนอื่นใด ๆ ของสตริง และนี่จะเป็นการอนุญาตให้คุณสามารถนำผู้ใช้ทั้งหมด และส่งค่าเดียวไปยังแหล่งข้อมูล มันเป็นประโยชน์เมื่อคุณต้องการผู้ใช้ทั้งหมดในองค์กรของคุณใช้ผู้ใช้เดียวกันในสภาพแวดล้อมภายในเครื่องของคุณ

### <a name="test-a-mapping-rule"></a>ทดสอบกฎการแมป

คุณสามารถตรวจสอบสิ่งที่มีชื่อต้นฉบับจะถูกแทนที่ด้วย โดยการใส่ค่าสำหรับ**ชื่อเดิม**และเลือก**กฎทดสอบ**ได้

![การทดสอบกฎการแมป](media/service-gateway-enterprise-manage-ssas/gateway-enterprise-test-mapping-rule.png)

> [!NOTE]
> กฎที่บันทึกไว้จะใช้เวลาสักครู่ก่อนที่บริการจะเริ่มต้นใช้งานเหล่านั้น ภายในเบราว์เซอร์ กฎจะทำงานทันที

### <a name="limitations-for-mapping-rules"></a>ขีดจำกัดสำหรับกฎการแมป

การแมปมีไว้สำหรับแหล่งข้อมูลที่เฉพาะเจาะจงที่ได้รับการกำหนดค่า ไม่ใช่การตั้งค่าส่วนกลาง ถ้าคุณมีแหล่งข้อมูล Analysis Services หลายแหล่ง คุณจะต้องแมปผู้ใช้สำหรับแต่ละแหล่งข้อมูล

## <a name="authentication-to-a-live-analysis-services-data-source"></a>รับรองความถูกต้องไปยังแหล่งข้อมูล Analysis Services แบบออนไลน์

แต่ละครั้งที่ผู้ใช้โต้ตอบ Analysis Services ชื่อผู้ใช้ที่มีผลบังคับใช้ถูกส่งผ่านไปยังเกตเวย์ แล้วไปยังเซิร์ฟเวอร์ Analysis Services ภายในองค์กรของคุณ สำหรับชื่อหลักของผู้ใช้ (UPN) โดยปกติแล้วที่อยู่อีเมลที่คุณใช้ลงชื่อเข้าระบบคลาวด์เป็นสิ่งที่เราจะใช้เพื่อผ่านไปยัง Analysis Services ในฐานะเป็นผู้ใช้ที่มีสิทธิ์ UPN จะถูกส่งผ่านในคุณสมบัติการเชื่อมต่อ EffectiveUserName อีเมลนี้ควรตรงกับ UPN ที่กำหนดไว้ภายในโดเมน Active Directory ภายในเครื่อง UPN เป็นคุณสมบัติของบัญชีผู้ใช้ Active Directory บัญชีผู้ใช้ Windows นั้นจึงจำเป็นต้องมีอยู่ในบทบาท Analysis Services เพื่อให้สามารถเข้าถึงเซิร์ฟเวอร์ได้ การเข้าสู่ระบบจะไม่ประสบความสำเร็จถ้าไม่พบว่าไม่ตรงใน Active Directory

นอกจากนี้ Analysis Services ยังสามารถมีการกรองโดยยึดตามบัญชีผู้ใช้นี้ การกรองสามารถเกิดขึ้นกับทั้งการรักษาความปลอดภัยตามบทบาทหรือการรักษาความปลอดภัยระดับแถว

## <a name="role-based-security"></a>รักษาความปลอดภัยตามบทบาท

แบบจำลองจะมีการรักษาความปลอดภัยตามบทบาทของผู้ใช้ กำหนดบทบาทสำหรับโครงการแบบจำลองเฉพาะในระหว่างการเขียนในเครื่อง SQL Server Data – ข่าวกรองธุรกิจ (SSDT-BI) หรือหลังจากมีการใช้งานแบบจำลอง โดยใช้ SQL Server Management Studio (SSMS) บทบาทประกอบด้วยสมาชิก โดยแยกตามชื่อผู้ใช้ Windows หรือกลุ่มของ Windows บทบาทกำหนดสิทธิ์ที่ผู้ใช้มีในการร้องขอหรือดำเนินการกับแบบจำลอง ผู้ใช้ส่วนใหญ่จะมีหนึ่งบทบาทที่มีสิทธิ์การใช้งานแบบอ่าน บทบาทอื่น ๆ มีไว้สำหรับผู้ดูแลระบบที่มีสิทธิ์ในการประมวลผลรายการ จัดการฟังก์ชันฐานข้อมูล และจัดการบทบาทอื่น

## <a name="row-level-security"></a>รักษาความปลอดภัยตามระดับแถว

การรักษาความปลอดภัยระดับแถวมีไว้เฉพาะสำหรับการรักษาความปลอดภัยระดับแถว Analysis Services แบบจำลองสามารถให้การรักษาความปลอดภัยแบบไดนามิกและระดับแถว การรักษาความปลอดภัยแบบไดนามิกไม่จำเป็นสำหรับแบบจำลองใด ๆ ซึ่งไม่เหมือนกับการมีอย่างน้อยหนึ่งบทบาทที่ผู้ใช้ต้องมี การรักษาความปลอดภัยแบบไดนามิก ระบบกำหนดการเข้าถึงแบบอ่านของผู้ใช้ในการเข้าใช้ข้อมูลสำหรับบางแถวในตารางใดตารางหนึ่งที่ระดับสูง คล้ายกับบทบาทต่าง ๆ การรักษาความปลอดภัยระดับแถวแบบไดนามิกจะต้องอาศัยชื่อผู้ใช้ Windows ของผู้ใช้

ความสามารถของผู้ใช้ในการร้องขอและดูข้อมูลแบบจำลองจะกำหนดครั้งแรกโดยบทบาทที่บัญชีผู้ใช้ Windows เป็นสมาชิก และประการที่สอง โดยการรักษาความปลอดภัยระดับแถวแบบไดนามิก หากมีการกำหนดค่าไว้

การนำบทบาทและการรักษาความปลอดภัยระดับแถวแบบไดนามิกไปใช้ในแบบจำลองอยู่นอกขอบเขตของบทความนี้ คุณสามารถเรียนรู้เพิ่มเติมได้ที่[บทบาท (SSAS แบบตาราง)](https://msdn.microsoft.com/library/hh213165.aspx)และ[บทบาทการรักษาความปลอดภัย (Analysis Services - ข้อมูลหลายมิติ)](https://msdn.microsoft.com/library/ms174840.aspx)บน MSDN ได้ เพื่อทำความเข้าใจในเชิงลึกมากที่สุดเกี่ยวกับการรักษาความปลอดภัยแบบจำลองแบบตาราง ให้ดาวน์โหลดและอ่าน[เอกสารทางเทคนิค Securing Tabular BI Semantic Model](https://msdn.microsoft.com/library/jj127437.aspx)

## <a name="what-about-azure-active-directory"></a>แล้ว Azure Active Directory ล่ะ?

บริการระบบคลาวด์ของ Microsoft ใช้ [Azure Active Directory](/azure/active-directory/fundamentals/active-directory-whatis)ในดูแลผู้ใช้การรับรองความถูกต้อง Azure Active Directory คือผู้เช่าที่ประกอบด้วยกลุ่มการรักษาความปลอดภัยและชื่อผู้ใช้ โดยทั่วไปแล้ว ที่อยู่อีเมลที่ผู้ใช้ใช้ลงชื่อเข้าระบบ จะเหมือนกับ UPN ของบัญชีผู้ใช้

บทบาทของฉันภายใน Active Directory คืออะไร?

สำหรับ Analysis Services เพื่อตรวจสอบว่าผู้ใช้ที่เชื่อมต่ออยู่มีบทบาทที่มีสิทธิ์ในการอ่านข้อมูลหรือไม่ เซิร์ฟเวอร์ต้องแปลงชื่อผู้ใช้ที่สามารถใช้งานได้ที่ส่งมาจาก AAD มายังเกตเวย์ การเข้าไปในเซิร์ฟเวอร์ Analysis Services เซิร์ฟเวอร์ Analysis Services ส่งผ่านชื่อผู้ใช้ที่สามารถใช้ได้ไปยังตัวควบคุมโดเมน (Domain controller: DC) Windows Active Directory จานั้น ควบคุมโดเมน Active Directory จะทำการตรวจสอบชื่อผู้ใช้ที่ใช้งานได้เป็น UPN ที่ถูกต้องบนบัญชีในเครื่อง และส่งกลับชื่อผู้ใช้ Windows ของผู้ใช้รายนั้นกลับไปยังเซิร์ฟเวอร์ Analysis Services

EffectiveUserName ไม่สามารถใช้บนเซิร์ฟเวอร์รวมเข้ากันที่ไม่ใช่โดเมน Analysis Services ได้ เซิร์ฟเวอร์ Analysis Services ต้องรวมเข้ากับโดเมนเพื่อหลีกเลี่ยงข้อผิดพลาดการเข้าสู่ระบบ

### <a name="how-do-i-tell-what-my-upn-is"></a>ฉันจะทราบได้อย่างไรว่า UPN ของฉันเป็นอะไร?

คุณอาจไม่ทราบว่า UPN ของคุณเป็นอะไร และคุณอาจจะไม่ใช่ผู้ดูแลระบบโดเมน คุณสามารถใช้คำสั่งต่อไปนี้จากเวิร์กสเตชันของคุณเพื่อค้นหา UPN สำหรับบัญชีของคุณได้

    whoami /upn

ผลลัพธ์จะมีลักษณะคล้ายกับที่อยู่อีเมล แต่นี่คือ UPN ที่อยู่ในบัญชีโดเมนของคุณ ถ้าคุณกำลังใช้แหล่งข้อมูล Analysis Services สำหรับการเชื่อมต่อสด และถ้าหากที่อยู่อีเมลไม่ตรงกับอีเมลของคุณที่ใช้ลงชื่อเข้า Power BI คุณอาจต้องดูที่วิธีการ[แมปชื่อผู้ใช้](#mapping-usernames-for-analysis-services-data-sources)

## <a name="synchronize-an-on-premises-active-directory-with-azure-active-directory"></a>รวม Active Directory ภายในองค์กรเข้ากับ Azure Active Directory

คุณจะต้องการให้บัญชี Active Directory ภายในเครื่องตรงกับ Azure Active Directory ถ้าคุณกำลังใช้การเชื่อมต่อสดของ Analysis Services เนื่องจาก UPN จะต้องตรงกันระหว่างบัญชีเหล่านั้น

บริการระบบคลาวด์ทราบเกี่ยวกับบัญชีผู้ใช้ภายใน Azure Active Directory เท่านั้น ไม่สำคัญว่าคุณได้เพิ่มบัญชีผู้ใช้หนึ่งใน Active Directory ภายในเครื่องของคุณ หากบัญชีนั้นไม่อยู่ใน AAD จะไม่สามารถนำไปใช้ได้ มีหลายวิธีที่คุณสามารถจับคู่บัญชีผู้ใช้ Active Directory ของคุณภายในเครื่องเข้ากับ Azure Active Directory

1. คุณสามารถเพิ่มบัญชีผู้ใช้ด้วยตนเองไปยัง Azure Active Directory

   คุณสามารถสร้างบัญชีผู้ใช้บนพอร์ทัล Azure หรือภาย ในศูนย์การจัดการ Microsoft 365 และชื่อบัญชีผู้ใช้ตรงกับ UPN ของบัญชี Active Directory ในเครื่อง

2. คุณสามารถใช้เครื่องมือ [Azure AD Connect](/azure/active-directory/hybrid/how-to-connect-sync-whatis)เพื่อรวมบัญชีผู้ใช้ภายในเครื่องเข้ากับผู้เช่า Azure Active Directory ของคุณได้

   เครื่องมือ Azure AD Connect มีตัวเลือกสำหรับการซิงโครไนซ์ไดเรกทอรี และการตั้งค่าการรับรองความถูกต้อง รวมถึงการซิงค์แฮชรหัสผ่าน, การรับรองความถูกต้องแบบพาสทรู และการติดต่อกับภายนอก ถ้าคุณไม่ได้เป็นผู้ดูแลระบบสำหรับผู้เช่าหรือผู้ดูแลระบบโดเมนภายใน คุณจะต้องติดต่อผู้ดูแลระบบ IT ของคุณเพื่อกำหนดค่านี้

การใช้ Azure AD Connect ทำให้แน่ใจว่า UPN จะทำให้ AAD และ Active Directory ภายในเครื่องของคุณตรงกัน

> [!NOTE]
> การรวมบัญชีผู้ใช้ด้วยเครื่องมือ Azure AD Connect จะสร้างบัญชีผู้ใช้ใหม่ภายในผู้เช่า AAD ของคุณ

## <a name="using-the-data-source"></a>การใช้แหล่งข้อมูล

หลังจากที่คุณได้สร้างแหล่งข้อมูล รายการนี้จะพร้อมใช้งานเมื่อต้องใช้ทั้งกับการเชื่อมต่อสดหรือผ่านการรีเฟรชตามกำหนดการ

> [!NOTE]
> ชื่อเซิร์ฟเวอร์และชื่อฐานข้อมูลจะต้องตรงกับ Power BI Desktop และแหล่งข้อมูลในเกตเวย์ข้อมูลภายในองค์กร

การเชื่อมโยงระหว่างชุดข้อมูลของคุณและแหล่งข้อมูลภายในเกตเวย์จะเป็นไปตามชื่อเซิร์ฟเวอร์และชื่อฐานข้อมูลของคุณ ซึ่งจำเป็นต้องตรงกัน ตัวอย่างเช่น ถ้าคุณใส่ที่อยู่ IP สำหรับชื่อเซิร์ฟเวอร์ ใน Power BI Desktop คุณจะต้องใช้ที่อยู่ IP สำหรับแหล่งข้อมูลภายในการกำหนดค่าเกตเวย์ด้วยเช่นกัน ถ้าคุณใช้ *SERVER\INSTANCE* ใน Power BI Desktop คุณจะต้องใช้ชื่อเดียวกันในแหล่งข้อมูลที่กำหนดค่าไว้สำหรับเกตเวย์ดังกล่าว

นี่คือกรณีสำหรับทั้งเชื่อมต่อแบบสดและรีเฟรชตามกำหนดการ

### <a name="using-the-data-source-with-live-connections"></a>การใช้แหล่งข้อมูลที่ มีการเชื่อมต่อแบบสด

คุณจะต้องตรวจสอบให้แน่ใจว่าชื่อเซิร์ฟเวอร์และชื่อฐานข้อมูลตรงกันระหว่าง Power BI Desktop และแหล่งข้อมูลที่กำหนดค่าไว้สำหรับเกตเวย์ คุณจะยังจำเป็นต้องตรวจสอบให้แน่ใจว่าผู้ใช้ของคุณแสดงอยู่ในแท็บ**ผู้ใช้**ของแหล่งข้อมูลเพื่อที่เผยแพร่ชุดข้อมูลการเชื่อมต่อสด ตัวเลือกสำหรับการเชื่อมต่อสด จะเกิดขึ้นภายใน Power BI Desktop ตอนที่คุณนำเข้าข้อมูลครั้งแรก

หลังจากที่คุณเผยแพร่แล้ว ไม่ว่าจาก Power BI Desktop หรือ**รับข้อมูล**รายงานของคุณควรเริ่มการทำงานแล้ว อาจจะใช้เวลาหลายนาทีเพื่อให้การเชื่อมต่อสามารถใช้งานได้ หลังจากการสร้างแหล่งข้อมูลภายในเกตเวย์

### <a name="using-the-data-source-with-scheduled-refresh"></a>การใช้แหล่งข้อมูลที่มีการรีเฟรชตามกำหนดการ

ถ้าคุณอยู่ในแท็บ**ผู้ใช้**ของแหล่งข้อมูลที่กำหนดค่าไว้ภายในเกตเวย์ และชื่อเซิร์ฟเวอร์และชื่อฐานข้อมูลตรงกัน คุณจะเห็นเกตเวย์เป็นตัวเลือกเพื่อใช้กับการรีเฟรชตามกำหนดการ

![การแสดงรายชื่อผู้ใช้](media/service-gateway-enterprise-manage-ssas/powerbi-gateway-enterprise-schedule-refresh.png)

### <a name="limitations-of-analysis-services-live-connections"></a>ขีดจำกัดของการเชื่อมต่อแบบสดของ Analysis Services

คุณสามารถใช้การเชื่อมต่อแบบสดกับอินสแตนซ์หลายมิติ หรือแบบตาราง

| **รุ่นของเซิร์ฟเวอร์** | **SKU ที่จำเป็นต้องมี** |
| --- | --- |
| 2012 SP1 CU4 หรือใหม่กว่า |เทคโนโลยีสำหรับการรวบรวมข้อมูล จัดเก็บ วิเคราะห์ และการเข้าถึงข้อมูล รวมถึงการดูในหลากหลายมุมมอง (BI) และ SKU องค์กร |
| 2014 |เทคโนโลยีสำหรับการรวบรวมข้อมูล จัดเก็บ วิเคราะห์ และการเข้าถึงข้อมูล รวมถึงการดูในหลากหลายมุมมอง (BI) และ SKU องค์กร |
| 2016 |SKU มาตรฐาน หรือสูงกว่า |

* การจัดรูปแบบระดับเซลล์ และคุณลักษณะการแปลไม่ได้รับการสนับสนุน
* การดำเนินการและ Named Sets จะไม่แสดงใน Power BI แต่คุณยังสามารถเชื่อมต่อกับคิวบ์หลายมิติที่ยังประกอบด้วยการดำเนินการ หรือ Named Sets พร้อมสร้างภาพและรายงานได้

## <a name="next-steps"></a>ขั้นตอนถัดไป

* [การแก้ไขปัญหาเกตเวย์ข้อมูลภายในองค์กร](/data-integration/gateway/service-gateway-tshoot)
* [แก้ไขปัญหาเกตเวย์-Power BI](service-gateway-onprem-tshoot.md)

มีคำถามเพิ่มเติมหรือไม่? [ลองไปที่ชุมชน Power BI](http://community.powerbi.com/)

