---
title: สร้างภาพของ Power BI โดยใช้ R
description: สร้างภาพของ Power BI โดยใช้ R
author: davidiseminger
manager: kfile
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-desktop
ms.topic: conceptual
ms.date: 05/08/2019
ms.author: davidi
LocalizationGroup: Create reports
ms.openlocfilehash: 969dc53f97156724d6c2b6b7dd6036b3fe8310aa
ms.sourcegitcommit: 60dad5aa0d85db790553e537bf8ac34ee3289ba3
ms.translationtype: MT
ms.contentlocale: th-TH
ms.lasthandoff: 05/29/2019
ms.locfileid: "65514423"
---
# <a name="create-power-bi-visuals-using-r"></a>สร้างภาพของ Power BI โดยใช้ R
ด้วย**Power BI Desktop**คุณสามารถใช้**R**เพื่อแสดงภาพข้อมูลของคุณได้

## <a name="install-r"></a>ติดตั้ง R
**Power BI Desktop** ไม่รวม, ปรับใช้ หรือติดตั้งกลไกจัดการ **R** เมื่อต้องการเรียกใช้สคริปต์ R ใน**Power BI Desktop**คุณต้องติดตั้ง**R**บนเครื่องคอมพิวเตอร์ของคุณแยกต่างหาก คุณสามารถดาวน์โหลดและติดตั้ง **R** ได้ฟรีจากตำแหน่งที่ตั้งต่าง ๆ ซึ่งรวมถึง[หน้าดาวน์โหลด Revolution Open](https://mran.revolutionanalytics.com/download/) และ [CRAN Repository](https://cran.r-project.org/bin/windows/base/) รุ่นปัจจุบันของการเขียนสคริปต์ R ใน**Power BI Desktop**สนับสนุนอักขระ Unicode ตลอดจนช่องว่าง (อักขระว่าง) ในเส้นทางการติดตั้ง

## <a name="enable-r-visuals"></a>เปิดใช้งานวิชวล R
เมื่อต้องการเปิดใช้งานวิชวล R เลือก**ไฟล์ > ตัวเลือกและการตั้งค่า > ตัวเลือก**และในหน้า**ตัวเลือก**ที่ปรากฏขึ้น ตรวจสอบให้แน่ใจว่าการติดตั้ง R ภายในเครื่องของคุณได้ระบุไว้ใน**การเขียนสคริปต์ R**ของหน้าต่าง**ตัวเลือก**ดังที่แสดงในรูปต่อไปนี้ ในรูปต่อไปนี้ การติดตั้งภายในเส้นทางของ R คือ**C:\Program Files\R\R-3.2.0**และเส้นทางมีอยู่อย่างชัดเจนในกล่องข้อความ ตรวจสอบให้แน่ใจว่า เส้นทางที่แสดงอย่างเหมาะสมสะท้อนการติดตั้ง R ภายในเครื่องที่คุณต้องการให้**Power BI Desktop**ใช้
   
   ![](media/desktop-r-visuals/r-visuals-2.png)

เมื่อคุณระบุการติดตั้ง R คุณก็พร้อมที่จะเริ่มสร้างวิชวล R

## <a name="create-r-visuals-in-power-bi-desktop"></a>สร้างวิชวล R ใน Power BI Desktop
1. เลือกไอคอน**วิชวล R**ในบานหน้าต่าง**การแสดงภาพ** ดังที่แสดงในรูปต่อไปนี้ เพื่อเพิ่มวิชวล R
   
   ![](media/desktop-r-visuals/r-visuals-3.png)

   เมื่อคุณเพิ่มวิชวล R ไปยังรายงาน**Power BI Desktop**จะไม่เป็นดังต่อไปนี้:
   
   - รูปวิชวล R ของพื้นที่ที่สำรองไว้ปรากฏบนพื้นที่รายงาน
   
   - **ตัวแก้ไขสคริปต์ R**ปรากฏขึ้นทางด้านล่างของบานหน้าต่างกลาง
   
   ![](media/desktop-r-visuals/r-visuals-4.png)

2. ถัดไป เพิ่มเขตข้อมูลที่คุณต้องการใช้ในสคริปต์ R ของคุณไปยังส่วน**ค่า**ในแหล่ง**เขตข้อมูล**เหมือนกับที่คุณทำกับภาพ**Power BI Desktop**อื่น ๆ 
    
    เฉพาะเขตข้อมูลที่เพิ่มลงในแหล่ง**เขตข้อมูล** จะพร้อมใช้งานสคริปต์ R ของคุณ คุณสามารถเพิ่มเขตข้อมูลใหม่ หรือเอาเขตข้อมูลที่ไม่ต้องการออกจากแหล่ง**เขตข้อมูล** ขณะที่ทำงานบนสคริปต์ R ของคุณใน**ตัวแก้ไขสคริปต์ R ของ Power BI Desktop** **Power BI Desktop**ตรวจพบเขตข้อมูลที่คุณได้เพิ่ม หรือเอาออกโดยอัตโนมัติ
   
   > [!NOTE]
   > ชนิดการรวมเริ่มต้นสำหรับวิชวล R คือ*ไม่ต้องทำการสรุป*
   > 
   > 
   
3. ขณะนี้คุณสามารถใช้ข้อมูลที่คุณเลือกเพื่อสร้างการลงจุด 

    เมื่อคุณเลือกเขตข้อมูล **ตัวแก้ไขสคริปต์ R**จะสร้างโค้ดการผูกสคริปต์ R สนับสนุนโดยขึ้นอยู่กับการเลือกของคุณในส่วนสีเทาตามแนวด้านบนของบานหน้าต่างตัวแก้ไข ขณะที่คุณเลือกหรือเอาเขตข้อมูลเพิ่มเติมออก โค้ดสนับสนุนในตัวแก้ไขสคริปต์ R จะถูกสร้างขึ้นโดยอัตโนมัติหรือถูกนำออกให้สอดคล้องกัน
   
   ในตัวอย่างที่แสดงในรูปต่อไปนี้ มีการเลือกเขตข้อมูลสามตัว: hp gear และ drat ผลจากการเลือกดังกล่าว ตัวแก้ไข R script สร้างโค้ดการผูกดังต่อไปนี้:
   
   * Dataframe ที่เรียกว่า**ชุดข้อมูล**ถูกสร้างขึ้น
     * Dataframe ประกอบด้วยเขตข้อมูลที่แตกต่างกันที่ถูกเลือกโดยผู้ใช้
   * การรวมเริ่มต้น คือ*ไม่ต้องทำการสรุป*
   * คล้ายกับภาพตาราง เขตข้อมูลจะถูกจัดกลุ่ม และทำซ้ำแถวที่ปรากฏเพียงครั้งเดียว
   
   ![](media/desktop-r-visuals/r-visuals-5.png)
   
   > [!TIP]
   > ในบางกรณี คุณอาจไม่ต้องการให้จัดกลุ่มโดยอัตโนมัติ หรือคุณอาจต้องการให้แถวทั้งหมดปรากฏ รวมถึงรายการที่ซ้ำกัน ในกรณีนั้น คุณสามารถเพิ่มเขตข้อมูลดัชนีไปยังชุดข้อมูลของคุณ ซึ่งจะทำให้แถวทั้งหมดถูกพิจารณาว่าไม่ซ้ำกัน ซึ่งป้องกันการถูกจัดกลุ่ม
   > 
   > 
   
   Dataframe ที่สร้างขึ้นเรียกว่า**ชุดข้อมูล** และคุณสามารถเข้าถึงเลือกคอลัมน์ที่เลือกไว้จากชื่อที่เกี่ยวข้อง ตัวอย่างเช่น เขตข้อมูล gear สามารถเข้าถึงได้โดยการเขียน *dataset$gear* ในสคริปต์ R ของคุณ สำหรับเขตข้อมูลที่มีช่องว่างหรืออักขระพิเศษ ให้ใช้เครื่องหมายอัญประกาศเดี่ยว

4. ด้วย Dataframe ที่สร้างขึ้นอัตโนมัติโดยเขตข้อมูลที่คุณเลือก คุณก็พร้อมที่จะเขียนสคริปต์ R ที่จะลงจุดไปยังอุปกรณ์เริ่มต้นของ R เมื่อสคริปต์เสร็จสมบูรณ์ เลือก**เรียกใช้**จากแถบชื่อเรื่อง**ตัวแก้ไขสคริปต์ R**(**เรียกใช้**อยู่บนด้านขวาของแถบชื่อเรื่อง)
   
    เมื่อคุณเลือก**เรียกใช้** **Power BI Desktop** จะแยกแยะการลงจุดนี้และแสดงบนพื้นที่ทำงาน เนื่องจากกระบวนการจะทำบนการติดตั้ง R ในเครื่องของคุณ ตรวจสอบให้แน่ใจว่ามีการติดตั้งแพคเกจที่จำเป็นแล้ว
   
   **Power BI Desktop** ลงจุดภาพซ้ำอีกครั้งเมื่อเหตุการณ์ใด ๆ ต่อไปนี้เกิดขึ้น:
   
   * เมื่อคุณเลือก**เรียกใช้** จากแถบชื่อเรื่อง**ตัวแก้ไขสคริปต์ R**
   * เมื่อใดก็ตามที่เกิดการเปลี่ยนแปลงข้อมูล เนื่องจากการรีเฟรชข้อมูล การกรอง หรือการเน้น

     รูปต่อไปนี้แสดงตัวอย่างโค้ดการลงจุดสหสัมพันธ์ ซึ่งลงจุดสหสัมพันธ์ระหว่างแอตทริบิวต์ของรถยนต์ชนิดต่าง ๆ

     ![](media/desktop-r-visuals/r-visuals-6.png)

5. เพื่อให้ได้มุมมองของการแสดงภาพที่มีขนาดใหญ่ขึ้น คุณสามารถย่อ**ตัวแก้ไขสคริปต์ R**ได้ และแน่นอน เช่นเดียวกับวิชวลอื่น ๆ ใน **Power BI Desktop**คุณสามารถกรองข้ามการลงจุดสหสัมพันธ์ โดยเลือกเฉพาะรถสปอร์ตในวิชวลโดนัท (วิชวลกลมทางด้านขวา ในรูปตัวอย่างด้านบน)

    ![](media/desktop-r-visuals/r-visuals-7.png)

6. คุณสามารถปรับเปลี่ยนสคริปต์ R เพื่อกำหนดภาพด้วยตนเอง และใช้ประโยชน์จากพลังของ R โดยการเพิ่มพารามิเตอร์ไปยังคำสั่งการลงจุด

    คำสั่งการลงจุดเดิมมีดังต่อไปนี้:

    corrplot(M, method = "color",  tl.cex=0.6, tl.srt = 45, tl.col = "black")

    ด้วยการเปลี่ยนแปลงบางอย่างในสคริปต์ R ขณะนี้คำสั่งมีดังต่อไปนี้:

    corrplot(M, method = "circle", tl.cex=0.6, tl.srt = 45, tl.col = "black", type= "upper", order="hclust")

    ผลคือ ขณะนี้วิชวล R ลงจุดวงกลม พิจารณาเพียงส่วนครึ่งบน และจัดลำดับเมทริกซ์ไปยังแอตทริบิวต์ที่สัมพันธ์กับคลัสเตอร์ ดังที่แสดงในรูปต่อไปนี้

    ![](media/desktop-r-visuals/r-visuals-8.png)

    เมื่อดำเนินการสคริปต์ R ที่เกิดข้อผิดพลาด วิชวล R จะไม่ถูกลงจุด และข้อความแสดงข้อผิดพลาดจะแสดงบนพื้นที่ทำงาน สำหรับรายละเอียดเกี่ยวกับข้อผิดพลาด เลือก**ดูรายละเอียด**จากข้อผิดพลาดวิชวล R บนพื้นที่ทำงาน

    ![](media/desktop-r-visuals/r-visuals-9.png)

    > **การรักษาความปลอดภัยสคริปต์ R:** ภาพ R ถูกสร้างขึ้นจากสคริปต์ R ซึ่งประกอบด้วยโค้ดที่มีความเสี่ยงต่อความปลอดภัยหรือความเป็นส่วนตัว เมื่อพยายามที่จะดูหรือโต้ตอบกับวิชวล R เป็นครั้งแรก ผู้ใช้จะได้รับข้อความเตือนเรื่องความปลอดภัย เปิดใช้งานวิชวล R ถ้าคุณเชื่อถือผู้เขียนและแหล่งที่มาเท่านั้น หรือหลังจากที่คุณตรวจทานและทำความเข้าใจสคริปต์ R
    > 
    > 

## <a name="known-limitations"></a>ข้อจำกัดที่ทราบ
วิชวล R ใน**Power BI Desktop**มีข้อจำกัดบางอย่าง:

* ข้อจำกัดของขนาดข้อมูล – ข้อมูลที่ใช้โดยวิชวล R สำหรับการลงจุดจะถูกจำกัดไว้ที่ 150,000 แถว ถ้าเลือกมากกว่า 150,000 แถว จะมีการใช้งานเฉพาะ 150,000 แถวบนสุด และข้อความจะแสดงบนรูปภาพ
* ข้อจำกัดเวลาคำนวณ – ถ้าการคำนวณวิชวล R นานเกิน 5 นาที การดำเนินการจะหมดเวลา ส่งผลให้เกิดข้อผิดพลาด
* ความสัมพันธ์ – เช่นเดียวกับภาพอื่น ๆ ของ Power BI Desktop ถ้ามีการเลือกเขตข้อมูลจากตารางต่าง ๆ โดยไม่มีความสัมพันธ์ที่กำหนดระหว่างกัน จะเกิดข้อผิดพลาดขึ้น
* วิชวล R ถูกรีเฟรชเมื่อมีการปรับปรุงข้อมูล การกรอง และการเน้น อย่างไรก็ตาม รูปภาพนั้นไม่ได้เป็นแบบโต้ตอบ และไม่สามารถเป็นแหล่งที่มาของการกรองข้าม
* วิชวล R ตอบสนองต่อการเน้นภาพอื่น ๆ แต่คุณไม่สามารถคลิกที่องค์ประกอบในวิชวล R เพื่อที่กรองข้ามองค์ประกอบอื่น ๆ ได้
* เฉพาะการลงจุดที่ถูกลงจุดไปยังอุปกรณ์แสดงผลเริ่มต้น R เท่านั้นจะแสดงผลอย่างถูกต้องบนพื้นที่ทำงาน หลีกเลี่ยงการใช้อุปกรณ์แสดงผล R ที่แตกต่างกันอย่างชัดเจน
* ในรุ่นที่วางจำหน่ายนี้ การติดตั้ง RRO จะไม่ถูกระบุโดยอัตโนมัติด้วย Power BI Desktop เวอร์ชัน 32-บิต ดังนั้นคุณต้องระบุเส้นทางไปยังไดเรกทอรีการติดตั้ง R ด้วยตนเองใน**ตัวเลือกและการตั้งค่า > ตัวเลือก > การเขียนสคริปต์ R**

## <a name="next-steps"></a>ขั้นตอนถัดไป
ดูข้อมูลเพิ่มเติมเกี่ยวกับ R ใน Power BI

* [กำลังเรียกใช้สคริปต์ R ใน Power BI Desktop](desktop-r-scripts.md)
* [ใช้ R IDE ภายนอกกับ Power BI](desktop-r-ide.md)

