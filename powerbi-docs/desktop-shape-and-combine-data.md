---
title: จัดรูปร่างและรวมแหล่งข้อมูลจากหลายแหล่ง
description: ในบทช่วยสอนนี้ คุณเรียนรู้วิธีการจัดรูปร่าง และรวมข้อมูลใน Power BI Desktop
author: davidiseminger
manager: kfile
ms.reviewer: ''
ms.service: powerbi
ms.component: powerbi-desktop
ms.topic: tutorial
ms.date: 11/28/2018
ms.author: davidi
LocalizationGroup: Transform and shape data
ms.openlocfilehash: e23182b1e607498c5187882740b556455657ba1d
ms.sourcegitcommit: 2ae660a7b70fce23eb58b159d049eca44a664f2c
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 11/30/2018
ms.locfileid: "52670911"
---
# <a name="tutorial-shape-and-combine-data-in-power-bi-desktop"></a>บทช่วยสอน: จัดรูปร่างและรวมข้อมูลใน Power BI Desktop

ด้วย **Power BI Desktop** คุณสามารถเชื่อมต่อกับแหล่งข้อมูลหลายชนิด จากนั้นจัดรูปร่างข้อมูลตามความต้องการของคุณ ให้คุณสามารถสร้างรายงานวิชวลที่คุณสามารถแชร์ให้กับผู้อื่นได้ *การจัดรูป*ข้อมูลหมายถึงการแปลงข้อมูล เช่นการเปลี่ยนชื่อคอลัมน์หรือตาราง การเปลี่ยนแปลงข้อความเป็นตัวเลข ลบแถว การตั้งค่าแถวแรกเป็นหัวเรื่อง และอื่น ๆ *การรวม*ข้อมูลหมายถึงการเชื่อมข้อมูลของสองแหล่งข้อมูลหรือมากกว่า และจัดรูปร่างตามความจำเป็น หลังจากนั้นจึงรวมเป็นคิวรี่ที่เพื่อใช้ประโยชน์

ในบทช่วยสอนนี้ คุณจะได้เรียนรู้วิธีการ:

* จัดรูปร่างข้อมูลโดยใช้**ตัวแก้ไขคิวรี**
* เชื่อมต่อกับแหล่งข้อมูล
* เชื่อมต่อกับอีกแหล่งข้อมูล
* รวมแหล่งข้อมูลเหล่านั้น และสร้างรูปแบบข้อมูลเพื่อใช้ในรายงาน

บทช่วยสอนนี้สาธิตวิธีการจัดรูปร่างคิวรีโดยใช้ Power BI Desktop โดยเน้นที่งานที่ใช้บ่อย คิวรี่ที่ใช้นั้นได้ถูกอธิบายในรายละเอียด รวมทั้งมีวิธีการสร้างคิวรี่ตั้งแต่เริ่มต้น ที่[เริ่มต้นใช้งาน Power BI Desktop](desktop-getting-started.md)

เป็นสิ่งที่มีประโยชน์ที่ทราบว่า**ตัวแก้ไขคิวรี่**ใน Power BI Desktop สามารถใช้ได้โดยการคลิกขวาและใช้ริบบอน สิ่งที่คุณสามารถเลือกได้ส่วนใหญ่ในแถบชุดเครื่องมือ**เพื่อการเปลี่ยนแปลง(Transform ribbon)** สามารถใช้งานได้โดยการคลิกขวาบนไอเทม (เช่น คอลัมน์) แล้วเลือกเมนูที่ปรากฏขึ้น

## <a name="shape-data"></a>จัดรูปร่างข้อมูล
เมื่อคุณจัดรูปแบบข้อมูลในตัวแก้ไขคิว คุณกำลังทำให้มีคำแนะนำทีละขั้นตอน (ซึ่งตัวแก้ไขคิวรีทำให้คุณ) เพื่อปรับเปลี่ยนข้อมูลที่ตัวแก้ไขคิวรีโหลดและแสดง แหล่งข้อมูลต้นฉบับจะไม่ได้รับผลกระทบ จะปรับปรุงเฉพาะมุมมองของข้อมูลที่ถูกปรับ หรือ*ถูกจัดรูป* เท่านั้น

ขั้นตอนคุณระบุ (เช่นการเปลี่ยนชื่อตาราง แปลงชนิดข้อมูล หรือลบคอลัมน์) จะถูกบันทึกโดยตัวแก้ไขคิวรี่ และแต่ละครั้งที่คิวรี่นี้เชื่อมต่อกับแหล่งข้อมูลขั้นตอนเหล่านั้นจะถูกทำขึ้น ทำให้ข้อมูลจะถูกจัดรูปตามที่คุณระบเสมอ กระบวนการนี้เกิดขึ้น เมื่อคุณใช้ตัวแก้ไขคิวของ Power BI Desktop หรือเมื่อใช้คิวรี่ที่ถูกจัดรูป เช่นใช้เซอร์วิสของ **Power BI** ขั้นตอนเหล่านั้นถูกบันทึก ตามลำดับ ในช่อง**การตั้งค่าคิวรี** ภายใต้**ขั้นตอนที่ใช้**

รูปภาพต่อไปนีแสดงช่อง**การตั้งค่าคิวร่ี** สำหรับคิวรี่ที่ถูกปรับรูป เราจะไปถึงขั้นตอนเหล่านั้นในสองสามย่อหน้าถัดไป

![](media/desktop-shape-and-combine-data/shapecombine_querysettingsfinished2.png)

การใช้ข้อมูลที่ถูกจำหน่ายออกจาก[การเริ่มต้นใช้งาน Power BI Desktop](desktop-getting-started.md), ซึ่งเราเจอด้วยการเชื่อมต่อกับแหล่งข้อมูลเว็บ เราต้องจัดรูปแบบข้อมูลที่ใหสอดคล้องกับความต้องการของเรา

สำหรับผู้ใช้งานใหม่ ควรเพิ่มคอลัมนเพื่อคำนวณอันดับโดยที่ว่าข้อมูลทั้งหมดเท่ากับปัจจัยต่างๆ และเปรียบเทียบคอลัมน์นี้กับคอลัมน์_อันดับ_  นี่คือริบบอน**เพิ่มคอลัมน์** ซึ่งมีลูกศรชี้ไปที่ปุ่ม**กำหนดแบบคอลัมน** ซึ่งช่วยให้คุณเพิ่มคอลัมน์แบบกำหนดเอง

![](media/desktop-shape-and-combine-data/shapecombine_customcolumn.png)

ใน่ไดอะล็อก**คอลัมน์แบบกำหนดเอง** ใน**ชื่อคอลัมน์ใหม่** ให้ใส่_อันดับใหม่_และใน**สูตรของคอลัมน์แบบกำหนดเอง** ให้ใสดังนี้:

    ([Cost of living] + [Weather] + [Health care quality] + [Crime] + [Tax] + [Culture] + [Senior] + [#"Well-being"]) / 8

ให้ตรวจสอบสถานข้อความว่าอ่านได้ว่า _'ไม่ตรวจพบข้อผิดพลาดทางไวยากรณ์'_ และคลิก**ตกลง**

![](media/desktop-shape-and-combine-data/shapecombine_customcolumndialog.png)

เมื่อต้องเก็บข้อมูลที่สอดคล้องกันในคอลัมน์ ขอให้แปลงค่าของคอลัมน์ใหม่เป็นจำนวนเต็ม แค่เพียงคลิกขวาที่ส่วนหัวของคอลัมน์ และเลือก**เปลี่ยนชนิด\>จำนวนเต็ม**เพื่อทำการเปลี่ยนแปลง 

หากต้องเลือกมากกว่าหนึ่งคอลัมน์ ก่อนอื่นให้เลือกคอลัมน์ แล้วกดค้างที่ปุ่ม**SHIFT**เลือกคอลัมน์ที่อยู่ติดกันเพิ่มเติม และจากนั้น คลิกขวาที่ส่วนหัวของคอลัมน์เพื่อเปลี่ยนคอลัมน์ที่เลือกทั้งหมด คุณยังสามารถใชคีย์**CTRL**เมื่อต้องเลือกคอลัมน์ที่ไม่อยู่ติดกันได้

![](media/desktop-shape-and-combine-data/shapecombine_changetype2.png)

คุณยังสามารถ*แปลง*ชนิดข้อมูลคอลัมน์จาก**ริบบอนเพื่อการเปลี่ยนแปลง(Transform ribbon)** ได้ นี่คือริบบอนเพื่อการ**เปลี่ยนแปลง** ท่ มีลูกศรชี้ไปยังปุ่ม**ชนิดข้อมูล** ซึ่งช่วยให้คุณแปลงชนิดข้อมูลปัจจุบันให้เป็นชนิดอื่น

![](media/desktop-shape-and-combine-data/queryoverview_transformribbonarrow.png)

โปรดทราบว่า ใน**ตัวตั้งค่าคิวรี** **ขั้นตอนที่ใช้**สะท้อนถึงการปรับรูปข้อมูลที่ทำกับข้อมูลนี้ หากฉันต้องการเอาขั้นตอนใด ๆ ออกจากกระบวนการปรับรูปข้อมูล ฉันเพียงเลือก**X**ทางด้านซ้ายของขั้นตอน ในรูปต่อไปนี้**ขั้นตอนที่ใช้**แสดงขั้นตอนจนถึงปัจจุบัน: เชื่อมต่อไปยังเว็บไซต์ (**แหล่ง**); เลือกตาราง (**การนำทาง**); และ ขณะโหลดตาราง ตัวแก้ไขคิวรี่เปลี่ยนคอลัมน์ตัวเลขฐานตัวอักษรจาก*ข้อความ*เป็น*จำนวนเต็ม* (**เปลี่ยนชนิด**) ขั้นตอนสุดท้ายสองตัวนั้นแสดงการดำเนินการก่อนหน้านี้ของเรา ด้วย**เพิ่มแบบกำหนดเอง**และ**เปลี่ยนชนิด 1** 

![](media/desktop-shape-and-combine-data/shapecombine_appliedstepsearly2.png)

ก่อนที่เราสามารถทำงานกับคิวรี่นี้ เราจำเป็นต้องทำการเปลี่ยนแปลงบางอย่างเพื่อให้รับข้อมูลที่เราต้องการ:

* *ปรับการจัดอันดับโดยลบหนึ่งคอลัมน์* เราตัดสินใจว่า**ค่าครองชีพ** เป็นปัจจัยที่ไม่มีผลกับผลลัพธ์ของเรา หลังจากลบคอลัมน์นี้ เราเจอปัญหาว่าข้อมูลยังคงไม่เปลี่ยนแปลง ถึงแม้ว่าเป็นเรื่องง่ายเมื่อต้องการแก้ไขโดยใช้ Power BI Desktop และการดำเนินการดังกล่าวแสดงถึงฟีเจอร์ที่ยอดเยี่ยมของ **ขั้นตอนที่ใช้**  ในคิวรี่
* *แก้ไขข้อผิดพลาด* เนื่องจากเราลบคอลัมน์ เราจำเป็นต้องปรับการคำนวณในคอลัมน์**อันดับใหม่** ซึ่งเกี่ยวข้องกับการเปลี่ยนแปลงสูตร
* *เรียงลำดับข้อมูล* โดยยึดตามการ**อันดับใหม่**และคอลัมน์**อันดับ** 
* *แทนข้อมูล* เราจะเน้นวิธีการแทนที่ค่าเฉพาะและความจำเป็นของการแทรก**ขั้นตอนทใช้**
* *เปลี่ยนชื่อตาราง* ซึ่ง**ตาราง 0**ไม่ใช่ตัวบอกเกี่ยวกับความเป็นประโยชน์ แต่การเปลี่ยนเป็นเรื่องง่าย

เมื่อต้องการลบคอลัมน์**ค่าครองชีพ** แค่เลือกคอลัมน์ แล้วเลือกแท็บ**หน้าแรก**ของริบบอน แล้ว**ลบคอลัมน์**ดังที่แสดงในรูปต่อไปนี้

![](media/desktop-shape-and-combine-data/shapecombine_removecolumnscostofliving.png)

แจ้งให้ทราบเกี่ยวกับการ_อันดับใหม่_ว่าไม่มีการเปลี่ยนค่า ซึ่ีงสิ่งนี้เป็นไปตามลำดับของขั้นตอน เนื่องจากตัวแก้ไขคิวรีจะบันทึกขั้นตอนตามลำดับ ได้อย่างเป็นอิสระจากกันก็ตาม คุณสามารถย้าย**ขั้นตอนทีใช้**แต่ละตัวขึ้นหรือลงตามลำดับ เพียงคลิกขวาในขั้นตอนใดก็ตาม และตัวแก้ไขคิวร่ีจะโชว์เมนูที่ช่วยให้คุณทำสิ่งต่อไปนี: **เปลี่ยนชื่อ** **ลบ** **ลบ** **จนถึงสุดท้าย** (ลบขั้นตอนในปัจจุบัน และขั้นตอนอื่น ๆ ที่ตามมาทั้งหมดด้วย) **ย้ายขึ้น**หรือ**ย้ายลง** ไปข้างหน้า และย้ายไปยังขั้นตอนสุดท้าย_ลบคอลัมน์_ด้านบนของขั้นตอน_แบบกำหนดเองที่ถูกเพิ่ม_

![](media/desktop-shape-and-combine-data/shapecombine_movestep.png)

ถัดไป เลือกขั้นตอน_แบบกำหนดเองที่ถูกเพิ่ม_ โปรดสังเกตว่า ข้อมูลขณะนี้แสดง_ข้อผิดพลาด_ซึ่งเราจะต้องแก้ไข 

![](media/desktop-shape-and-combine-data/shapecombine_error2.png)

มีสองสามวิธีเพื่อรับข้อมูลเพิ่มเติมเกี่ยวกับข้อผิดพลาดแต่ละรายการ คุณสามารถเลือกเซลล์ (โดยไม่ต้องคลิกที่บนคำว่า**ข้อผิดพลาด**) หรือคลิกที่คำ**ข้อผิดพลาด**โดยตรงได้ ถ้าคุณเลือกเซลล์*โดยไม่ได้*คลิกโดยตรงบนคำ**ข้อผิดพลาด**ตัวแก้ไขคิวรี่จะแสดงข้อมูลข้อผิดพลาดทางด้านล่างของหน้าต่าง

![](media/desktop-shape-and-combine-data/shapecombine_errorinfo2.png)

ถ้าคุณคลิกที่คำ*ข้อผิดพลาด*โดยตรง คิวรี่จะสร้างข้อ**ขั้นตอนใช้**ในช่อง**การตั้งค่าคิวรี**และแสดงข้อมูลที่เกี่ยวกับข้อผิดพลาด เราไม่ต้องการไปที่เส้นทางนี้ ให้เลือก**ยกเลิก**

เพื่อแก้ไขข้อผิดพลาด ให้เลือกคอลัมน์_อันดับใหม่_ แล้วแสดงสูตรข้อมูลของคอลัมน์ โดยการเปิดริบบอน**มุมมอง** และคลิกกล่องเลือก **แถบสูตร** 

![](media/desktop-shape-and-combine-data/shapecombine_formulabar.png)

ในตอนนี้คุณสามารถลบการตั้งค่าของ_ค่าครองชีพ_และลดค่าตัวหาร โดยการเปลี่ยนสูตรดังต่อไปนี้: 

    Table.AddColumn(#"Removed Columns", "New Rank", each ([Weather] + [Health care quality] + [Crime] + [Tax] + [Culture] + [Senior] + [#"Well-being"]) / 7)

เลือกเครื่องหมายถูกสีเขียวทางด้านซ้ายของกล่องแถบสูตรหรือกด**Enter** และข้อมูลควรถูกแทนที ด้วยค่าที่ปรับปรุงแล้ว และขั้นตอน**แบบกำหนดเองที่ถูกเพิ่ม**นั้นควรจะเสร็จสมบูรณ์*โดยที่ไม่มีข้อผิดพลาด* .

> [!NOTE]
> คุณยังสามารถ**ลบข้อผิดพลาด**(โดยใช้ริบบอน(ribbon) หรือเมนูคลิกขวา) ซึ่งจะลบแถวที่มีข้อผิดพลาด ในกรณีนี้ ได้ลบแถวทั้งหมดจากข้อมูลของเรา และเราไม่ต้องการเช่นนั้น เราชอบข้อมูลของเราทั้งหมด และต้องการเก็บไว้ในตาราง

ในตอนนี้เราจำเป็นต้องเรียงลำดับข้อมูลตามคอลัมน์**อันดับใหม่** ก่อนอื่น ให้เลือกขั้นตอนสุดท้ายที่ใช้**เปลี่ยนชนิด 1** เพื่อรับข้อมูลล่าสุด แล้ว เลือกรายการเลือกแบบดึงซึ่งอยู่ถัดจากหัวข้อคอลัมน์**อันดับใหม่** และเลือก**เรียงลำดับจากน้อยไปหา**

![](media/desktop-shape-and-combine-data/shapecombine_sort.png)

ขณะนี้มีการเรียงลำดับข้อมูลตาม**อันดับใหม่**  อย่างไรก็ตาม ถ้าคุณดูในคอลัมน์**อันดับ** คุณจะสังเกตเห็นว่า ข้อมูลจะเรียงลำดับอย่างถูกต้องในกรณีที**อันดับใหม่**นั้นเท่ากัน เพื่อแก้ไขปัญหานี้ ให้เลือกคอลัมน์**อันดับใหม่**และเปลี่ยนสูตรในตัว**แถบสูตร**ดังต่อไปนี้:

    = Table.Sort(#"Changed Type1",{{"New Rank", Order.Ascending},{"Rank", Order.Ascending}})

เลือกเครื่องหมายถูกสีเขียวทางด้านซ้ายของแถบสูตรกล่องหรือกด**Enter**และแถวให้้เป็นไปตามลำดับแถวสอดคล้องกันทั้ง_อันดับใหม่_และ_อันดับ_

นอกจากนี้ คุณสามารถเลือก**ขั้นตอนที่ใช้**ที่ใดก็ได้ในรายการ และจะทำการจัดรูปทรงข้อมูลตอนตามลำดับต่อไปได้ ตัวแก้ไขคิวรี่จะแทรกขั้นตอนใหม่โดยตรงหลังจาก**ขั้นตอนที่ใช้**ที่ถูกเลือกในขณะนี้ มาลองดู

อันดับแรก เลือก**ขั้นตอนที่ใช้**ก่อนที่จะเพิ่มคอลัมน์แบบกำหนดเอง นี่จะเป็นขั้นตอนการ_ลบคอลัมน์_ ต่อไปนี้เราจะแทนค่าของการจัดอันดับของ_สภาพอากาศ_ ในแอริโซนา คลิกขวาบนเซลล์ที่เหมาะสมที่มีการ_จัดอันดับสภาพอากาศของแอริโซนา_ และเลือก*แทนค่า...* จากเมนูที่ปรากฏขึ้น หมายเหตุ**ขั้นตอนที่นำไปใช้**นั้นถูกเลือกอยู่ (ขั้นตอนก่อนหน้าขั้นตอน_แบบกำหนดเองที่ถูกเพิ่ม_)

![](media/desktop-shape-and-combine-data/shapecombine_replacevalues2.png)

เนื่องจากเรากำลังแทรกขั้นตอน ตัวแก้ไขคิวรี่จะเตือนเราเกี่ยวกับสิ่งที่ควรระวังของการดำเนินการดังกล่าว ขั้นตอนต่อไปอาจทำให้คิวรี่ขั้นใช้การไม่ได้ เราจำเป็นต้องใช้ความระมัดระวัง และเอาใจใส่ เนื่องจากบทเรียน และเรากำลังเน้นคุณลักษณะของตัวแก้ไขคิวร่ีแสดงวิธีว่าจะคุณสามารถสร้าง ลบ แทรก และจัดลำดับขั้นตอนอย่างไร เราจะเดือนหน้าต่อ และเลือก**แทรก**

![](media/desktop-shape-and-combine-data/shapecombine_insertstep.png)

เปลี่ยนค่าเป็น_51_และข้อมูลสำหรับแอริโซนานั้นถูกแทนที่ เมื่อคุณสร้างขั้นตอนที่ใช้ใหม่ ตัวแก้ไขคิวรี่จะตั้งชื่อตามการดำเนินการ ในกรณีนี้คือ**ค่าที่ถูกแทน** เมื่อคุณมีมากกว่าหนึ่งขั้นตอนทมีี่ชื่อเดียวกันในคิวรี่ของคุณ ตัวแก้ไขคิวร่จะเพิ่มหมายเลข**ขั้นตอนใช้**แต่ละตัว (ตามลำดับ) เพื่อแยกความแตกต่างระหว่างกัน

ตอนนี้ ให้เลือก**ขั้นตอนที่ใช้**ล่าสุด _เรียงลำดับแถว_และสังเกตว่า มีการเปลี่ยนแปลงข้อมูลที่เกี่ยวข้องกับการจัดอันดับใหม่ของแอริโซนา  ทั้งนี้เนื่องจากเราแทรกขั้นตอน_ค่าที่ถูกแทน_ ในที่ที่ถูกต้อง ก่อนขั้นตอน_แบบกำหนดเองที่ถูกเพิ่ม_

โอเคมันเกี่ยวข้องกันเล็กน้อย แต่ก็เป็นตัวอย่างของวิธีที่มีประสิทธิภาพและยืดหยุ่นเท่าที่ตัวแก้ไขคิวรี่จะสามารถเป็นได้

สุดท้ายนี้ เราต้องการเปลี่ยนชื่อของตารางนั้นให้สื่อความหมาย เมื่อเราไปถึงการสร้างรายงาน ชื่อตารางที่สื่อความหมายนั้นจะมีประโยชน์อย่างยิ่ง โดยเฉพาะเมื่อเราเชื่อมต่อกับแหล่งข้อมูลหลายแหล่ง และทั้งหมดก็เรียงเป็นรายการในช่อง**เขตข้อมูล**ของมุมมองของ**รายงาน**

เปลี่ยนชื่อตารางเป็นเรื่องง่าย: เพียงแค่พิมพ์ชื่อใหม่ของตารางในช่อง**การตั้งค่าคิวรี่** ภายใต้**คุณสมบัติ** ดังที่แสดงในรูปต่อไปนี้ แล้วกด**Enter** ควรเรียกใช้ตาราง *RetirementStats* นี้

![](media/desktop-shape-and-combine-data/shapecombine_renametable2.png)

โอเค เราได้ปรับรูปข้อมูล เพื่อขยายนั้นเราจำเป็นต้อง ถัดไป ให้เชื่อมต่อกับแหล่งข้อมูลอื่น และรวมข้อมูล

## <a name="combine-data"></a>รวมข้อมูล
ข้อมูลเกี่ยวกับรัฐต่าง ๆ นั้นน่าสนใจ และจะเป็นประโยชน์สำหรับการสร้างการวิเคราะห์และการสอบถามเพิ่มเติม แต่มีปัญหาหนึ่ง: ข้อมูลส่วนใหญ่นั้นใช้ตัวอักษรย่อสองตัวสำหรับรหัสรัฐ ไม่ได้ใช่ชื่อเต็มของรัฐ เราต้องทำการเชื่อมโยงชื่อรัฐกับคำอักษรย่อของรัฐ

เราโชคดีที่ยังมีแหล่งข้อมูลสาธารณะอื่นดำเนินการเช่นนี้ แต่จำเป็นต้องมีการปรับรูปสมควรก่อนที่เราจะสามารถเชื่อมโยงข้อมูลดังกล่าวเข้ากับตารางข้อมูลการเกษียณของเราได้ นี่แหล่งข้อมูลเว็บเกี่ยวกับตัวอักษรย่อของรัฐ

<http://en.wikipedia.org/wiki/List_of_U.S._state_abbreviations>

จากริบบอน**หน้าแรก** ในตัวแก้ไขคิวรี่ เราเลือก**แหล่งข้อมูล่\>เว็บใหม**และพิมพ์ที่อยู่เว็บ เลือก**เชื่อมต่อ**และเบราเซอร์จะแสดงสิ่งที่พบในหน้าเว็บ

 ![](media/desktop-shape-and-combine-data/designer_gsg_usstateabbreviationsnavigator2.png)

เราเลือก**โค้ดและตัวอักษรย่อ...** เพราะว่ามีข้อมูลที่เราต้องการ แต่มันต้องใช้เวลาเพื่อปรับรูปข้อมูลของตารางลงไปให้เป็นสิ่งที่เราต้องการ

> [!TIP]
> มีวิธีง่ายหรือเร็วกว่าในการทำขั้นตอนด้านล่างหรือไม่ ใช่ เราสามารถสร้างการ*ความสัมพันธ์*ระหว่างตารางสองตาราง และปรับรูปร่างข้อมูลตามความสัมพันธ์ได้ ขั้นตอนต่อไปนีนั้นดีที่จะเรียนรู้เพื่อทำงานกับตาราง เพียงทราบความสัมพันธ์สามารถช่วยคุณใช้ข้อมูลจากตารางหลายตารางได้อย่างรวดเร็ว
> 
> 

เพื่อให้ข้อมีอยู่รูปแบบ เราทำขั้นตอนดังต่อไปนี้

* ลบแถวบนสุด ซึ่งเป็นผลลัพธ์ของวิธีการที่ตารางของเว็บเพจถูกสร้างขึ้น และเราไม่ต้องการมัน จากริบบอน**หน้าแรก** เลือก**ลดแถว\>ลบแถว\>ลบแถวด้านบน**

![](media/desktop-shape-and-combine-data/shapecombine_removetoprows.png)

หน้าต่าง**ลบแถวด้านบน**ปรากฏขึ้น เพื่อแจ้งให้คุณระบุจำนวนแถวที่คุณต้องการลบ

>[!NOTE]
>ถ้า Power BI นำส่วนหัวของตารางมาเป็นแถวในตารางข้อมูลของคุณโดยไม่ได้ตั้งใจ คุณสามารถเลือก**ใช้แถวแรกเป็นส่วนหัวของตาราง**จากแท็บ**หน้าแรก** หรือจากการแท็บ**แปลง**ในริบบอน เพื่อแก้ไขตารางของคุณ

* ลบ 26 แถวด้านล่าง ทั้งหมดอยู่บริเวณ ซึ่งเราไม่จำเป็นต้องมี จากริบบอน**หน้าแรก** เลือก**ลดแถว\>ลบแถว\>ลบแถวด้านล่าง**

![](media/desktop-shape-and-combine-data/shapecombine_removebottomrows.png)

* เนื่องจากตาราง RetirementStats ไม่มีข้อมูลสำหรับ วอชิงตัน ดี.ซี. เราจำเป็นต้องกรองข้อมูลจากรายการของเรา เลือกลูกศรดรอปดาวน์ข้าง ๆ คอลัมน์สถานะภูมิภาค จากนั้นยกเลิกการเลือกกล่องเลือกด้านข้าง**เขตของรัฐบาลกลาง**

![](media/desktop-shape-and-combine-data/shapecombine_filterdc.png)

* ลบคอลัมน์ที่ไม่จำเป็นบางตัว เราเพียงแค่แมปรัฐกับตัวอักษรย่ออย่างเป็นทางการสองตัว ดังนั้นเราสามารถลบคอลัมน์ต่อไปนี้: **Column1**, **Column3**, **Column4**แล้ว**Column6**ผ่าน**Column11** ก่อนอื่น ให้เลือก**Column1**แล้ว กดคีย์**CTRL**ค้างไว้ และเลือกคอลัมน์อื่นเพื่อที่จะถูกเอาออก (ซึ่งช่วยให้คุณสามารถเลือกหลายคอลัมน์ และคอลัมน์ที่ไม่อยู่ติดกันได้) จากแท็บริบบอนหน้าแรก เลือก**ลบคอลัมน์\>ลบคอลัมน์**

![](media/desktop-shape-and-combine-data/shapecombine_removecolumns.png)

>[!NOTE]
>นี่คือเวลาดีที่จะใส่ใจ*ลำดับ*ของขั้นตอนที่ใช้ในตัวแก้ไขคิวรี่ว่าเป็นสิ่งสำคัญ และอาจส่งผลต่อวิธีการจัดรูปข้อมูล เป็นสิ่งสำคัญเช่นกันที่ต้องพิจารณาว่าขั้นตอนหนึ่งอาจจะส่งผลกระทบต่อขั้นตอนถัดไปอย่างไร ถ้าคุณลบขั้นตอนจากขั้นตอนที่ใช้ ขั้นตอนต่อไปอาจจะไม่ทำงานแบบที่ตั้งใจไว้แต่แรก เนื่องจากผลกระทบของลำดับขั้นตอนของคิวรี่

>[!NOTE]
>เมื่อคุณปรับขนาดหน้าต่างตัวแก้ไขคิวรี่ให้เล็กลง บางไอเท็มของริบบอน ถูกบีบเพื่อทำให้การใช้ที่ดีที่สุดของพื้นที่ที่สามารถมองเห็นได้ เมื่อคุณเพิ่มความกว้างของหน้าต่างของตัวแก้ไขคิวรี่ ไอเท็มของริบบอน ขยายเพื่อให้การใช้ส่วนใหญ่ของพื้นที่ของริบบอนที่เพิ่มขึ้น

* เปลี่ยนชื่อคอลัมน์ และตัวตารางเอง ตามปกติ มีสองสามวิธีเพื่อเปลี่ยนชื่อคอลัมน์ ก่อนอื่น ให้เลือกคอลัมน์ จาก นั้นให้เลือก**เปลี่ยนชื่อ**จากแท็บ**เปลี่ยนแปลง**บนริบบอน หรือคลิกขวา แล้วเลือก**เปลี่ยนชื่อ...** จากเมนูที่ปรากฏขึ้น รูปต่อไปนี้มีลูกศรที่ชี้ไปยังตัวเลือกทั้งสอง คุณต้องเลือกหนึ่งในนั้น

![](media/desktop-shape-and-combine-data/shapecombine_rename.png)

ให้เปลี่ยนชื่อเป็น*ชื่อรัฐ*และ*รหัสรัฐ* เมื่อต้องการเปลี่ยนชื่อตาราง เพียงแค่พิมพ์ชื่อลงในกล่อง**ชื่อ**ในช่อง**การตั้งค่าคิวร่ี** ให้เรียกตาราง*StateCodes*

ตอนนี้เราได้ปรับรูปแบบตาราง StateCodes ตามที่เราต้องการแล้ว ให้รวมสองตารางนี้ หรือสองคิวรี่นี้ให้เป็นหนึ่งเดียวกัน เนื่องจากตารางที่เรามีตอนนี้เป็นผลลัพธ์ของคิวรี่ที่เรานำไปใช้กับข้อมูล ซึ่งมักจะเรียกว่า*คิวรี่*

มีสองวิธีหลักของการรวมคิวรี่ *ผสาน*และ*ผนวก*

เมื่อคุณมีหนึ่งหรือสองคอลัมน์ที่คุณต้องการเพิ่มลงในคิวรี่อื่น คุณทำการ**ผสาน**คิวรี่ เมื่อคุณมีแถวของข้อมูลเพิ่มเติมที่คุณต้องการเพิ่มลงในคิวรี่ที่มีอยู่ คุณนั้นทำการ**ผนวก**คิวรี่

ในกรณีนี้ เราต้องการผสานคิวรี เพื่อเริ่มต้นใช้งาน จากพื้นที่ด้านซ้ายของตัวแก้ไขคิวรี่ เราเลือกคิวรี่*ว่า*เราต้องรวมกับคิวรี่อื่น ซึ่งในกรณีนี้คือ*RetirementStats* แล้ว เลือก**รวม\>ผสานคิวรี่**จากแท็บ**หน้าแรก**บนริบบอน

![](media/desktop-shape-and-combine-data/shapecombine_mergequeries.png)

คุณอาจพร้อมที่จะตั้งค่าระดับความเป็นส่วนตัว เพื่อให้แน่ใจว่าข้อมูลจะถูกรวมไว้โดยไม่รวมหรือถ่ายโอนข้อมูลที่คุณไม่ต้องการให้โอน

ถัดไปหน้าต่าง**ผสาน**ปรากฏขึ้น เราเมื่อต้องเลือกตารางที่เราต้องผสานลงในตารางที่เลือก จากนั้น คอลัมน์ที่ตรงกันจะใช้สำหรับการผสาน สถานะการเลือกจากตาราง(คิวรี่) *RetirementStats* จากนั้นเลือก คิวรี่*StateCodes*(ง่ายในกรณีนี้ เนื่องจากมีคิวอื่น ๆ เพียงคิวเดียวเท่านั้น เมื่อคุณเชื่อมต่อกับแหล่งข้อมูลหลายแหล่ง มีคิวรี่ที่ต้องเลือกหลายตัว) เมื่อเราเลือกคอลัมน์ที่ตรงกันอย่างถูกต้องแล้ว **รัฐ**จาก*RetirementStats*และ**ชื่อรัฐ**จาก*StateCodes* หน้าต่าง**ผสาน**มีลักษณะดังต่อไปนี้ และปุ่ม**ตกลง**ได้ถูกเปิดใช้งาน

![](media/desktop-shape-and-combine-data/shapecombine_merge2.png)

**NewColumn**ถูกสร้างขึ้นที่ส่วนท้ายของคิวรี่ ซึ่งเป็นเนื้อหาของตาราง (คิวรี่) ที่ถูกผสานเข้ากับคิวรี่ที่มีอยู่ คอลัมน์ทั้งหมดจากแบบคิวรี่ที่ผสานนั้นย่อลงในการ**NewColumn**แต่คุณสามารถเลือกตาราง**ขยาย** และรวมถึงคอลัมน์ใดก็ตามที่คุณต้องการ

![](media/desktop-shape-and-combine-data/shapecombine_mergenewcolumn.png)

เมื่อต้องการขยายตารางที่ผสานแล้ว และเลือกคอลัมน์ที่จะรวม เลือกไอคอนขยาย (![ขยาย](media/desktop-shape-and-combine-data/icon.png)) หน้าต่าง**ขยาย**ปรากฏขึ้น

![](media/desktop-shape-and-combine-data/shapecombine_mergeexpand.png)

ในกรณีนี้ เราเพียงแค่ต้องการ**คอลัมน์**รหัสรัฐ ดังนั้นเราจึงเลือกเพียงคอลัมน์นั้น แล้วจึง เลือก**ตกลง** เรายกเลิกการเลือกกล่องเลือก จากใช้ชื่อคอลัมน์เดิมเป็นคำนำหน้า เนื่องจากเราไม่จำเป็นหรือต้องการ ถ้าเรายังปล่อยยังถูกเลือกอยู่ คอลัมน์ผสานแล้วจะมีชื่อว่า**NewColumn.State Code** (ชื่อคอลัมน์เดิม หรือ**NewColumn**แล้วจุด จากนั้นเป็นชื่อของคอลัมน์ถูกนำเข้ามายังคิวรี่)

>[!NOTE]
>ต้องการลองว่าจะการนำเข้าตาราง**NewColumn**ได้อย่างไรหรือไม่ คุณสามารถลองใช้ดูสักเล็กน้อย และถ้าคุณไม่ชอบผลลัพธ์ ก็แค่ลบขั้นตอนนั้นจากรายการ**ขั้นตอนที่ใช้** ซึ่งอยู่ในช่อง**การตั้งค่าคิวร่ี่** คิวรี่ของคุณจะกลับไปยังรัฐก่อนที่จะมีการใช้ขั้นตอน**ขยาย**นั้น มันเหมือนการแก้ไขฟรี ซึ่งคุณสามารถทำได้หลายครั้ง ตามที่คุณต้องการจนกว่ากระบวนการขยายมีลักษณะตามที่คุณต้องการ

ในตอนนี้เรามีคิวรี่ (ตาราง) ที่รวมแหล่งข้อมูลสองแหล่ง ซึ่งแต่ละแหล่งถูกปรับรูปร่างให้ตรงตามความต้องการของเรา คิวรี่นี้สามารถทำหน้าที่เป็นฐานสำหรับการเชื่อมต่อข้อมูลเพิ่มเติมและข้อมูลที่น่าสนใจเป็นจำนวนมาก เช่นสถิตค่าใช้จ่ายครัวเรือน ข้อมูลประชากร หรือโอกาสการทำงานในทุกๆรัฐ

เพื่อทำการเปลี่ยนแปลงและปิดตัวแก้ไขคิวรี่ ให้เลือก**ปิดและใช้**จากแท็บ**หน้าแรก**บนริบบอน การแปลงชุดข้อมูลที่ปรากฏใน Power BI Desktop นั้นพร้อมที่จะใช้สร้างรายงาน

![](media/desktop-shape-and-combine-data/shapecombine_closeandapply.png)

## <a name="next-steps"></a>ขั้นตอนถัดไป
มีมากมายหลากหลายสิ่งที่คุณสามารถทำได้ด้วย Power BI Desktop สำหรับข้อมูลเพิ่มเติมเกี่ยวกับขีดความสามารถ กรุณาดูแหล่งทรัพยากรต่อไปนี้:

* [Power BI Desktop คืออะไร](desktop-what-is-desktop.md)
* [ภาพรวมคิวรี่กับ Power BI Desktop](desktop-query-overview.md)
* [แหล่งข้อมูลใน Power BI Desktop](desktop-data-sources.md)
* [เชื่อมต่อกับข้อมูลใน Power BI Desktop](desktop-connect-to-data.md)
* [งานคิวรี่ทั่วไปใน Power BI Desktop](desktop-common-query-tasks.md)   

