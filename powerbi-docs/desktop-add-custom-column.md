---
title: เพิ่มคอลัมน์แบบกำหนดเองใน Power BI Desktop
description: สร้างคอลัมน์แบบกำหนดเองใหม่ใน Power BI Desktop ได้อย่างรวดเร็ว
author: davidiseminger
manager: kfile
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-desktop
ms.topic: conceptual
ms.date: 05/07/2019
ms.author: davidi
LocalizationGroup: Create reports
ms.openlocfilehash: e2412fe72d62549277001b64121ecf9db2ea5502
ms.sourcegitcommit: 60dad5aa0d85db790553e537bf8ac34ee3289ba3
ms.translationtype: MT
ms.contentlocale: th-TH
ms.lasthandoff: 05/29/2019
ms.locfileid: "65239551"
---
# <a name="add-a-custom-column-in-power-bi-desktop"></a>เพิ่มคอลัมน์แบบกำหนดเองใน Power BI Desktop
คุณสามารถเพิ่มคอลัมน์แบบกำหนดเองใหม่ของข้อมูล ลงในรูปแบบของคุณด้วย**ตัวแก้ไขคิวรี**ใน **Power BI Desktop** ได้ คุณสามารถสร้าง และเปลี่ยนชื่อคอลัมน์แบบกำหนดเองของคุณ โดยใช้ปุ่มเพื่อสร้าง[สูตร M](https://msdn.microsoft.com/library/mt270235.aspx) ที่กำหนดคอลัมน์แบบกำหนดเองของคุณได้อย่างง่าย ๆ สูตร M มี[ชุดเนื้อหา การอ้างอิงฟังก์ชันที่ครอบคลุม](https://msdn.microsoft.com/library/mt779182.aspx) 

![](media/desktop-add-custom-column/add-custom-column_01.png)

การสร้างคอลัมน์แบบกำหนดเอง เป็นอีก**ขั้นตอนที่กำหนดใช้**ในคิวรี ที่คุณสร้างใน**ตัวแก้ไขคิวรี** ซึ่งหมายความว่า สามารถเปลี่ยน ย้ายลำดับก่อนหรือหลัง หรือปรับเปลี่ยนเมื่อไรก็ได้

## <a name="use-query-editor-to-add-a-new-custom-column"></a>ใช้ตัวแก้ไขคิวรีเพื่อเพิ่มคอลัมน์แบบกำหนดเองใหม่
เพื่อสร้างคอลัมน์ใหม่ที่กำหนดเอง เรียกใช้**ตัวแก้ไขคิวรี** คุณสามารถทำได้โดยการเลือก**แก้ไขคิวรี**จาก ribbon **หน้าแรก** ใน**Power BI Desktop**

![](media/desktop-add-custom-column/add-column-from-example_02.png)

เมื่อ**ตัวแก้ไขคิวรี**เริ่มทำงาน และคุณโหลดข้อมูลบางอย่างไว้แล้ว คุณสามารถเพิ่มคอลัมน์แบบกำหนดเอง โดยการเลือกแท็บ**เพิ่มคอลัมน์**บน ribbon จากนั้นเลือก**คอลัมน์แบบกำหนดเอง**

![](media/desktop-add-custom-column/add-custom-column_02.png)

หน้าต่าง**เพิ่มคอลัมน์แบบกำหนดเอง**จะปรากฏขึ้น ซึ่งจะอธิบายในส่วนต่อไปนี้

## <a name="the-add-custom-column-window"></a>หน้าต่างเพิ่มคอลัมน์แบบกำหนดเอง
ในหน้าต่าง**เพิ่มคอลัมน์แบบกำหนดเอง** คุณเห็นรายการเขตข้อมูลที่มีในบานหน้าต่างทางด้านขวา ชื่อคอลัมน์แบบกำหนดเองของคุณอยู่ด้านบน (คุณสามารถเปลี่ยนชื่อ โดยพิมพ์ชื่อใหม่ในกล่องข้อความ) และ[สูตร **M**](https://msdn.microsoft.com/library/mt779182.aspx) ที่คุณสร้าง (หรือเขียน) จากการแทรกเขตข้อมูลจากด้านขวา เพิ่มตัวดำเนินการ หรือสร้างสูตร ที่กำหนดคอลัมน์แบบกำหนดเองใหม่ของคุณ 

![](media/desktop-add-custom-column/add-custom-column_03.png)

## <a name="create-formulas-for-your-custom-column"></a>สร้างสูตรสำหรับคอลัมน์แบบกำหนดเองของคุณ
คุณสามารถเลือกเขตข้อมูลจากรายการ**คอลัมน์ที่มีให้เลือกใช้งาน:** ทางด้านขวา และเลือก **<< แทรก** เพื่อเพิ่มลงในสูตรของคอลัมน์แบบกำหนดเอง คุณสามารถเพียงแค่ ดับเบิลคลิก บนคอลัมน์รายการเพื่อเพิ่มลงไป

เมื่อคุณพิมพ์สูตรและสร้างคอลัมน์ของคุณ ในด้านล่างของหน้าต่าง คุณจะเห็นตัวบ่งชี้ที่บอกคุณในแบบเรียลไทม์ (ตามที่คุณพิมพ์) ว่ามีการตรวจพบข้อผิดพลาดทางไวยากรณ์หรือไม่ ถ้าทุกอย่างถูกต้อง คุณจะเห็นเครื่องหมายถูกสีเขียว

![](media/desktop-add-custom-column/add-custom-column_04.png)

แต่ถ้าคุณมีข้อผิดพลาดบางอย่างในไวยากรณ์ของคุณ คุณจะได้รับไอคอนเตือนสีเหลือง พร้อมกับข้อผิดพลาดที่ตรวจพบ และลิงก์ที่วางเคอร์เซอร์ (ในสูตรของคุณ) ตรงจุดที่พบข้อผิดพลาด

![](media/desktop-add-custom-column/add-custom-column_05.png)

เมื่อคุณเลือก**ตกลง** คอลัมน์แบบกำหนดเองของคุณจะถูกเพิ่มลงในรูปแบบ และขั้นตอน**มีการเพิ่มคอลัมน์แบบกำหนดเองแล้ว** จะถูกเพิ่มลงใน**ขั้นตอนที่กำหนดใช้**ของคิวรีคุณ

![](media/desktop-add-custom-column/add-custom-column_06.png)

ถ้าคุณดับเบิลคลิกขั้นตอน**มีการเพิ่มคอลัมน์แบบกำหนดเองแล้ว** ในบานหน้าต่าง**ขั้นตอนที่กำหนดใช้** หน้าต่าง**เพิ่มคอลัมน์แบบกำหนดเอง**จะปรากฏขึ้นอีกครั้ง และโหลดสูตรคอลัมน์แบบกำหนดเองที่คุณสร้าง พร้อมให้คุณแก้ไขถ้าจำเป็น

## <a name="using-the-advanced-editor-for-custom-columns"></a>การใช้เครื่องมือแก้ไขขั้นสูง สำหรับคอลัมน์แบบกำหนดเอง
คุณยังสามารถสร้างคอลัมน์แบบกำหนดเอง (และปรับเปลี่ยนคิวรีใด ๆ ของคุณ) โดยใช้**เครื่องมือแก้ไขขั้นสูง**ได้ ใน**ตัวแก้ไขคิวรี** เลือกแท็บ**มุมมอง** จากนั้นเลือก**เครื่องมือแก้ไขขั้นสูง**เพื่อแสดง**เครื่องมือแก้ไขขั้นสูง**

![](media/desktop-add-custom-column/add-custom-column_07.png)

**เครื่องมือแก้ไขขั้นสูง**ให้คุณควบคุมทุกอย่างของคิวรีคุณ

## <a name="next-steps"></a>ขั้นตอนถัดไป
มีวิธีอื่น ๆ ในการสร้างคอลัมน์แบบกำหนดเอง รวมถึงการสร้างคอลัมน์จากตัวอย่างที่คุณให้กับ**ตัวแก้ไขคิวรี** ดูบทความต่อไปนี้สำหรับข้อมูลเพิ่มเติมเกี่ยวกับการสร้างคอลัมน์แบบกำหนดเองจากตัวอย่าง:

* [เพิ่มคอลัมน์จากตัวอย่างใน Power BI Desktop](desktop-add-column-from-example.md)
* [บทนำสู่ภาษาสูตร M](https://msdn.microsoft.com/library/mt270235.aspx)
* [การอ้างอิงฟังก์ชัน M](https://msdn.microsoft.com/library/mt779182.aspx)  

