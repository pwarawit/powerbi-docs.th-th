---
title: เกตเวย์ข้อมูลในองค์กรในเชิงลึก
description: บทความนี้จะดูที่เกตเวย์ภายในองค์กรแบบเชิงลึก ซึ่งจะดูวิธีการทำงานของบริการกับ Azure Active Directory และ Active Directory ภายในเครื่องของคุณเมื่อทำงานกับ Analysis Services
author: mgblythe
manager: kfile
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-gateways
ms.topic: conceptual
ms.date: 12/06/2017
ms.author: mblythe
LocalizationGroup: Gateways
ms.openlocfilehash: fa7d10403ca6bd8dc94729b7b4fd631475a3671e
ms.sourcegitcommit: 20ae9e9ffab6328f575833be691073de2061a64d
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 03/22/2019
ms.locfileid: "58383427"
---
# <a name="on-premises-data-gateway-in-depth"></a>เกตเวย์ข้อมูลในองค์กรในเชิงลึก
การเข้าถึงข้อมูลภายในองค์กรเป็นไปได้สำหรับผู้ใช้ในองค์กรของคุณ (ในกรณีที่ผู้ใช้ดังกล่าวได้รับอนุญาตการเข้าถึง) แต่ก่อนที่ผู้ใช้เหล่านั้นจะสามารถเชื่อมต่อกับแหล่งข้อมูลภายในองค์กรของคุณ จำเป็นต้องมีการติดตั้งเกตเวย์ข้อมูลในและกำหนดค่าก่อน เกตเวย์อำนวยความสะดวกการติดต่อสื่อสารเบื้องหลังที่รวดเร็วและปลอดภัยระหว่างผู้ใช้ในระบบคลาวด์ไปยังแหล่งข้อมูลภายในองค์กร และย้อนกลับแล้วไปยังระบบคลาวด์อีกครั้ง

การติดตั้งและกำหนดค่าเกตเวย์มักจะดำเนินการโดยผู้ดูแลระบบ ซึ่งอาจจำเป็นต้องมีความรู้พิเศษในเซิร์ฟเวอร์ภายในองค์กรของคุณ และในบางกรณีอาจจำเป็นต้องมีสิทธิ์เป็นผู้ดูแลเซิร์ฟเวอร์

บทความนี้ไม่ได้ให้คำแนะนำทีละขั้นตอนเกี่ยวกับวิธีการติดตั้งและกำหนดค่าเกตเวย์ ตรวจสอบให้แน่ใจว่าเห็น[เกตเวย์ข้อมูลภายในองค์กร](service-gateway-onprem.md) บทความนี้มีไว้เพื่อให้คุณทำความเข้าใจอย่างลึกซึ้งว่า เกตเวย์ทำงานอย่างไร นอกจากนี้ เราจะลงลึกในรายละเอียดเกี่ยวกับชื่อผู้ใช้และการรักษาความปลอดภัยในทั้ง Azure Active Directory และ Analysis Services รวมถึงวิธีการที่บริการระบบคลาวด์ใช้อีเมลของผู้ใช้ในการลงชื่อเข้าใช้ เกตเวย์ และ Active Directory เพื่อเชื่อมต่อและร้องขอข้อมูลในองค์กรของคุณได้อย่างปลอดภัย

<!-- Shared Requirements Include -->
[!INCLUDE [gateway-onprem-requirements-include](./includes/gateway-onprem-how-it-works-include.md)]

<!-- Shared Install steps Include -->
[!INCLUDE [gateway-onprem-datasources-include](./includes/gateway-onprem-datasources-include.md)]

## <a name="sign-in-account"></a>ลงชื่อเข้าใช้บัญชี
ผู้ใช้สามารถลงชื่อเข้าใช้ด้วยบัญชีทำงานหรือบัญชีโรงเรียน นี่คือบัญชีองค์กรของคุณ หากคุณลงชื่อสมัครใช้ข้อเสนอของ Office 365 และไม่ได้ใส่อีเมลที่ใช้ทำงานจริงของคุณ อาจส่งผลให้มีลักษณะคล้ายnancy@contoso.onmicrosoft.comได้ บัญชีของคุณภายในบริการคลาวด์จะได้รับการจัดเก็บภายในบัญชีผู้เช่าใน Azure Active Directory (AAD) ในกรณีส่วนใหญ่ UPN ของบัญชี AAD ของคุณจะตรงกับที่อยู่อีเมล

## <a name="authentication-to-on-premises-data-sources"></a>รับรองความถูกต้องไปยังแหล่งข้อมูลภายในองค์กร
ข้อมูลประจำตัวที่จัดเก็บไว้จะถูกใช้เพื่อเชื่อมต่อกับแหล่งข้อมูลภายในองค์กรจากเกตเวย์ ยกเว้น Analysis Services เกตเวย์ใช้ข้อมูลประจำตัวที่จัดเก็บไว้ในการเชื่อมต่อ โดยไม่คำนึงถึงผู้ใช้แต่ละราย

## <a name="authentication-to-a-live-analysis-services-data-source"></a>รับรองความถูกต้องไปยังแหล่งข้อมูล Analysis Services แบบออนไลน์
แต่ละครั้งที่ผู้ใช้โต้ตอบ Analysis Services ชื่อผู้ใช้ที่มีผลบังคับใช้ถูกส่งผ่านไปยังเกตเวย์ แล้วไปยังเซิร์ฟเวอร์ Analysis Services ภายในองค์กรของคุณ สำหรับชื่อผู้ใช้หลัก (UPN) โดยปกติแล้วที่อยู่อีเมลที่คุณใช้ลงชื่อเข้าระบบคลาวด์เป็นสิ่งที่เราจะใช้เพื่อผ่านไปยัง Analysis Services ในฐานะเป็นผู้ใช้ที่มีสิทธิ์ UPN จะถูกส่งผ่านในคุณสมบัติการเชื่อมต่อ EffectiveUserName อีเมลนี้ควรตรงกับ UPN ที่กำหนดไว้ภายในโดเมน Active Directory ภายในเครื่อง UPN เป็นคุณสมบัติของบัญชีผู้ใช้ Active Directory บัญชีผู้ใช้ Windows นั้นจึงจำเป็นต้องมีอยู่ในบทบาท Analysis Services เพื่อให้สามารถเข้าถึงเซิร์ฟเวอร์ได้ การเข้าสู่ระบบจะไม่ประสบความสำเร็จถ้าไม่พบว่าไม่ตรงใน Active Directory

นอกจากนี้ Analysis Services ยังสามารถมีการกรองโดยยึดตามบัญชีผู้ใช้นี้ การกรองสามารถเกิดขึ้นกับทั้งการรักษาความปลอดภัยตามบทบาทหรือการรักษาความปลอดภัยระดับแถว

## <a name="role-based-security"></a>รักษาความปลอดภัยตามบทบาท
แบบจำลองจะมีการรักษาความปลอดภัยตามบทบาทของผู้ใช้ กำหนดบทบาทสำหรับโครงการแบบจำลองเฉพาะในระหว่างการเขียนในเครื่อง SQL Server Data – ข่าวกรองธุรกิจ (SSDT-BI) หรือหลังจากมีการใช้งานแบบจำลอง โดยใช้ SQL Server Management Studio (SSMS) บทบาทประกอบด้วยสมาชิก โดยแยกตามชื่อผู้ใช้ Windows หรือกลุ่มของ Windows บทบาทกำหนดสิทธิ์ที่ผู้ใช้มีในการร้องขอหรือดำเนินการกับแบบจำลอง ผู้ใช้ส่วนใหญ่จะมีหนึ่งบทบาทที่มีสิทธิ์การใช้งานแบบอ่าน บทบาทอื่น ๆ มีไว้สำหรับผู้ดูแลระบบที่มีสิทธิ์ในการประมวลผลรายการ จัดการฟังก์ชันฐานข้อมูล และจัดการบทบาทอื่น

## <a name="row-level-security"></a>รักษาความปลอดภัยตามระดับแถว
การรักษาความปลอดภัยระดับแถวมีไว้เฉพาะสำหรับการรักษาความปลอดภัยระดับแถว Analysis Services แบบจำลองสามารถให้การรักษาความปลอดภัยแบบไดนามิกและระดับแถว การรักษาความปลอดภัยแบบไดนามิกไม่จำเป็นสำหรับแบบจำลองใด ๆ ซึ่งไม่เหมือนกับการมีอย่างน้อยหนึ่งบทบาทที่ผู้ใช้ต้องมี การรักษาความปลอดภัยแบบไดนามิก ระบบกำหนดการเข้าถึงแบบอ่านของผู้ใช้ในการเข้าใช้ข้อมูลสำหรับบางแถวในตารางใดตารางหนึ่งที่ระดับสูง คล้ายกับบทบาทต่าง ๆ การรักษาความปลอดภัยระดับแถวแบบไดนามิกจะต้องอาศัยชื่อผู้ใช้ Windows ของผู้ใช้

ความสามารถของผู้ใช้ในการร้องขอและดูข้อมูลแบบจำลองจะกำหนดครั้งแรกโดยบทบาทที่บัญชีผู้ใช้ Windows เป็นสมาชิก และประการที่สอง โดยการรักษาความปลอดภัยระดับแถวแบบไดนามิก หากมีการกำหนดค่าไว้

การนำบทบาทและการรักษาความปลอดภัยระดับแถวแบบไดนามิกไปใช้ในแบบจำลองอยู่นอกขอบเขตของบทความนี้  คุณสามารถเรียนรู้เพิ่มเติมได้ที่[บทบาท (SSAS แบบตาราง)](https://msdn.microsoft.com/library/hh213165.aspx)และ[บทบาทการรักษาความปลอดภัย (Analysis Services - ข้อมูลหลายมิติ)](https://msdn.microsoft.com/library/ms174840.aspx)บน MSDN ได้ สำหรับความเข้าใจเชิงลึกที่สุดของการรักษาความปลอดภัยแบบจำลองแบบตาราง ให้ดาวน์โหลดและอ่านเอกสารทางเทคนิค Securing [ Tabular BI Semantic Model](https://msdn.microsoft.com/library/jj127437.aspx)

## <a name="what-about-azure-active-directory"></a>แล้ว Azure Active Directory ล่ะ?
บริการระบบคลาวด์ของ Microsoft ใช้ [Azure Active Directory](/azure/active-directory/fundamentals/active-directory-whatis)ในดูแลผู้ใช้การรับรองความถูกต้อง Azure Active Directory คือผู้เช่าที่ประกอบด้วยกลุ่มการรักษาความปลอดภัยและชื่อผู้ใช้ โดยทั่วไปแล้ว ที่อยู่อีเมลที่ผู้ใช้ใช้ลงชื่อเข้าระบบ จะเหมือนกับ UPN ของบัญชีผู้ใช้

บทบาทของฉันภายใน Active Directory คืออะไร?

สำหรับ Analysis Services เพื่อตรวจสอบว่าผู้ใช้ที่เชื่อมต่ออยู่มีบทบาทที่มีสิทธิ์ในการอ่านข้อมูลหรือไม่ เซิร์ฟเวอร์ต้องแปลงชื่อผู้ใช้ที่สามารถใช้งานได้ที่ส่งมาจาก AAD มายังเกตเวย์ การเข้าไปในเซิร์ฟเวอร์ Analysis Services เซิร์ฟเวอร์ Analysis Services ส่งผ่านชื่อผู้ใช้ที่สามารถใช้ได้ไปยังตัวควบคุมโดเมน (Domain controller: DC) Windows Active Directory จานั้น ควบคุมโดเมน Active Directory จะทำการตรวจสอบชื่อผู้ใช้ที่ใช้งานได้เป็น UPN ที่ถูกต้องบนบัญชีในเครื่อง และส่งกลับชื่อผู้ใช้ Windows ของผู้ใช้รายนั้นกลับไปยังเซิร์ฟเวอร์ Analysis Services

EffectiveUserName ไม่สามารถใช้บนเซิร์ฟเวอร์รวมเข้ากันที่ไม่ใช่โดเมน Analysis Services ได้ เซิร์ฟเวอร์ Analysis Services ต้องรวมเข้ากับโดเมนเพื่อหลีกเลี่ยงข้อผิดพลาดการเข้าสู่ระบบ

## <a name="how-do-i-tell-what-my-upn-is"></a>ฉันจะทราบได้อย่างไรว่า UPN ของฉันเป็นอะไร?
คุณอาจไม่ทราบว่า UPN ของคุณเป็นอะไร และคุณอาจจะไม่ใช่ผู้ดูแลระบบโดเมน คุณสามารถใช้คำสั่งต่อไปนี้จากเวิร์กสเตชันของคุณเพื่อค้นหา UPN สำหรับบัญชีของคุณได้

    whoami /upn

ผลลัพธ์จะมีลักษณะคล้ายกับอีเมล แต่นี่คือ UPN ที่อยู่ในบัญชีโดเมนในเครื่องของคุณ ถ้าคุณกำลังใช้แหล่งข้อมูล Analysis Services สำหรับการเชื่อมต่อสด การกระทำเช่นนี้ต้องตรงกับสิ่งที่ถูกส่งผ่านไปยัง EffectiveUserName จากเกตเวย์ดังกล่าว

## <a name="mapping-usernames-for-analysis-services-data-sources"></a>การแมปชื่อผู้ใช้สำหรับแหล่งข้อมูล Analysis Services
Power BI อนุญาตสำหรับการแมปชื่อผู้ใช้สำหรับแหล่งข้อมูล Analysis Services คุณสามารถกำหนดค่ากฎการแมปชื่อผู้ใช้ที่ลงชื่อเข้าสู่ระบบด้วย Power BI เป็นชื่อที่ถูกส่งผ่านสำหรับ EffectiveUserName บนการเชื่อมต่อ Analysis Services ได้ คุณลักษณะการแมปชื่อผู้ใช้เป็นวิธีที่ยอดเยี่ยมในการแก้ไขปัญหาเมื่อชื่อผู้ใช้ของคุณใน AAD ไม่ตรงกับ UPN ใน Active Directory ภายในเครื่องของคุณ ตัวอย่างเช่น ถ้าที่อยู่อีเมลของคุณคือnancy@contoso.onmicrsoft.com คุณสามารถแมปเข้ากับnancy@contoso.com และค่านั้นจะถูกส่งผ่านไปยังเกตเวย์ คุณสามารถเรียนรู้เพิ่มเติมเกี่ยวกับวิธีการ[แมปชื่อผู้ใช้](service-gateway-enterprise-manage-ssas.md#map-user-names)ได้

## <a name="synchronize-an-on-premises-active-directory-with-azure-active-directory"></a>รวม Active Directory ภายในองค์กรเข้ากับ Azure Active Directory
คุณจะต้องการให้บัญชีผู้ใช้ Active Directory ของคุณภายในเครื่องตรงกับ Azure Active Directory ถ้าคุณกำลังใช้การเชื่อมต่อแบบสดของ Analysis Services เนื่องจาก UPN จะต้องตรงกันระหว่างบัญชีเหล่านั้น

บริการระบบคลาวด์ทราบเกี่ยวกับบัญชีผู้ใช้ภายใน Azure Active Directory เท่านั้น ไม่สำคัญว่าคุณได้เพิ่มบัญชีผู้ใช้หนึ่งใน Active Directory ภายในเครื่องของคุณ หากบัญชีนั้นไม่อยู่ใน AAD จะไม่สามารถนำไปใช้ได้ มีหลายวิธีที่คุณสามารถจับคู่บัญชีผู้ใช้ Active Directory ของคุณภายในเครื่องเข้ากับ Azure Active Directory

1. คุณสามารถเพิ่มบัญชีผู้ใช้ด้วยตนเองไปยัง Azure Active Directory
   
   คุณสามารถสร้างบัญชีผู้ใช้บนพอร์ทัล Azure หรือภาย ในศูนย์การจัดการ Microsoft 365 และชื่อบัญชีผู้ใช้ตรงกับ UPN ของบัญชี Active Directory ในเครื่อง
2. คุณสามารถใช้เครื่องมือ [Azure AD Connect](/azure/active-directory/hybrid/how-to-connect-sync-whatis)เพื่อรวมบัญชีผู้ใช้ภายในเครื่องเข้ากับผู้เช่า Azure Active Directory ของคุณได้
   
   เครื่องมือ Azure AD Connect มีตัวเลือกสำหรับการซิงโครไนซ์ไดเรกทอรี และการตั้งค่าการรับรองความถูกต้อง รวมถึงการซิงค์แฮชรหัสผ่าน, การรับรองความถูกต้องแบบพาสทรู และการติดต่อกับภายนอก ถ้าคุณไม่ได้เป็นผู้ดูแลระบบสำหรับผู้เช่าหรือผู้ดูแลโดเมนภายใน คุณจะต้องติดต่อผู้ดูแลระบบ IT ของคุณเพื่อกำหนดค่านี้

การใช้ Azure AD Connect ทำให้แน่ใจว่า UPN จะทำให้ AAD และ Active Directory ภายในเครื่องของคุณตรงกัน

> [!NOTE]
> การรวมบัญชีผู้ใช้ด้วยเครื่องมือ Azure AD Connect จะสร้างบัญชีผู้ใช้ใหม่ภายในผู้เช่า AAD ของคุณ
> 
> 

## <a name="now-this-is-where-the-gateway-comes-in"></a>ตอนนี้ นี่คือที่ที่เกตเวย์เข้ามา
เกตเวย์ทำหน้าที่เป็นตัวเชื่อมต่อระหว่างระบบคลาวด์และเซิร์ฟเวอร์ภายในองค์กรของคุณ การถ่ายโอนข้อมูลระหว่างระบบคลาวด์และเกตเวย์ได้รับการป้องกันผ่าน[Azure Service Bus](/azure/service-bus-messaging/service-bus-messaging-overview) Service Bus สร้างช่องทางที่ปลอดภัยระหว่างระบบคลาวด์และเซิร์ฟเวอร์ภายในองค์กรของคุณผ่านการเชื่อมต่อขาออกบนเกตเวย์  ไม่มีการเชื่อมต่อขาเข้าที่คุณต้องเปิดบนไฟร์วอลล์ภายในองค์กรของคุณ Power BI จัดการ Service Bus ให้คุณ ซึ่งไม่มีค่าใช้จ่ายเพิ่มเติมหรือต้องการขั้นตอนเพื่อกำหนดค่าใดๆ

ถ้าคุณมีแหล่งข้อมูล Analysis Services คุณจะต้องติดตั้งเกตเวย์บนคอมพิวเตอร์ที่เข้าร่วมฟอเรสต์/โดเมนเดียวกับเซิร์ฟเวอร์ Analysis Services ของคุณ

ยิ่งเกตเวย์อยู่ใกล้กับเซิร์ฟเวอร์มากเท่าไหร่ การเชื่อมต่อยิ่งเร็วขึ้นเท่านั้น ถ้าคุณสามารถรับเกตเวย์บนเซิร์ฟเวอร์เดียวกันกับแหล่งข้อมูล นั่นเป็นวิธีที่ี่ดีที่สุดในการหลีกเลี่ยงเวลาแฝงเครือข่ายระหว่างเกตเวย์และเซิร์ฟเวอร์

## <a name="what-to-do-next"></a>สิ่งที่ต้องทำต่อไปคืออะไร?
หลังจากที่คุณติดตั้งเกตเวย์แล้ว คุณจะต้องสร้างแหล่งข้อมูลสำหรับเกตเวย์นั้น คุณสามารถเพิ่มแหล่งข้อมูลภายในหน้าจอ**จัดการเกตเวย์** สำหรับข้อมูลเพิ่มเติม ดูบทความแหล่งจัดการข้อมูล

[จัดการแหล่งข้อมูลของคุณ - Analysis Services](service-gateway-enterprise-manage-ssas.md)  
[จัดการแหล่งข้อมูลของคุณ - SAP HANA](service-gateway-enterprise-manage-sap.md)  
[จัดการแหล่งข้อมูลของคุณ - SQL Server](service-gateway-enterprise-manage-sql.md)  
[จัดการแหล่งข้อมูลของคุณ - Oracle](service-gateway-onprem-manage-oracle.md)  
[จัดการแหล่งข้อมูลของคุณ - นำเข้า/รีเฟรชตามตารางเวลา](service-gateway-enterprise-manage-scheduled-refresh.md)  

## <a name="where-things-can-go-wrong"></a>นี่คือจุดที่สามารถเกิดข้อผิดพลาดได้
ในบางครั้งการติดตั้งเกตเวย์ล้มเหลว หรืออาจดูเหมือนว่าเกตเวย์ติดตั้งได้ดี แต่บริการยังคงไม่สามารถทำงานกับเกตเวย์ได้ ในหลายกรณีจะมีสาเหตุมาจากเรื่องง่าย ๆ เช่น รหัสผ่านสำหรับข้อมูลประจำตัวที่เกตเวย์ใช้เพื่อลงชื่อเข้าใช้ลงชื่อเข้าในแหล่งข้อมูล

ในกรณีอื่น ๆ อาจเป็นปัญหาจากประเภทของที่อยู่อีเมลของผู้ใช้ที่ลงชื่อเข้าใช้ หรือความไม่สามารถของ Analysis Services ในการแก้ไขชื่อผู้ใช้ที่สามารถใช้ได้ ถ้าคุณมีหลายโดเมนที่คุณเชื่อถือ และเกตเวย์ของคุณกำลังอยู่ในหนึ่งโดเมนและ Analysis Services อยู่ในอีกหนึ่งโดเมน บางครั้งกรณีเช่นนี้ก่อปัญหาบางประการได้

แทนที่จะลงรายละเอียดการแก้ไขปัญหาเกตเวย์ไว้ที่นี่ เราได้รวมชุดขั้นตอนการแก้ไขปัญหาไว้ในบทความอื่น [การแก้ไขปัญหาเกตเวย์ข้อมูลในองค์กร](service-gateway-onprem-tshoot.md) เราหวังว่าคุณจะไม่มีปัญหาใด แต่หากคุณมีปัญหา การทำความเข้าใจวิธีการที่ทั้งหมดนี้ทำงานและบทความแก้ไขปัญหาควรช่วยคุณได้

<!-- Account and Port information -->
[!INCLUDE [gateway-onprem-accounts-ports-more](./includes/gateway-onprem-accounts-ports-more.md)]

## <a name="next-steps"></a>ขั้นตอนถัดไป

[การแก้ไขปัญหาเกตเวย์ข้อมูลในองค์กร](service-gateway-onprem-tshoot.md)  
[Azure Service Bus](/azure/service-bus-messaging/service-bus-messaging-overview/)  
[Azure AD Connect](/azure/active-directory/hybrid/how-to-connect-sync-whatis/)  

มีคำถามเพิ่มเติมหรือไม่? [ลองไปที่ชุมชน Power BI](http://community.powerbi.com/)

