---
title: ประสิทธิภาพการทำงานเกตเวย์ตรวจสอบ (ตัวอย่างสาธารณะ)
description: บทความนี้มีข้อมูลเกี่ยวกับการตรวจสอบประสิทธิภาพของกิจกรรมเกตเวย์ข้อมูลภายในองค์กร
author: mgblythe
ms.author: mblythe
manager: kfile
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-gateways
ms.topic: conceptual
ms.date: 05/08/2019
LocalizationGroup: Gateways
ms.openlocfilehash: 8c5f4170383f31ea465ebb7035aebfb53f551982
ms.sourcegitcommit: af2b2238fe77eaa1b2392a19a143a0250b8665cf
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 05/11/2019
ms.locfileid: "65535378"
---
# <a name="gateway-performance-monitoring-public-preview"></a>ประสิทธิภาพการทำงานเกตเวย์ตรวจสอบ (ตัวอย่างสาธารณะ)

การตรวจสอบประสิทธิภาพการทำงาน ซึ่งโดยทั่วไปมี depended ผู้ดูแลระบบเกตเวย์บนตัวนับประสิทธิภาพการทำงานผ่านเครื่องมือ Windows Performance Monitor การตรวจสอบด้วยตนเอง ในตอนนี้เรามอบบันทึกแบบสอบถามเพิ่มเติมและ[ไฟล์เทมเพลเกตเวย์ประสิทธิภาพการทำงาน PBI](http://download.microsoft.com/download/D/A/1/DA1FDDB8-6DA8-4F50-B4D0-18019591E182/GatewayPerformanceMonitoring.pbit)เพื่อแสดงผลลัพธ์ คุณลักษณะนี้มีข้อมูลเชิงลึกในการใช้เกตเวย์ และช่วยให้คุณสามารถแก้ไขคิวรีดำเนินการที่ช้า

> [!NOTE]
> คุณลักษณะนี้จะพร้อมใช้งาน สำหรับเกตเวย์ข้อมูลภายในองค์กรในโหมดมาตรฐานเท่านั้น และไม่ใช่ สำหรับโหมดส่วนบุคคล

## <a name="enable-performance-logging"></a>เปิดใช้งานการบันทึกประสิทธิภาพการทำงาน

เมื่อต้องการเปิดใช้งานคุณลักษณะนี้ ทำการเปลี่ยนแปลงต่อไปนี้ไป*Microsoft.PowerBI.DataMovement.Pipeline.GatewayCore.dll.config*ไฟล์ในการ " \Program Files\On-เกตเวย์ข้อมูลใน" โฟลเดอร์:

1. อัปเด**QueryExecutionReportOn**เพื่อ_จริง_เพื่อเปิดใช้งานบันทึกเพิ่มเติมสำหรับคิวรีที่ดำเนินการโดยใช้เกตเวย์ เปิดใช้งานตัวเลือกนี้สร้างทั้งรายงานการดำเนินการแบบสอบถามและไฟล์รายงานรวมการดำเนินการแบบสอบถาม

   ``` xml
   <setting name="QueryExecutionReportOn" serializeAs="String">
     <value>True</value>
   </setting>
   ```

1. อัปเด**SystemCounterReportOn**เพื่อ_จริง_เพื่อเปิดใช้งานบันทึกเพิ่มเติมสำหรับตัวนับระบบ CPU และหน่วยความจำ เปิดใช้งานตัวเลือกนี้สร้างไฟล์ระบบนับรวมรายงาน

   ```xml
   <setting name="SystemCounterReportOn" serializeAs="String">
     <value>True</value>
   </setting>
   ```

1. มีค่าอื่น ๆ ในแฟ้มการกำหนดค่าที่คุณสามารถปรับปรุงตามความจำเป็น

    - **ReportFilePath**: กำหนดเส้นทางที่เก็บไฟล์บันทึกสาม ตามค่าเริ่มต้น เส้นทางนี้เป็น "gateway\Report ข้อมูล \Users\PBIEgwService\AppData\Local\Microsoft\On-premises" หรือ "Windows\ServiceProfiles\PBIEgwService\AppData\Local\Microsoft\On องค์กรข้อมูล gateway\Report" ขึ้นอยู่กับรุ่นของระบบปฏิบัติการ ถ้าคุณใช้บัญชีบริการเกตเวย์อื่นที่ไม่ใช่_PBIEgwService_แทนส่วนนี้ของเส้นทาง ด้วยชื่อบัญชีบริการ
    - **ReportFileCount**: กำหนดจำนวนของไฟล์บันทึกของแต่ละชนิดการเก็บรักษาไว้ ค่าเริ่มต้นคือ 10
    - **ReportFileSizeInBytes**: กำหนดขนาดของไฟล์ที่จะรักษา ค่าเริ่มต้นคือ 104857600
    - **QuerExecutionAggregationTimeInMinutes**: กำหนดจำนวนนาทีที่รวมข้อมูลการดำเนินการแบบสอบถาม ค่าเริ่มต้นคือ 5
    - **SystemCounterAggregationTimeInMinutes**: กำหนดจำนวนนาทีที่รวมตัวนับระบบหรือไม่ ค่าเริ่มต้นคือ 5

1. หลังจากที่คุณทำการเปลี่ยนแปลงแฟ้ม รีสตาร์ทเกตเวย์สำหรับค่าการกำหนดค่าเหล่านี้มีผลบังคับใช้ ตอนนี้คุณจะเริ่มดูไฟล์รายงานที่ถูกสร้างขึ้นในตำแหน่งที่ตั้งที่คุณระบุสำหรับ**ReportFilePath**

    > [!NOTE]
    > อาจใช้เวลาถึง 10 นาทีรวม ถึงระยะเวลาที่กำหนดสำหรับ**QuerExecutionAggregationTimeInMinutes**ในแฟ้มจนกว่าไฟล์เริ่มต้นแสดงขึ้นในโฟลเดอร์

## <a name="understand-performance-logs"></a>ทำความเข้าใจประสิทธิภาพบันทึก

เมื่อคุณเปิดคุณลักษณะนี้ เราสร้างไฟล์บันทึกใหม่สาม:

- รายงานการดำเนินการแบบสอบถาม
- รายงานรวมการดำเนินการแบบสอบถาม
- รายงานรวมนับระบบ

รายงานการดำเนินการแบบสอบถามประกอบด้วยข้อมูลการดำเนินการแบบสอบถามโดยละเอียด เราเก็บแอตทริบิวต์ต่อไปนี้:

|แอตทริบิวต์ |คำอธิบาย |
| ---- | ---- |
|**GatewayObjectId** |ตัวระบุที่ไม่ซ้ำกันสำหรับเกตเวย์ |
|**RequestId** |ตัวระบุที่ไม่ซ้ำกันสำหรับคำขอเกตเวย์ อาจเป็นเหมือนกันสำหรับหลายคิวรี |
|**แหล่งข้อมูล** |ประกอบด้วยชนิดแหล่งข้อมูลและแหล่งข้อมูล |
|**QueryTrackingId** |ตัวระบุที่ไม่ซ้ำกันสำหรับแบบสอบถาม |  
|**QueryExecutionEndTimeUTC** |เวลาที่เสร็จสิ้นการดำเนินการแบบสอบถาม |
|**QueryExecutionDuration**(ms) |ระยะเวลาสำหรับการดำเนินการแบบสอบถาม |
|**QueryType** |ชนิดของคิวรี - ตัวอย่าง แบบสอบถามที่ส่งผ่านอาจรี เฟรช/DirectQuery Power BI หรือแบบสอบถามจาก PowerApps และ Microsoft Flow |
|**DataProcessingEndTimeUTC** |เวลาเมื่อประมวลผลข้อมูลกิจกรรมเช่นไม่สามารถเก็บ เรียกข้อมูล บีบอัด ประมวลผลข้อมูล และอื่น ๆ เสร็จสมบูรณ์ |
|**DataProcessingDuration**(ms) |ระยะเวลาสำหรับกิจกรรมการประมวลผลข้อมูลเช่นไม่สามารถเก็บ เรียกข้อมูล บีบอัด ประมวลผลข้อมูล และอื่น ๆ |
|**ความสำเร็จ** |ระบุว่า แบบสอบถามสำเร็จ หรือล้มเหลว |
|**ErrorMessage** |ถ้าคิวรีล้มเหลว บ่งชี้ข้อผิดพลาด |
| | |

รายงานรวมการดำเนินการแบบสอบถามประกอบด้วยคิวรีข้อมูลรวมช่วงเวลาโดย**GatewayObjectId**, **DataSource**, **สำเร็จ**และ**QueryType** ค่าเริ่มต้นคือ 5 นาที แต่คุณสามารถปรับตามที่อธิบายไว้ด้านล่าง เราเก็บแอตทริบิวต์ต่อไปนี้:

|แอตทริบิวต์ |คำอธิบาย |
| ---- | ---- |
|**GatewayObjectId** |ตัวระบุที่ไม่ซ้ำกันสำหรับเกตเวย์ |
|**AggregationStartTimeUTC** |เริ่มต้นของกรอบเวลาที่ถูกรวมแอตทริบิวต์แบบสอบถาม |
|**AggregationEndTimeUTC** |จุดสิ้นสุดของหน้าต่างเวลาสำหรับแบบสอบถามที่ถูกรวมแอตทริบิวต์ |
|**แหล่งข้อมูล** |ประกอบด้วยชนิดแหล่งข้อมูลและแหล่งข้อมูล |
|**ความสำเร็จ** |ระบุว่า แบบสอบถามสำเร็จ หรือล้มเหลว |
|**AverageQueryExecutionDuration**(ms) |เวลาการดำเนินการแบบสอบถามโดยเฉลี่ยสำหรับกรอบเวลารวม |
|**MaxQueryExecutionDuration**(ms) |เวลาการดำเนินการคิวรีสูงสุดสำหรับกรอบเวลารวม |
|**MinQueryExecutionDuration**(ms) |เวลาการดำเนินการแบบสอบถามขั้นต่ำสำหรับกรอบเวลารวม |
|**QueryType** |ชนิดของคิวรี - ตัวอย่าง แบบสอบถามที่ส่งผ่านอาจรี เฟรช/DirectQuery Power BI หรือแบบสอบถามจาก PowerApps และ Microsoft Flow |
|**AverageDataProcessingDuration**(ms) |เวลาเฉลี่ยสำหรับกิจกรรมการประมวลผลข้อมูลเช่นไม่สามารถเก็บ เรียกข้อมูล บีบอัด กำลังประมวล ผลข้อมูล และอื่น ๆ สำหรับกรอบเวลารวม |
|**MaxDataProcessingDuration**(ms) |เวลาสูงสุดสำหรับกิจกรรมการประมวลผลข้อมูลเช่นไม่สามารถเก็บ เรียกข้อมูล บีบอัด ประมวลผลข้อมูล และอื่น ๆ สำหรับกรอบเวลารวม |
|**MinDataProcessingDuration**(ms) |เวลาต่ำสุดสำหรับกิจกรรมการประมวลผลข้อมูลเช่นไม่สามารถเก็บ เรียกข้อมูล บีบอัด ประมวลผลข้อมูล และอื่น ๆ สำหรับกรอบเวลารวม |
|**Count** |จำนวนคิวรี |
| | |

รายงานระบบนับรวมประกอบด้วยค่าตัวนับระบบรวมช่วงเวลา ค่าเริ่มต้นคือ 5 นาที แต่คุณสามารถปรับตามที่อธิบายไว้ด้านล่าง เราเก็บแอตทริบิวต์ต่อไปนี้:

|แอตทริบิวต์ |คำอธิบาย |
| ---- | ---- |
|**GatewayObjectId** |ตัวระบุที่ไม่ซ้ำกันสำหรับเกตเวย์ |
|**AggregationStartTimeUTC** |เริ่มต้นของกรอบเวลาที่มีการรวมตัวนับระบบ |
|**AggregationEndTimeUTC** |จุดสิ้นสุดของหน้าต่างเวลาสำหรับระบบที่นับได้ถูกรวม |
|**CounterName** |ระบบตัวนับ รวมถึงหน่วยความจำและการใช้ CPU โดยเกตเวย์ mashup และโดยรวม โดยเครื่องเกตเวย์ |
|**สูงสุด** |ค่าสูงสุดสำหรับตัวนับระบบสำหรับกรอบเวลารวม |
|**ค่าต่ำสุด** |ค่าต่ำสุดสำหรับตัวนับระบบสำหรับกรอบเวลารวม |
|**ค่าเฉลี่ย** |ค่าเฉลี่ยสำหรับตัวนับระบบสำหรับกรอบเวลารวม |
| | |

## <a name="visualize-gateway-performance"></a>แสดงประสิทธิภาพของเกตเวย์

ตอนนี้ คุณสามารถแสดงข้อมูลที่อยู่ในแฟ้มบันทึก

1. ดาวน์โหลดการ[เทมเพลเกตเวย์ประสิทธิภาพการทำงาน PBI](http://download.microsoft.com/download/D/A/1/DA1FDDB8-6DA8-4F50-B4D0-18019591E182/GatewayPerformanceMonitoring.pbit)และเปิดใช้ Power BI desktop

1. ในกล่องโต้ตอบที่เปิด ตรวจสอบว่า เส้นทางโฟลเดอร์จะตรงกับค่าใน**ReportFilePath**

    ![เมนูแบบผุดขึ้นสำหรับเส้นทางโฟลเดอร์](media/service-gateway-performance-monitoring/gateway-folder-path-pop-up.png)

1. เลือก**การโหลด**และไฟล์เทมเพลเริ่มการโหลดข้อมูลจากไฟล์บันทึกของคุณ ภาพทั้งหมดควรนั้นถูกนำเข้าโดยใช้ข้อมูลในรายงาน

1. เลือกบันทึกไฟล์นี้เป็นแบบ PBIX และเผยแพร่ไปยังบริการของคุณสำหรับรีเฟรชโดยอัตโนมัติ

นอกจากนี้ คุณสามารถกำหนดไฟล์เทมเพลตนี้เพื่อตอบสนองความต้องการของคุณ สำหรับข้อมูลเพิ่มเติมเกี่ยวกับเทมเพลต Power BI ดู[โพสต์ในบล็อก Microsoft Power BI](https://powerbi.microsoft.com/en-us/blog/deep-dive-into-query-parameters-and-power-bi-templates/)