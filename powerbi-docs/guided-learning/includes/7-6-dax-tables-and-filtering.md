ข้อแตกต่างหลักอย่างหนึ่งระหว่างภาษาสูตรของ **DAX** และ Excel คือ DAX อนุญาตให้คุณผ่าน*ทั้งตาราง*ได้ระหว่างนิพจน์ แทนที่จะถูกจำกัดอยู่ที่ค่าเดี่ยว ผลกระทบใหญ่อย่างหนึ่งคือ DAX อนุญาตให้คุณกรองตารางในนิพจน์ได้ จากนั้น DAX จะทำงานกับชุดค่าที่ได้รับการกรองแล้ว

![](media/7-6-dax-tables-and-filtering/dax-tables-filtering_1.png)

ด้วย DAX คุณสามารถสร้างตารางที่ได้รับการคำนวณใหม่ทั้งตาราง จากนั้นทำกับตารางนั้นเหมือนเป็นตารางอื่นๆ ได้ รวมถึงการสร้างความสัมพันธ์ระหว่างตารางนั้นกับตารางอื่นๆ ในรูปแบบข้อมูลของคุณ

## <a name="dax-table-functions"></a>ฟังก์ชันตารางของ DAX
DAX มีชุดฟังก์ชัน**ตาราง**จำนวนมาก รวมถึงฟังก์ชันต่อไปนี้:

* FILTER
* ALL
* VALUES
* DISTINCT
* RELATEDTABLE

ฟังก์ชันเหล่านี้จะส่งกลับทั้งตารางแทนที่จะเป็นค่าใดค่าหนึ่ง โดยทั่วไป คุณจะใช้ผลลัพธ์ของฟังก์ชัน**ตาราง**ในการวิเคราะห์เพิ่มเติมซึ่งเป็นส่วนหนึ่งของนิพจน์ที่ใหญ่กว่า แทนที่จะใช้ตารางที่ถูกส่งกลับมาเป็นค่าสุดท้าย โปรดทราบว่าเมื่อคุณใช้ฟังก์ชันตาราง ผลลัพธ์จะสืบต่อความสัมพันธ์ของคอลัมน์มาด้วย

คุณสามารถผสมฟังก์ชันตารางในนิพจน์ของคุณได้ ตราบใดที่แต่ละฟังก์ชันใช้หนึ่งตารางและส่งกลับหนึ่งตาราง ตัวอย่างเช่น ลองพิจารณานิพจน์ DAX ต่อไปนี้:

    FILTER (ALL (Table), Condition)

นิพจน์ดังกล่าวจะใส่ตัวกรองลงในทั้ง*ตาราง* โดยไม่สนใจเนื้อหาของตัวกรองใดๆ ในปัจจุบัน

ฟังก์ชัน DISTINCT จะส่งกลับค่าเฉพาะของคอลัมน์ที่มองเห็นได้ในบริบทในปัจจุบันเช่นกัน ดังนั้นในการใช้นิพจน์ DAX ดังกล่าว การใช้ **ALL** ในนิพจน์นั้นจะละเว้นตัวกรอง ขณะที่การแทนที่ **ALL** ด้วย **DISTINCT** จะดูตัวกรองเหล่านั้น

## <a name="counting-values-with-dax"></a>การนับค่าด้วย DAX
คำถามโดยทั่วไปคำถามหนึ่งที่ผู้สร้างรายงาน Power BI ต้องการตอบมีใจความดังนี้:

* ฉันมีค่าจำนวนเท่าใดในคอลัมน์นี้

นั่นอาจเป็นคำถามที่ตอบไม่ยากหากมีตารางเปิดอยู่ตรงหน้าคุณ แต่ DAX จะเข้าถึงคำตอบในวิธีที่ต่างออกไป โดยเฉพาะในกรณีที่มีความสัมพันธ์ระหว่างตาราง

ตัวอย่างเช่น Power BI และ DAX จะรวมค่าที่ไม่ได้ถูกทำดัชนีโดยอ้างอิงกันอย่างถูกต้อง ถ้าความสัมพันธ์ที่เข้ามาถูกตัดขาด DAX จะเพิ่มแถวใหม่ลงในตารางที่เกี่ยวข้องที่มีช่องว่างในทุกเขตข้อมูล แล้วเชื่อมโยงแถวใหม่นั้นกับแถวที่ไม่ถูกทำดัชนีเพื่อรับรองความถูกต้องของการอ้างอิง ถ้าฟังก์ชันของคุณมีแถวเปล่า เช่นในกรณีที่เกิดขึ้นบ่อยเมื่อใช้ **ALL** แถวเปล่าเหล่านั้นจะถูกรวมในค่าที่ส่งกลับของคอลัมน์นั้น

คุณยังสามารถสร้างตารางที่ได้รับการคำนวณใหม่ทั้งตารางโดยใช้ฟังก์ชัน DAX ได้เช่นกัน ตารางที่ได้รับการคำนวณที่สร้างโดยใช้ DAX จำเป็นต้องมีฟังก์ชัน **NAME** และ **TABLE** ตารางที่ได้รับการคำนวณสามารถนำไปใช้ได้เหมือนกับตารางอื่นๆ รวมถึงการสร้างความสัมพันธ์ด้วยเช่นกัน

> เนื้อหาวิดีโอโดย [Alberto Ferrari, SQBI](http://www.sqlbi.com/learning-dax)
> 
> 

