---
title: การอ้างอิงคิวรี Power Query
description: คำแนะนำการอ้างอิงคิวรี Power Query
author: peter-myers
ms.reviewer: asaxton
ms.service: powerbi
ms.subservice: powerbi-desktop
ms.topic: conceptual
ms.date: 11/30/2019
ms.author: v-pemyer
ms.openlocfilehash: a0127a6ffa0d698a94e368532c44d0f83c362b42
ms.sourcegitcommit: 8e3d53cf971853c32eff4531d2d3cdb725a199af
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 02/04/2020
ms.locfileid: "75002408"
---
# <a name="referencing-power-query-queries"></a>การอ้างอิงคิวรี Power Query

บทความนี้มุ่งเป้าหมายไปที่เรื่อง ตัวสร้างแบบจำลองข้อมูลนำเข้าที่ทำงานกับ Power BI Desktop บทความนี้จะให้คำแนะนำเกี่ยวกับการนิยาม Power Query ที่ต้องอ้างอิงคิวรีอื่น

การขยายความให้ชัดเจน: _เมื่อคิวรีแรกมีการอ้างอิงถึงคิวรีที่สองนั่นหมายความว่าคิวรีที่สองจะต้องเข้ารวมกับคิวรีแรกที่กำลังทำงานอยู่_

พิจารณาหลายคิวรี: **คิวรีที่ 1** แหล่งข้อมูลจากบริการเว็บและไม่สามารถโหลดได้ **คิวรีที่ 2**, **คิวรีที่ 3** และ **คิวรีที่ 4** ทั้งหมดอ้างอิงจาก**คิวรีที่ 1** และผลลัพธ์ที่โหลดไปยังรูปแบบข้อมูล

![มุมมองการอ้างอิงคิวรีจะแสดงผลคิวรีตามที่อธิบายไว้ในพารากราฟก่อนหน้า](media/power-query-referenced-queries/query-dependencies-web-service.png)

เมื่อรีเฟรชรูปแบบข้อมูลแล้ว ระบบมักจะสันนิษฐานว่า Power Query ได้ข้อมูลมาจากผลลัพธ์ของ **คิวรี 1** และนั่นคือการนำคิวรีที่อ้างอิงแล้วกลับมาใช้งานใหม่อีกครั้ง วิธีคิดแบบนี้ไม่ถูกต้อง อันที่จริงแล้ว Power Query ให้ **คิวรี 2**, **คิวรี 3** และ **คิวรี 4** ดำเนินการแตกต่างกัน

คุณสามารถพูดได้ว่า **คิวรี 2** ฝังตัวอยู่กับ **คิวรี 1** ก็ได้ ยังมีกรณีสำหรับ **คิวรี 3** และ **คิวรี 4** ด้วยนะ ประโยคต่อไปนี้จะแสดงให้เห็นภาพที่ชัดเจนขึ้นว่าสรุปแล้วคิวรีมีรูปแบบดำเนินการอย่างไร

![การดัดแปลงมุมมองการอ้างอิงคิวรีแสดงผลเป็น คิวรีที่ 2 คิวรีที่ 3 และ คิวรีที่ 4 ซึ่งทั้งสามคิวรีฝังตัวเข้ากับคิวรีที่ 1](media/power-query-referenced-queries/query-dependencies-web-service-concept.png)

**คิวรที่ 1** จะมีการดำเนินการทั้งหมดสามครั้ง การดำเนินการหลายๆ ครั้งจะส่งผลให้การรีเฟรชข้อมูลช้าลงและถ้าเลวร้ายกว่านั้นการดำเนินการนี้จะส่งผลกระทบกับแหล่งข้อมูล

การใช้ฟังก์ชัน [Table.Buffer](/powerquery-m/table-buffer) ใน **คิวรีที่1** ไม่ได้ช่วยกำจัดการดึงข้อมูลเพิ่มเติมเข้ามา ฟังก์ชันนี้เป็นตารางที่อยู่ในส่วนของการเก็บข้อมูล และตารางบัฟเฟอร์สามารถใช้ในการดำเนินการคิวรีเดียวเท่านั้น อย่างเช่นในตัวอย่างนี้ **คิวรีที่ 1**จะบัฟเฟอร์เมื่อ **คิวรีที่ 2** มีการดำเนินการแล้วเท่านั้นการบัฟเฟอร์ข้อมูลไม่สามารถทำได้เมื่อ**คิวรีที่ 3** และ **คิวรีที่ 4** ยังคงทำงานอยู่ คิวรีเหล่านั้นจะบัฟเฟอร์ข้อมูลซ้ำมากกว่าสองครั้ง (ผลลัพธ์ที่ได้อาจส่งผลร้ายต่อประสิทธิภาพการทำงานเพราะตารางจะถูกบัฟเฟอร์ตามคิวรีที่อ้างอิง)

> [!NOTE]
> โครงสร้างของ Power Query เชิงลึกเป็นอะไรที่ซับซ้อนซึ่งบทความนี้ไม่ได้มีหน้าที่อธิบายเรื่องนั้น Power Query สามารถแคชดึงข้อมูลมาจากแหล่งข้อมูลได้ อย่างไรก็ตามเมื่อคิวรีเริ่มทำงานแล้ว คิวรีอาจดึงข้อมูลมาจากแหล่งข้อมูลมากกว่าหนึ่งครั้ง

## <a name="recommendations"></a>คำแนะนำ

โดยทั่วไปแล้วเราแนะนำให้คุณอ้างอิงคิวรีเพื่อเลี่ยงการทำคิวรีซ้ำ อย่างไรก็ตามอย่างที่ได้อธิบายไปในบทความนี้แล้ว การดำเนินการเช่นนั้นอาจทำให้การรีเฟรชข้อมูลช้าลงและทำให้แหล่งข้อมูลทำงานหนักเกินไป

เราแนะนำให้คุณสร้าง [กระแสข้อมูล](../service-dataflows-overview.md) แทน การใช้กระแสข้อมูลสามารถช่วยปรับปรุงเวลาที่รีเฟรชข้อมูลและลดผลกระทบกับแหล่งข้อมูลของคุณได้

คุณสามารถออกแบบกระแสข้อมูลเพื่อย่อส่วนแหล่งข้อมูลและแปลงข้อมูล เมื่อกระแสข้อมูลยังคงอยู่ที่ที่เก็บข้อมูลในบริการ Power BI การดึงข้อมูลจึงสามารถทำได้อย่างรวดเร็ว ดังนั้น แม้ว่าจะมีการรอขอคิวรีอ้างอิงข้อมูลในกระแสข้อมูลหลายครั้ง เวลาในการรีเฟรชข้อมูลสามารถทำให้เร็วขึ้นได้

ยกตัวอย่างเช่นถ้า  **คิวรี 1** ถูกออกแบบให้เป็นเอ็นทิตี้กระแสข้อมูลใหม่ใน **คิวรี 2**, **คิวรี 3**, และ **คิวรี 4** ก็จะยังสามารถใช้เป็นแหล่งข้อมูลได้ ด้วยการออกแบบนี้ แหล่งข้อมูลเอ็นทิตี้จาก **คิวรี 1** จะถูกประเมินภายในครั้งเดียว

## <a name="next-steps"></a>ขั้นตอนถัดไป

สำหรับข้อมูลเพิ่มเติมที่เกี่ยวข้องกับบทความนี้ โปรดดูทรัพยากรต่อไปนี้:

- [การเตรียมข้อมูลด้วยตนเองใน Power BI](../service-dataflows-overview.md)
- [การสร้างและการใช้กระแสข้อมูลใน Power BI](../service-dataflows-create-use.md)
- วิดีโอ Guy in a cube: [Inside Power Query อ้างอิงคิวรีสำหรับ Power BI and Excel](https://www.youtube.com/watch?v=3uKNNZqBIkg)
- มีคำถามหรือไม่ [ลองถามชุมชน Power BI](https://community.powerbi.com/)
