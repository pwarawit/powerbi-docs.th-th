---
title: หน่วยความจำความจุ Power BI Premium ที่ใช้งานและการปรับให้เหมาะสม
description: ทำความเข้าใจการจัดการหน่วยความจำความจุ Power BI Premium และการปรับให้เหมาะสม
ms.date: 02/05/2019
ms.topic: conceptual
ms.service: powerbi
ms.subservice: powerbi-admin
ms.author: owend
ms.reviewer: owend
author: minewiskan
manager: kfile
ms.openlocfilehash: e31f67d978471f4dcc6472860fc5f8315212e563
ms.sourcegitcommit: 54d44deb6e03e518ad6378656c769b06f2a0b6dc
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 02/07/2019
ms.locfileid: "55794871"
---
# <a name="microsoft-power-bi-premium-capacity-resource-management-and-optimization"></a>การจัดการและการปรับทรัพยากรของความจุ Microsoft Power BI Premium ให้เหมาะสม

บทความนี้อธิบายว่า Power BI Premium จัดการทรัพยากรอย่างไร บทความนี้ยังมีตัวอย่างและคำแนะนำในการแก้ไขปัญหาอีกด้วย สำหรับภาพรวม โปรดดู [Power BI Premium คืออะไร?](service-premium.md)

## <a name="premium-capacity-memory-management"></a>การจัดการหน่วยความจำความจุ Premium

 การจัดการหน่วยความจำความจุ Premium แยกตาม:

* ชุดข้อมูลที่โหลดลงในหน่วยความจำ
* การรีเฟรชชุดข้อมูล (ทั้งแบบรีเฟรชตามกำหนดการและตามความต้องการ)
* ปริมาณงานที่ความจุรองรับได้
* คิวรีรายงาน

เมื่อมีการออกคำขอเทียบกับชุดข้อมูลที่เผยแพร่ในความจุของคุณ ชุดข้อมูลนั้นจะโหลดลงในหน่วยความจำจากที่เก็บข้อมูลแบบถาวร (ซึ่งเรียกอีกชื่อว่า การโหลดรูปภาพ) การรักษาชุดข้อมูลที่โหลดในหน่วยความจำช่วยในการตอบสนองที่รวดเร็วต่อคิวรีในอนาคตให้กับชุดข้อมูลนี้ นอกเหนือจากหน่วยความจำที่จำเป็นสำหรับการเก็บชุดข้อมูลที่โหลดในหน่วยความจำดังกล่าว คิวรีรายงานและการรีเฟรชุดข้อมูลจะใช้หน่วยความจำเพิ่มเติม

### <a name="dataset-memory-estimation"></a>การประเมินหน่วยความจำของชุดข้อมูล

เมื่อพยายามที่จะโหลดชุดข้อมูลลงในหน่วยความจำ Power BI จะประเมินจำนวนหน่วยความจำที่ชุดข้อมูลจำเป็นต้องใช้ดำเนินการคำสั่งที่ร้องขอให้เสร็จสมบูรณ์ ชุดข้อมูลในหน่วยความจำมักจะมีขนาดใหญ่กว่าที่เป็นจริงเมื่อบันทึกลงในดิสก์ ในระหว่างการรีเฟรชชุดข้อมูล Power BI ต้องใช้หน่วยความจำมากกว่าที่กำหนดอย่างน้อยสองเท่าเมื่อไม่ได้ใช้งานชุดข้อมูล

### <a name="overcommitting-capacity-eviction-and-reloading-of-datasets"></a>ความจุเกินกำลัง การลดข้อมูล และการโหลดของชุดข้อมูล

Power BI Premium ให้คุณได้ประโยชน์ของกา*รใช้ความจุเกินกำ*ลังของคุณ ตัวอย่างเช่น คุณสามารถเผยแพร่ข้อมูลได้มากกว่าค่าความจุของคุณ ถ้าชุดข้อมูลที่เผยแพร่ต้องการหน่วยความจำมากกว่าที่มีอยู่ในความจุ ชุดข้อมูลบางส่วนจะถูกเก็บไว้แยกต่างหากในที่เก็บแบบถาวร ที่เก็บแบบถาวรเป็นส่วนหนึ่งของพื้นที่จัดเก็บขนาด 100 TB ที่เชื่อมโยงกับแต่ละความจุของคุณ

ดังนั้น ชุดข้อมูลใดที่อยู่ในหน่วยความจำ และเกิดอะไรขึ้นกับชุดข้อมูลอื่น ๆ? ตามที่อธิบายไว้ก่อนหน้านี้ เมื่อมีการออกคำขอเทียบกับชุดข้อมูล คำขอจะถูกโหลดลงในหน่วยความจำ (การโหลดรูปภาพ) คำขออาจเป็นคิวรีรายงานหรือการดำเนินการรีเฟรช แต่เนื่องจากคุณสามารถใช้ความจุเกินกำลังได้ ความจุอาจเผชิญกับความกดดันที่มีต่อหน่วยความจำได้ เมื่อความจุเผชิญกับความกดดันที่มีต่อหน่วยความจำ โหนดจะ*ขับไล่*ชุดข้อมูลอย่างน้อยหนึ่งชุดออกจากหน่วยความจำ ชุดข้อมูลที่ไม่ได้ใช้งาน (ที่ไม่มีการสคิวรี่/ รีเฟรชกำลังดำเนินการอยู่) จะถูกขับออกก่อน จากนั้นคำสั่งการขับไล่จะขึ้นอยู่กับการวัด 'การใช้น้อยที่สุด' (LRU) ถ้ามีการออกคำสั่งใหม่ไปยังชุดข้อมูลที่ลดลง บริการจะพยายามโหลดชุดข้อมูลลงในหน่วยความจำอีกครั้ง และอาจลดชุดข้อมูลอื่น ๆ ลักษณะการทำงานนี้ช่วยให้สามารถใช้ประโยชน์ได้อย่างมีประสิทธิภาพมากขึ้น โดยอนุญาตให้ความจุให้บริการหลายชุดข้อมูลมากกว่าที่หน่วยความจำสามารถจัดเก็บไว้ได้

การโหลดชุดข้อมูลลงในหน่วยความจำเป็นการดำเนินการที่มีค่าใช้จ่ายค่อนข้างมาก ซึ่งอาจใช้เวลาตั้งแต่สองถึงสามวินาทีสำหรับชุดข้อมูลขนาดเล็ก ไปจนถึงสิบวินาทีหรือแม้กระทั่งหลายนาทีสำหรับชุดข้อมูลที่สำคัญ เช่น ชุดข้อมูล ~ 10 กิกะไบต์ โดยขึ้นอยู่กับขนาดของชุดข้อมูล ความจุ Premium พยายามลดจำนวนครั้งที่ความจุจะต้องโหลด โดยการเก็บชุดข้อมูลที่ใช้ล่าสุดน้อยที่สุดในหน่วยความจำให้นานที่สุดเท่าที่ทำได้ เมื่อจำเป็นต้องมีหน่วยความจำเพิ่มเติม ชุดข้อมูลบางชุดจะต้องถูกลดลง และระบบจะพยายามเลือกชุดข้อมูลที่มีผลกระทบต่อประสบการณ์การใช้งานของผู้ใช้น้อยที่สุด เมื่อจำเป็นต้องมีหน่วยความจำเพิ่มเติม ชุดข้อมูลบางชุดจะต้องถูกลดลง และระบบจะพยายามเลือกชุดข้อมูลที่มีผลกระทบต่อประสบการณ์การใช้งานของผู้ใช้น้อยที่สุด ตัวอย่างเช่น ระบบจะหลีกเลี่ยงการขับไล่ชุดข้อมูลที่ใช้งานภายในไม่กี่นาทีที่ผ่านมา มีแนวโน้มที่ชุดข้อมูลเหล่านี้จะถูกคิวรี่อีกครั้งเร็ว ๆ นี้

ขั้นตอนการลดข้อมูลเป็นการดำเนินการอย่างรวดเร็ว ถ้าชุดข้อมูลไม่ได้ใช้งานในเวลาที่มีการลดข้อมูล ผู้ใช้จะไม่รู้สึกถึงผลกระทบมากนักจากการลดข้อมูลนั้น อย่างไรก็ตาม ถ้ามีการใช้งานชุดข้อมูลในเวลาเดียวกันมากเกินไป และมีหน่วยความจำไม่เพียงพอที่จะจัดเก็บชุดข้อมูลทั้งหมด อาจมีการขับไล่ข้อมูลเกิดขึ้นได้จำนวนมาก ชุดข้อมูลที่ใช้งานมากเกินไปอาจนำไปสู่สถานการณ์ 'การลด' ชุดข้อมูลซึ่งชุดข้อมูลจะถูกขับไล่และโหลดซ้ำอยู่เรื่อย ๆ และผู้ใช้สามารถเห็นเวลาในการตอบกลับและประสิทธิภาพการทำงานที่ลดลงได้อย่างชัดเจน

### <a name="dataset-refresh-memory-requirement-competing-with-an-active-dataset-memory-requirement"></a>ความต้องการหน่วยความจำในการรีเฟรชข้อมูลที่แข่งขันกับความต้องการหน่วยความจำชุดข้อมูลที่เปิดใช้งาน

ผู้ใช้สามารถรีเฟรชชุดข้อมูลได้ตามกำหนดการหรือตามความต้องการ ตามที่ได้อธิบายไว้ก่อนหน้านี้ หน่วยความจำที่จำเป็นสำหรับการรีเฟรชแบบเต็มรูปแบบต้องมีอย่างน้อยสองเท่าของขนาดหน่วยความจำของชุดข้อมูลที่โหลดและไม่ได้ใช้งาน ก่อนรีเฟรชเริ่มต้น มีประเมินความต้องการรีเฟรชหน่วยความจำ ถ้าความต้องการหน่วยความจำทั้งหมดที่มีค่ามากกว่าหน่วยความจำที่พร้อมใช้งานในความจุ บางชุดข้อมูลจะถูกลดจำนวนลง อีกครั้ง การขับไล่จะขึ้นอยู่กับ LRU

หากหน่วยความจำที่จำเป็นไม่พร้อมใช้งานแม้ว่าจะมีการลดจำนวนข้อมูลลง การรีเฟรชจะลองใหม่อีกครั้ง บริการจะลองใหม่อีกครั้งจนกว่าประสบความสำเร็จ หรือการดำเนินการรีเฟรชใหม่เริ่มต้น

หากมีออกคิวรีแบบโต้ตอบให้กับชุดข้อมูลใด ๆ ในความจุ และมีหน่วยความจำที่พร้อมใช้งานไม่เพียงพอเนื่องจากมีการรีเฟรชอย่างต่อเนื่อง การร้องขอดังกล่าวจะล้มเหลวและผู้ใช้จำเป็นต้องดำเนินใหม่

### <a name="workloads"></a>ปริมาณงาน

ตามค่าเริ่มต้นแล้ว ความจุสำหรับ **Power BI Premium** และ **Power BI Embedded** จะรองรับเฉพาะปริมาณงานที่เชื่อมโยงกับการเรียกใช้คิวรี Power BI ในระบบคลาวด์เท่านั้น แต่ในตอนนี้เรามีส่วนสนับสนุนการแสดงตัวอย่างสำหรับปริมาณงานเพิ่มเติมสองตัว: **รายงานแบบแบ่งหน้า** และ **กระแสข้อมูล** เมื่อเปิดใช้งาน ปริมาณงานเหล่านี้จะสามารถส่งผลกระทบกับการใช้หน่วยความจำในความจุของคุณได้ สำหรับข้อมูลเพิ่มเติม โปรดดู [กำหนดค่าปริมาณงาน](service-admin-premium-manage.md#configure-workloads)

## <a name="cpu-resource-management-in-premium-capacity"></a>การจัดการทรัพยากร CPU ในหน่วยความจำพรีเมียม

มีสองผู้บริโภคหลักของทรัพยากร CPU:

* คิวรีจากรายงาน
* รีเฟรช (การประมวลผล)

### <a name="queries-from-reports"></a>คิวรีจากรายงาน

คิวรีรายงานใช้ทรัพยากร CPU ในความจุของคุณ รายงานที่มีคิวรี่ที่ไม่มีประสิทธิภาพหรือรายงานที่มีผู้ใช้หลายรายพร้อมกันจะใช้ทรัพยากร CPU เป็นจำนวนมาก ความจุที่มีอยู่ของคุณอาจไม่เพียงพอที่จะรับโหลด

### <a name="refresh-parallelization-policy"></a>รีเฟรชนโยบายแบบขนาน

หน่วยความจำไม่ใช่เพียงทรัพยากรเดียวที่สามารถจำกัดการรีเฟรชชุดข้อมูลได้ จำนวนของวีคอร์บนเซิร์ฟเวอร์อาจเป็นอีกปัจจัยหนึ่งด้วย เนื่องจากแต่ละการดำเนินการรีเฟรชจำเป็นต้องมีจำนวนวีคอร์ที่แน่นอน มีข้อจำกัดหนึ่งที่การรีเฟรชกี่ครั้งที่สามารถดำเนินการคู่ขนานกันได้ ขีดจำกัดต่อ SKU จะแสดงรายละเอียดในตารางต่อไปนี้ การรีเฟรชเพิ่มเติมที่เกินขีดจำกัดเหล่านี้จะถูกจัดคิว

 | SKU | วี-คอร์ Backend | การรีเฟรชแบบจำลองแบบคู่ขนาน |
 | --- | --- | --- |
 | A1  | 0.5  | 1  |
 | A2  | 1  | 2  |
 | A3  | 2  | 3  |
 | A4  | 4  | 6  |
 | A5  | 8  | 12  |
 | A6  | 16  | 24  |
 | EM1  | 0.5  | 1  |
 | EM2  | 1  | 2  |
 | EM3  | 2  | 3  |
 | P1  | 4  | 6  |
 | P2  | 8  | 12  |
 | P3  | 16  | 24  |
 | P4  | 32  | 48  |
 | P5  | 64  | 96  |

 > [!TIP]
> ถ้าการรีเฟรชของคุณล่าช้า ให้ตรวจสอบจำนวนการรีเฟรชคู่ขนานที่สนับสนุนโดยความจุของคุณ

## <a name="example-scenarios"></a>สถานการณ์ตัวอย่าง

ต่อไปนี้คือสถานการณ์ทั่วไปบางอย่างและการดำเนินการโดยบริการ:

**การรีเฟรชตามกำหนดเวลา 20 รายการที่ส่งมาทั้งหมดพร้อมกัน** Power BI พยายามเริ่มต้นรีเฟรช *x* ครั้งแรกในเวลาเดียวกัน ค่าสำหรับ *x* กำหนดโดยนโยบายการรีเฟรชแบบคู่ขนานสำหรับ SKU นั้น หาก Power BI ได้รับหน่วยความจำไม่เพียงพอจากการลดชุดข้อมูลที่ไม่ได้ใช้งาน (ชุดข้อมูลที่ไม่ใช้เมื่อเร็ว ๆ นี้) ไม่ใช่ทั้ง *x* การรีเฟรชจะเริ่มในเวลาเดียวกัน การรีเฟรชที่ไม่สามารถเริ่มต้นได้จะถูกจัดคิวจนกว่าจะสามารถเริ่มต้นได้

**สองการรีเฟรชที่ทำงานในเวลาเดียวกัน และมีหน่วยความจำเพียงพอให้หนึ่งการรีเฟรชทำงานเสร็จสิ้นได้เท่านั้น** การรีเฟรชที่สามารถทำเสร็จสิ้นได้เริ่มต้นขึ้น อีกหนึ่งการรีเฟรชจะลองใหม่ในภายหลัง

**ชุดข้อมูลจำนวนมากจะถูกคิวรี่ขณะที่ชุดข้อมูลต่างๆ กำลังถูกรีเฟรช** หากไม่มีหน่วยความจำเพียงพอ Power BI จะพยายามหยุดการรีเฟรชที่ใช้งานอยู่เพื่อให้ความสำคัญกับคิวรี่แบบโต้ตอบ ซึ่งขั้นตอนนี้จะลดประสิทธิภาพการทำงานรีเฟรช

**ชุดข้อมูลจำเป็นต้องใช้หน่วยความจำมากเกินไปเพื่อรีเฟรชบนขนาดความจุปัจจุบัน** การรีเฟรชนั้นจะล้มเหลว ไม่มีพยายามเพื่อให้ได้หน่วยความจำเพิ่มเติม โดยการลดชุดข้อมูล

**การรีเฟรชชุดข้อมูลเดี่ยวที่มีพื้นที่เก็บชั่วคราวขนาดใหญ่ในหน่วยความจำ** ถ้าที่เก็บชั่วคราวมีขนาดใหญ่กว่าจำนวนหน่วยความจำที่อาจได้จากการขับไล่ชุดข้อมูลที่ไม่ได้ใช้งาน การรีเฟรชจะลองอีกครั้งในภายหลังจนกว่าจะมีหน่วยความจำเพียงพอสำหรับการจัดการที่เก็บชั่วคราว

**มีการดำเนินการคิวรีสำหรับชุดข้อมูลที่ไม่สามารถมีหน่วยความจำเพียงพอโดยการลดชุดข้อมูลที่ไม่ได้ใช้งานทั้งหมดและการรีเฟรช** คิวรีเหล่านั้นล้มเหลว สำหรับความต้องการของปริมาณงานต่าง ๆ เหล่านี้ ควรมีการซื้อความจุที่มากขึ้น

## <a name="troubleshooting-and-testing"></a>การแก้ไขปัญหาและการทดสอบ

ถ้ารายงานช้าหรือไม่ตอบสนอง เริ่มต้นโดยการทดสอบสำหรับเพียงหนึ่งผู้ใช้ในรายงานของคุณ จากนั้น เริ่มเพิ่มการโหลดผู้ใช้พร้อมกันเพื่อค้นหาขีดจำกัด ในหลายกรณี การปรับคิวรี่ DAX ของคุณสามารถเปลี่ยนประสิทธิภาพของรายงานได้อย่างมาก การปรับแต่งคิวรี่ยังช่วยเพิ่มจำนวนผู้ใช้ที่พร้อมกันตามความจุของคุณด้วย [ตรวจสอบความจุของคุณ](service-admin-premium-monitor-capacity.md)เพื่อระบุปัญหาประสิทธิภาพการทำงานที่อาจเกิดขึ้น

ใช้ความจุ Power BI แบบฝังใน Azure เพื่อทดสอบ SKU อื่น ๆ และกำหนด SKU Premium ที่ดีที่สุดสำหรับปริมาณงานที่คาดหมายของคุณ Power BI Embedded A4 SKU มีค่าเท่ากับ P1, A5 = P2 และ A6 = P3 ใน Azure คุณสามารถสลับระหว่าง SKU ต่าง ๆ ได้อย่างง่ายดายโดยปรับมาตราส่วนขึ้นหรือลงในพอร์ทัล Azure เมื่อคุณพบ SKU ที่ทำงานได้ดีที่สุดสำหรับปริมาณงานของคุณ และเสร็จสิ้นการทดสอบแล้ว คุณสามารถลบ SKU นั้นได้

ในบางกรณี การเปิดไฟล์ Power BI Desktop (.pbix) ของแบบจำลองบนคอมพิวเตอร์ของคุณ และการตรวจสอบหน่วยความจำและปริมาณการใช้ CPU สามารถบอกอะไรได้มากมายเกี่ยวกับปัญหานี้ วิธีนี้ไม่ช่วยสำหรับแบบจำลองที่มีขนาดใหญ่มาก แต่สำหรับบางรุ่นที่มีขนาดเล็กลง ให้ลองเปิด รีเฟรช และร้องขอจำลองจากคอมพิวเตอร์ของคุณ ตรวจสอบขนาดของแบบจำลอง หน่วยความจำ และ CPU ที่ใช้เมื่อคุณเปิดแบบจำลองดังกล่าวขึ้น ลองรีเฟรชและร้องขอ ใช้ตัวจัดการงาน (Task manager) เพื่อตรวจสอบ CPU และปริมาณการใช้หน่วยความจำสำหรับไฟล์ภายในเครื่อง) บางครั้ง เมตริกเหล่านั้นบนคอมพิวเตอร์ของคุณสามารถบอกความจุพรีเมียมที่ต่ำกว่าได้ เช่น P1 / P2 อาจไม่สามารถใช้กับโซลูชันของคุณได้

## <a name="next-steps"></a>ขั้นตอนถัดไป

[จัดการความจุภายใน Power BI Premium และ Power BI Embedded](service-admin-premium-manage.md)