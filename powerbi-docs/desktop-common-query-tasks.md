---
title: งานคิวรีที่ใช้บ่อยใน Power BI Desktop
description: งานคิวรีที่ใช้บ่อยใน Power BI Desktop
author: davidiseminger
manager: kfile
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-desktop
ms.topic: conceptual
ms.date: 05/07/2019
ms.author: davidi
LocalizationGroup: Transform and shape data
ms.openlocfilehash: dc6aa42691c7caa2593b28e441f96985b1e3bcda
ms.sourcegitcommit: b11e908650379913d00673215e3eaf25d712b122
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 05/07/2019
ms.locfileid: "65239441"
---
# <a name="common-query-tasks-in-power-bi-desktop"></a>งานคิวรีที่ใช้บ่อยใน Power BI Desktop
เมื่อทำงานในหน้าต่าง **ตัวแก้ไขคิวรี** ของ Power BI Desktop มีงานอยู่ไม่กี่อย่างที่ใช้งานบ่อย ๆ เอกสารนี้ สาธิตงานที่ใช้บ่อยเหล่านั้น และมีลิงก์ให้สำหรับข้อมูลเพิ่มเติม 

งานคิวรีที่ใช้บ่อย ที่จะสาธิตให้ดู มีดังนี้:

* เชื่อมต่อกับข้อมูล
* จัดรูปร่าง และรวมข้อมูล
* จัดกลุ่มแถว
* Pivot คอลัมน์
* สร้างคอลัมน์แบบกำหนดเอง
* คิวรีสูตร

เราจะใช้การเชื่อมต่อข้อมูลบางตัวเพื่อทำงานเหล่านี้ให้สำเร็จ เรามีข้อมูลให้คุณดาวน์โหลดหรือการเชื่อมต่อ กรณีที่คุณต้องการลองขั้นตอนเหล่านี้ด้วยตนเอง

การเชื่อมต่อข้อมูลแรกคือ สมุดงาน Excel ซึ่งคุณสามารถดาวน์โหลดได้จาก[ลิงก์นี้](http://download.microsoft.com/download/5/7/0/5701F78F-C3C2-450C-BCCE-AAB60C31051D/PBI_Edu_ELSi_Enrollment_v2.xlsx) อีกแหล่งข้อมูลหนึ่ง เป็นทรัพยากรบนเว็บ (ซึ่งอยู่ในเนื้อหาความช่วยเหลือของ Power BI Desktop หน้าอื่นด้วย) ซึ่งสามารถเข้าถึงได้จากที่นี่:

[*http://www.bankrate.com/finance/retirement/best-places-retire-how-state-ranks.aspx*](http://www.bankrate.com/finance/retirement/best-places-retire-how-state-ranks.aspx)

ขั้นตอนที่จำเป็นเพื่อเชื่อมต่อกับแหล่งข้อมูลทั้งสองคือ จุดเริ่มต้นของการคิวรีที่เราจะเริ่มกัน

## <a name="connect-to-data"></a>เชื่อมต่อกับข้อมูล
เมื่อต้องการเชื่อมต่อกับข้อมูลใน Power BI Desktop เลือกปุ่ม**รับข้อมูล** จากแท็บ**หน้าแรก**บน ribbon Power BI Desktop จะแสดงเมนูให้เห็นแหล่งข้อมูลที่ใช้บ่อยที่สุด สำหรับรายการทั้งหมดของแหล่งข้อมูลซึ่งสามารถเชื่อมต่อ Power BI Desktop เลือกปุ่ม**เพิ่มเติม...** ที่ด้านล่างของเมนู สำหรับข้อมูลเพิ่มเติม ดู[แหล่งข้อมูลใน Power BI Desktop](https://docs.microsoft.com/power-bi/desktop-data-sources)

![](media/desktop-common-query-tasks/commonquerytasks_getdata.png)

เราจะเริ่มต้นจากการเลือก **Excel** แล้วไปยังเวิร์กบุ๊กที่ต้องการ จากนั้นเลือกเวิร์กบุ๊กนั้น คิวรีจะตรวจสอบเวิร์กบุ๊ก แล้วแสดงข้อมูลที่พบในหน้าต่าง**ตัวนำทาง**

![](media/desktop-common-query-tasks/commonquerytasks_navigator.png)

คุณสามารถเลือก**แก้ไข**เพื่อปรับแก้ หรือจัด*รูปร่าง*ข้อมูลก่อนที่จะโหลดลงใน Power BI Desktop ได้ การแก้ไขคิวรีก่อนทำการโหลดจะมีประโยชน์อย่างยิ่งเมื่อทำงานกับชุดข้อมูลขนาดใหญ่ ที่คุณต้องการตัดทอนข้อมูลบางส่วนออกไปก่อนทำการโหลด เราต้องการทำเช่นนั้น ดังนั้นเราเลือก**แก้ไข**

การเชื่อมต่อกับข้อมูลชนิดอื่น ๆ เป็นเรื่องง่ายพอกัน เรายังต้องการเชื่อมต่อไปยังทรัพยากรเว็บ เลือก**รับข้อมูล\>เพิ่มเติม...**  แล้วเลือก **อื่น ๆ\>เว็บ**

![](media/desktop-common-query-tasks/commonquerytasks_getdata_other.png)

หน้าต่าง**จากเว็บ**ก็จะปรากฏขึ้น ให้คุณพิมพ์ URL ของหน้าเว็บลงไป

![](media/desktop-common-query-tasks/datasources_fromwebbox.png)

เลือก**ตกลง** และเหมือนเช่นเคย Power BI Desktop จะตรวจสอบเวิร์กบุ๊ก และแสดงข้อมูลพบในหน้าต่าง**ตัวนำทาง**

การเชื่อมต่อข้อมูลอื่น ๆ ก็ทำงานคล้ายกัน ถ้าจำเป็นต้องรับรองความถูกต้องเพื่อทำการเชื่อมต่อข้อมูล Power BI Desktop จะถามให้คุณใส่ข้อมูลประจำตัว

สำหรับการสาธิตทีละขั้นตอน ในการเชื่อมต่อกับข้อมูลใน Power BI Desktop ดูที่ [เชื่อมต่อกับข้อมูลใน Power BI Desktop](https://docs.microsoft.com/power-bi/desktop-connect-to-data)

## <a name="shape-and-combine-data"></a>จัดรูปร่าง และรวมข้อมูล
คุณสามารถจัดรูปร่างข้อมูล และรวมข้อมูลด้วย ตัวแก้ไขคิวรี อย่างง่าย ๆ ส่วนนี้จะให้ตัวอย่างสองสามตัวว่าคุณจะจัดรูปร่างข้อมูลได้อย่างไร สำหรับการสาธิตที่ครบถ้วนสมบูรณ์มากขึ้น ดูที่ **[จัดรูปร่างและรวมข้อมูล ด้วย Power BI Desktop](https://docs.microsoft.com/power-bi/desktop-shape-and-combine-data)**

ในส่วนก่อนหน้านี้ เราเชื่อมต่อกับข้อมูลสองชุด – เวิร์กบุ๊ก Excel และทรัพยากรบนเว็บ ทันทีที่โหลดเข้าไปใน ตัวแก้ไขคิวรี เราจะเห็นดังรูปต่อไปนี้ เมื่อเลือกคิวรีจากเว็บเพจ (รายการคิวรีทั้งหมดที่มี ที่แสดงในบานหน้าต่าง**คิวรี** ทางด้านซ้ายของหน้าต่าง ตัวแก้ไขคิวรี)

![](media/desktop-common-query-tasks/commonquerytasks_querypaneloaded.png)

การจัดรูปร่างข้อมูล หมายถึงการแปลงแหล่งข้อมูลให้อยู่ในฟอร์มและรูปแบบที่ตรงตามความต้องการของคุณ ในกรณีนี้ เราไม่ต้องการคอลัมน์แรกที่ชื่อว่า *Header* ดังนั้นเราจะเอาออก

ใน**ตัวแก้ไขคิวรี** คำสั่งหลาย ๆ คำสั่งจะอยู่ใน ribbon และในเมนูคลิกขวาตามบริบท ตัวอย่างเช่น เมื่อคุณคลิกขวาบนคอลัมน์ *Header* จะมีเมนูปรากฏให้คุณเอาคอลัมน์ออก คุณยังสามารถเลือกคอลัมน์ จากนั้นเลือกปุ่ม**เอาคอลัมน์ออก** จาก ribbon ได้

![](media/desktop-common-query-tasks/commonquerytasks_removecolumns.png)

ยังมีวิธีอีกมากที่คุณสามารถใช้จัดรูปร่างข้อมูลในคิวรีนี้ มากมาย คุณสามารถลบแถวใด ๆ จากด้านบน หรือด้านล่าง สามารถเพิ่มคอลัมน์ แยกคอลัมน์ แทนที่ค่า และแก้ไขอื่น ๆ ภายใน ตัวแก้ไขคิวรี เพื่อให้ได้ข้อมูลที่คุณต้องการ

## <a name="group-rows"></a>จัดกลุ่มแถว
ในตัวแก้ไขคิวรี คุณสามารถรวมค่าจากหลายแถวให้กลายเป็นค่าเดียว ซึ่งจะมีประโยชน์เมื่อมาใช้สรุปตัวเลข เช่นจำนวนผลิตภัณฑ์ที่นำเสนอ ยอดขายรวม หรือจำนวนนักเรียนทั้งหมด

ในตัวอย่างนี้ เราจะจัดกลุ่มแถวในชุดข้อมูลการลงทะเบียนเรียนกัน ข้อมูลมาจากเวิร์กบุ๊ก Excel และได้ถูกจัดรูปใน ตัวแก้ไขคิวรี ให้เหลือแต่เฉพาะคอลัมน์เราต้องใช้ เปลี่ยนชื่อตาราง และทำการแปลงสักอื่น ๆ สองสามอย่าง

เรามาลองหาจำนวนหน่วยงานที่แต่ละรัฐมี (ซึ่งรวมถึงเขตโรงเรียน หน่วยงานการศึกษาอื่น ๆ เช่นหน่วยงานบริการภูมิภาค ฯลฯ) เราเลือกคอลัมน์ *State Abbr* แล้วเลือกปุ่ม **จัดกลุ่มตาม** ในแท็บ**แปลง** หรือแท็บ**หน้าแรก** ของ ribbon (**จัดกลุ่มตาม** มีให้ใช้ในทั้งสองแท็บ)

![](media/desktop-common-query-tasks/commonquerytasks_groupby.png)

หน้าต่าง**จัดกลุ่มตาม...** จะปรากฏขึ้น เมื่อ ตัวแก้ไขคิวรี จัดกลุ่มแถว จะสร้างคอลัมน์ใหม่เพื่อใส่ผลลัพธ์ของการ**จัดกลุ่มตาม** คุณสามารถปรับเปลี่ยนการดำเนินการของ **จัดกลุ่มตาม** ดังต่อไปนี้:

1. *จัดกลุ่มตาม* – นี่คือคอลัมน์ที่จะถูกจัดกลุ่ม ตัวแก้ไขคิวรี จะเลือกคอลัมน์ที่คุณเลือกไว้ แต่คุณสามารถเปลี่ยนได้ในหน้าต่างนี้ ไปเป็นคอลัมน์ใดก็ได้ในตาราง
2. *ชื่อคอลัมน์ใหม่* – ตัวแก้ไขคิวรี จะแนะนำชื่อสำหรับคอลัมน์ใหม่ ตามการดำเนินการที่จะใช้จัดกลุ่มคอลัมน์ แต่คุณสามารถตั้งชื่อคอลัมน์ใหม่เป็นอะไรก็ได้ที่คุณต้องการ
3. *การดำเนินการ* – ที่นี่คุณจะระบุการดำเนินการที่ ตัวแก้ไขคิวรี ใช้
4. *เพิ่มการจัดกลุ่ม* และ *เพิ่มการรวม* – ตัวเลือกเหล่านี้ปรากฏขึ้นหลังจากเลือกตัวตัวเลือก**ขั้นสูง** คุณสามารถดำเนินการจัดกลุ่ม (สิ่งที่ **จัดกลุ่มตาม** จะทำ) บนคอลัมน์หลายคอลัมน์ และทำการรวมค่าหลายได้หลากหลายแบบ ทั้งหมดภายในหน้าต่าง **จัดกลุ่มตาม** โดยการดำเนินการเพียงครั้งเดียวได้ ตัวแก้ไขคิวรี จะสร้างคอลัมน์ใหม่ (ตามที่คุณเลือกในหน้าต่างนี้) จากการดำเนินการหลายคอลัมน์ 

เลือกปุ่ม**เพิ่มการจัดกลุ่ม** หรือ**เพิ่มการรวม** เพื่อเพิ่มการจัดกลุ่มหรือการรวมเมื่อต้องการเพิ่มการดำเนินการใน **จัดกลุ่มตาม** คุณสามารถนำการจัดกลุ่มหรือการรวมออก โดยการเลือกไอคอน **...** แล้วเลือก**ลบ** ให้ลองทำดู แล้วดูว่าจะเกิดผลอย่างไร
   
   ![](media/desktop-common-query-tasks/commonquerytasks_groupbynumbered.png)

เมื่อเราเลือก**ตกลง** คิวรีจะดำเนินการ**จัดกลุ่มตาม** และส่งผลลัพธ์กลับมา ดูนั่นสิ – รัฐ โอไฮโอ เท็กซัส อิลลินอยส์ และแคลิฟอร์เนีย ตอนนี้แต่ละรัฐมีหน่วยงานมากกว่าหนึ่งพันหน่วยงาน

![](media/desktop-common-query-tasks/commonquerytasks_groupedresult.png)

และด้วย ตัวแก้ไขคิวรี คุณสามารถนำการดำเนินการปรับรูปร่างล่าสุดออก โดยการเลือก **X** ที่ถัดจากขั้นตอนที่เพิ่งทำเสร็จไปแล้ว ลองไปทดลองทำ และทำซ้ำขั้นตอนถ้าคุณยังไม่ถูกใจกับผลลัพธ์ จนกว่าตัวแก้ไขคิวรี จะจัดรูปร่างข้อมูลในแบบที่คุณต้องการ

## <a name="pivot-columns"></a>Pivot คอลัมน์ 
ด้วย Power BI Desktop คุณสามารถทำ pivot คอลัมน์ และสร้างตารางที่คำนวนค่ารวมสำหรับแต่ละค่าที่ไม่ซ้ำกันในคอลัมน์ ตัวอย่างเช่น ถ้าคุณต้องการทราบจำนวนผลิตภัณฑ์ทั้งหมดของแต่ละประเภท คุณสามารถสร้างตารางที่ทำแบบนั้นได้

ลองมาดูตัวอย่างกัน ตาราง**ผลิตภัณฑ์**ต่อไปนี้ ได้รับการจัดรูปร่าง เพื่อแสดงเฉพาะผลิตภัณฑ์ที่มีชื่อไม่ซ้ำกัน และประเภทที่ผลิตภัณฑ์ถูกจัดเอาไว้ เมื่อต้องสร้างตารางใหม่ที่แสดงการนับจำนวนผลิตภัณฑ์ในแต่ละประเภท (ตามคอลัมน์ *CategoryName*) เลือกคอลัมน์นั้น แล้วเลือก**คอลัมน์ Pivot** จากแท็บ**แปลง**บน ribbon

![](media/desktop-common-query-tasks/pivotcolumns_pivotbutton.png)

หน้าต่าง**คอลัมน์ Pivot** จะปรากฏขึ้น แจ้งให้คุณทราบว่าคอลัมน์ไหนที่จะถูกใช้สร้างคอลัมน์ใหม่ (1) และเมื่อคุณขยาย**ตัวเลือกขั้นสูง**(2) คุณสามารถเลือกฟังก์ชันที่จะนำไปใช้กับค่าที่ได้รับการรวม (3)

![](media/desktop-common-query-tasks/pivotcolumns_pivotdialog.png)

เมื่อคุณเลือก**ตกลง** คิวรีจะแสดงตารางตามคำสั่งการแปลงที่ให้ไว้ในหน้าต่าง**คอลัมน์ Pivot**

![](media/desktop-common-query-tasks/pivotcolumns_pivotcomplete.png)

## <a name="create-custom-columns"></a>สร้างคอลัมน์แบบกำหนดเอง
ในตัวแก้ไขคิวรี คุณสามารถสร้างสูตรแบบกำหนดเอง ที่คำนวนกับหลายคอลัมน์ในตารางของคุณ และใส่ผลลัพธ์ของสูตรคำนวนลงไปยังคอลัมน์ใหม่ (ที่เป็นแบบกำหนดเอง) ตัวแก้ไขคิวรี ช่วยให้การสร้างคอลัมน์แบบกำหนดเองเป็นเรื่องง่าย

ในตัวแก้ไขคิวรี เลือก**คอลัมน์แบบกำหนดเอง** จากแท็บ**เพิ่มคอลัมน์** บน ribbon

![](media/desktop-common-query-tasks/commonquerytasks_customcolumn.png)

หน้าต่างต่อไปนี้จะปรากฏขึ้น ในตัวอย่างนี้ เราจะสร้างคอลัมน์แบบกำหนดเองที่ชื่อ *Percent ELL* ที่คำนวณเปอร์เซ็นต์ของนักเรียนทั้งหมดที่เป็นผู้เรียนภาษาอังกฤษ (English Language Learners, ELL)

![](media/desktop-common-query-tasks/customcolumn_addcustomcolumndialog.png)

เหมือนเช่นขั้นตอนอื่น ๆ ในตัวแก้ไขคิวรี ถ้าคุณไม่ได้ข้อมูลที่คุณต้องการจากคอลัมน์แบบกำหนดเองที่สร้างใหม่ คุณสามารถลบขั้นตอนดังกล่าวจากส่วน **ขั้นตอนที่กำหนดใช้** ของบานหน้าต่าง**การตั้งค่าแบบสอบถาม**โดยการเลือก **X** ที่อยู่ติดกับขั้นตอน **มีการเพิ่มคอลัมน์แบบกำหนดเองแล้ว**

![](media/desktop-common-query-tasks/customcolumn_addedappliedstep.png)

## <a name="query-formulas"></a>คิวรีสูตร
คุณสามารถแก้ไขขั้นตอนที่ตัวแก้ไขคิวรีสร้าง และคุณสามารถสร้างสูตรแบบกำหนดเอง เพื่อควบคุมการเชื่อมต่อ และการจัดรูปร่างข้อมูลของคุณอย่างเที่ยงตรง เมื่อใดก็ตามที่ตัวแก้ไขคิวรี ดำเนินการกระทำบนข้อมูล สูตรที่เกี่ยวข้องจะแสดงอยู่ใน**แถบสูตร** เมื่อต้องการดู**แถบสูตร** กาเครื่องหมายตรง**แถบสูตร** ในแท็บ**มุมมอง** ของ ribbon

![](media/desktop-common-query-tasks/queryformulas_formulabar.png)

ตัวแก้ไขคิวรี เก็บขั้นตอนที่นำไปใช้ในคิวรีแล้ว ให้อยู่ในรูปข้อความที่คุณสามารถดูหรือแก้ไขได้ คุณสามารถดู หรือแก้ไขข้อความสำหรับการใช้คิวรีใดก็ได้โดยใช้ **ตัวแก้ไขขั้นสูง** ซึ่งจะแสดงขึ้นเมื่อคุณเลือก**ตัวแก้ไขขั้นสูง** จากแท็บ**มุมมอง** ของ ribbon

![](media/desktop-common-query-tasks/queryformulas_advancededitorbutton.png)

นี่คือตัวอย่างของ**ตัวแก้ไขขั้นสูง** ที่แสดงขั้นตอนคิวรีที่ใช้กับ **USA\_StudentEnrollment** ขั้นตอนเหล่านี้จะถูกสร้างขึ้นในภาษา Power Query Formula Language ซึ่งมักเรียกว่า **M** สำหรับข้อมูล ดูที่[เรียนรู้เกี่ยวกับสูตร Power Query](https://support.office.com/article/Learn-about-Power-Query-formulas-6bc50988-022b-4799-a709-f8aafdee2b2f) เมื่อต้องการดูข้อกำหนดของตัวภาษาเอง ดูที่[ข้อกำหนด Microsoft Power Query for Excel Formula Language](http://go.microsoft.com/fwlink/?linkid=320633)

![](media/desktop-common-query-tasks/queryformulas_advancededitor.png)

Power BI Desktop มีสูตรคำนวนครอบคลุมหลากหลายประเภท สำหรับข้อมูลเพิ่มเติม และแหล่งอ้างอิง ของสูตรใน ตัวแก้ไขคิวรี ทั้งหมด โปรดเข้าไปที่[ประเภทของสูตร Power Query](https://support.office.com/article/Power-Query-formula-categories-125024ec-873c-47b9-bdfd-b437f8716819)

สูตรในตัวแก้ไขคิวรี แบ่งประเภทได้ดังนี้:

* ตัวเลข
  * ค่าคงที่
  * ข้อมูล
  * การแปลงและการจัดรูปแบบ
  * รูปแบบ
  * การปัดเศษ
  * การดำเนินการ
  * การสุ่ม
  * ตรีโกณมิติ
  * ไบต์
* ข้อความ
  * ข้อมูล
  * การเปรียบเทียบข้อความ
  * การแยก
  * การปรับเปลี่ยน
  * การเป็นสมาชิก
  * การแปลง
* ตรรกะ
* วัน
* เวลา
* วันที่เวลา
* วันที่เวลาและเขตเวลา
* ระยะเวลา
* เรกคอร์ด
  * ข้อมูล
  * การแปลง
  * การเลือก
  * การซีเรียลไลซ์
* รายการ
  * ข้อมูล
  * การเลือก
  * การแปลง
  * การเป็นสมาชิก
  * การดำเนินการทางเซ็ต
  * การเรียงลำดับ
  * ค่าเฉลี่ย
  * การบวก
  * ตัวเลข
  * การสร้าง
* ตาราง
  * การสร้างตาราง
  * การแปลง
  * ข้อมูล
  * การดำเนินการของแถว
  * การดำเนินการคอลัมน์
  * การเป็นสมาชิก
* ค่า
* การดำเนินการทางคณิตศาสตร์
* ชนิดพารามิเตอร์
* เมตาดาต้า
* เข้าถึงข้อมูล
* URI
* รูปแบบไบนารี
  * การอ่านตัวเลข
* ข้อมูลไบนารี
* บรรทัดข้อความ
* นิพจน์
* ฟังก์ชัน
* ข้อผิดพลาด
* ตัวเปรียบเทียบ
* ตัวแยก
* ตัวรวม
* ตัวแทนค่า
* ชนิด

## <a name="next-steps"></a>ขั้นตอนถัดไป
มีมากมายหลากหลายสิ่งที่คุณสามารถทำได้ด้วย Power BI Desktop สำหรับข้อมูลเพิ่มเติมเกี่ยวกับขีดความสามารถ กรุณาดูแหล่งทรัพยากรต่อไปนี้:

* [Power BI Desktop คืออะไร](desktop-what-is-desktop.md)
* [ภาพรวมคิวรี่กับ Power BI Desktop](desktop-query-overview.md)
* [แหล่งข้อมูลใน Power BI Desktop](desktop-data-sources.md)
* [เชื่อมต่อกับข้อมูลใน Power BI Desktop](desktop-connect-to-data.md)
* [จัดรูปร่าง และรวมข้อมูล ด้วย Power BI Desktop](desktop-shape-and-combine-data.md)

