---
title: รีเฟรชชุดข้อมูลที่สร้างขึ้นจากสมุดงาน Excel - ระบบคลาวด์
description: รีเฟรชชุดข้อมูลที่สร้างขึ้นจากสมุดงาน Excel ใน OneDrive หรือ SharePoint Online
author: davidiseminger
ms.reviewer: kayu
ms.service: powerbi
ms.subservice: powerbi-service
ms.topic: conceptual
ms.date: 06/06/2019
ms.author: davidi
LocalizationGroup: Data refresh
ms.openlocfilehash: 3dd64357eaa6e3891703477eb51461881eb0502e
ms.sourcegitcommit: 0e9e211082eca7fd939803e0cd9c6b114af2f90a
ms.translationtype: HT
ms.contentlocale: th-TH
ms.lasthandoff: 05/13/2020
ms.locfileid: "83306795"
---
# <a name="refresh-a-dataset-created-from-an-excel-workbook-on-onedrive-or-sharepoint-online"></a>รีเฟรชชุดข้อมูลที่สร้างขึ้นจากสมุดงาน Excel ใน OneDrive หรือ SharePoint Online

คุณสามารถนำเข้าสมุดงาน Excel ที่เก็บไว้บนเครื่องของคุณ หรือในพื้นที่เก็บข้อมูลบนคลาวด์ เช่น OneDrive สำหรับธุรกิจ หรือ SharePoint Online เราจะดูที่ข้อดีของการใช้พื้นที่เก็บข้อมูลบนคลาวด์สำหรับไฟล์ Excel ของคุณ สำหรับข้อมูลเพิ่มเติมเกี่ยวกับวิธีการนำเข้าไฟล์ Excel ลงใน Power BI ดูที่[รับข้อมูลจากไฟล์สมุดงาน Excel](service-excel-workbook-files.md)

## <a name="what-are-the-advantages"></a>มีข้อดีอะไรบ้าง

การนำเข้าไฟล์จาก OneDrive หรือ SharePoint Online เป็นวิธีที่ดีในการตรวจสอบให้แน่ใจว่างานที่คุณกำลังทำอยู่ใน Excel ยังคงซิงค์กับบริการ Power BI ข้อมูลใด ๆ ที่คุณโหลดลงในแบบจำลองของไฟล์จะได้รับการนำเข้าลงในชุดข้อมูล และจะมีการโหลดรายงานใด ๆ ที่คุณสร้างในไฟล์ลงใน “รายงาน” ใน Power BI ถ้าคุณทำการเปลี่ยนแปลงไฟล์ของคุณใน OneDrive หรือ SharePoint Online เช่น เพิ่มหน่วยวัดใหม่ เปลี่ยนชื่อคอลัมน์ หรือแก้ไขการแสดงวิชวล เมื่อคุณบันทึก การเปลี่ยนแปลงเหล่านั้นจะได้รับการอัปเดตใน Power BI เช่นกัน โดยปกติจะดำเนินการอัปเดตภายในหนึ่งชั่วโมง

เมื่อคุณนำเข้าสมุดงาน Excel จาก OneDrive ส่วนบุคคลของคุณ ข้อมูลใด ๆ ในสมุดงาน เช่น ตารางในแผ่นงานและ/ หรือข้อมูลที่โหลดลงในแบบจำลองข้อมูล Excel และโครงสร้างของแบบจำลองข้อมูล จะได้รับการนำเข้าลงในชุดข้อมูลใหม่ใน Power BI การแสดงวิชวล Power View ใด ๆ จะได้รับการสร้างใหม่ในรายงาน Power BI เชื่อมต่อกับสมุดงานใน OneDrive หรือ SharePoint Online โดยอัตโนมัติเพื่อตรวจสอบการอัปเดตทุก ๆ ชั่วโมง ถ้าสมุดงานมีการเปลี่ยนแปลง Power BI จะรีเฟรชชุดข้อมูลและรายงานในบริการ Power BI

คุณสามารถรีเฟรชชุดข้อมูลในบริการ Power BI เมื่อคุณทำการรีเฟรชด้วยตนเอง หรือรีเฟรชตามกำหนดการในชุดข้อมูล Power BI จะเชื่อมต่อโดยตรงไปยังแหล่งข้อมูลภายนอกเพื่อสร้างคิวรีสำหรับข้อมูลที่อัปเดตแล้ว และโหลดลงในชุดข้อมูล การรีเฟรชชุดข้อมูลจากภายใน Power BI จะไม่รีเฟรชข้อมูลในสมุดงานใน OneDrive หรือ SharePoint Online 

## <a name="whats-supported"></a>รับรองอะไรบ้าง

ใน Power BI **รีเฟรชตอนนี้** และ **กำหนดการรีเฟรช** ใช้กับชุดข้อมูลที่สร้างจากไฟล์ Power BI Desktop ที่นำเข้าจากไดรฟ์ภายในเครื่องที่มีการใช้ “รับข้อมูล/ตัวแก้ไขคิวรี” เพื่อเชื่อมต่อและโหลดข้อมูลจากแหล่งข้อมูลหนึ่งจากหลาย ๆ แหล่งต่อไปนี้:  

### <a name="power-bi-gateway---personal"></a>Power BI Gateway - Personal

* แหล่งข้อมูลออนไลน์ทั้งหมดที่แสดงใน รับข้อมูลและตัวแก้ไขคิวรี ของ Power BI Desktop
* แหล่งข้อมูลภายในองค์กรทั้งหมดที่แสดงอยู่ใน รับข้อมูลและตัวแก้ไขคิวรี ของ Power BI Desktop ยกเว้นไฟล์ Hadoop (HDFS) และ Microsoft Exchange

<!-- Refresh Data sources-->
[!INCLUDE [refresh-datasources](../includes/refresh-datasources.md)]

> [!NOTE]
> เกตเวย์ต้องได้รับการติดตั้ง และเรียกใช้เพื่อให้ Power BI เชื่อมต่อกับแหล่งข้อมูลภายในองค์กร และรีเฟรชชุดข้อมูล
>
>

## <a name="onedrive-or-onedrive-for-business-whats-the-difference"></a>OneDrive หรือ OneDrive สำหรับธุรกิจ ความแตกต่างคืออะไร

ถ้าคุณมีทั้ง OneDrive ส่วนบุคคล และ OneDrive สำหรับธุรกิจ เราแนะนำให้คุณเก็บไฟล์ต่างๆ ที่คุณต้องการนำเข้าไปใน Power BI ใน OneDrive สำหรับธุรกิจ นี่คือสาเหตุว่าทำไม: คุณอาจใช้บัญชีที่ต่างกันสองบัญชีในการลงชื่อเข้าใช้ OneDrive ส่วนบุคคล และ OneDrive สำหรับธุรกิจ

การเชื่อมต่อกับ OneDrive for Business ใน Power BI มักทำได้อย่างราบรื่น เพราะบัญชีที่คุณลงชื่อเข้าใช้ Power BI มักเป็นบัญชีเดียวกับที่ลงชื่อเข้าใช้ใน OneDrive for Business แต่ใน OneDrive ส่วนบุคคล คุณลงชื่อเข้าใช้ด้วย[บัญชี Microsoft](https://account.microsoft.com)

เมื่อคุณลงชื่อเข้าใช้บัญชี Microsoft ของคุณ ตรวจสอบให้แน่ใจว่าเลือก **ให้ฉันลงชื่อเข้าใช้เสมอ** และจากนั้น Power BI จะสามารถซิงโครไนซ์การอัปเดตใด ๆ ที่คุณทำกับไฟล์ใน Power BI Desktop ด้วยชุดข้อมูลใน Power BI  

![ให้ฉันลงชื่อเข้าใช้เสมอ](media/refresh-excel-file-onedrive/refresh_signin_keepmesignedin.png)

ถ้าคุณทำการเปลี่ยนแปลงกับไฟล์ของคุณใน OneDrive ที่ไม่สามารถซิงโครไนซ์กับชุดข้อมูลหรือรายงานใน Power BI เนื่องจากข้อมูลประจำตัวของบัญชี Microsoft ของคุณอาจมีการเปลี่ยนแปลง คุณจะต้องเชื่อมต่อ และนำเข้าไฟล์ของคุณอีกครั้งจาก OneDrive ส่วนบุคคลของคุณ

## <a name="options-for-connecting-to-excel-file"></a>ตัวเลือกสำหรับการเชื่อมต่อไปยังไฟล์ Excel

เมื่อคุณเชื่อมต่อกับสมุดงาน Excel ใน OneDrive สำหรับธุรกิจ หรือ SharePoint Online คุณจะมีสองตัวเลือกเกี่ยวกับวิธีการนำสิ่งที่อยู่ในสมุดงานของคุณลงใน Power BI

[**นำเข้าข้อมูล Excel ลงใน Power BI**](service-excel-workbook-files.md#import-or-connect-to-an-excel-workbook-from-power-bi) – เมื่อคุณนำเข้าสมุดงาน Excel จาก OneDrive สำหรับธุรกิจ หรือ SharePoint Online จะมีการทำงานตามที่อธิบายไว้ข้างต้น

[**เชื่อมต่อ จัดการ และดู Excel ใน Power BI**](service-excel-workbook-files.md#one-excel-workbook--two-ways-to-use-it) – เมื่อใช้ตัวเลือกนี้ ให้คุณสร้างการเชื่อมต่อจาก Power BI กับสมุดงานของคุณใน OneDrive สำหรับธุรกิจ หรือ SharePoint Online

เมื่อคุณเชื่อมต่อกับสมุดงาน Excel ด้วยวิธีนี้ จะไม่มีการสร้างชุดข้อมูลใน Power BI อย่างไรก็ตาม สมุดงานจะปรากฏในบริการ Power BI ภายใต้ “รายงาน” ด้วยไอคอน Excel ที่อยู่ถัดจากชื่อ ซึ่งแตกต่างกับ Excel Online คือเมื่อคุณเชื่อมต่อกับสมุดงานของคุณจาก Power BI ถ้าสมุดงานของคุณมีการเชื่อมต่อกับแหล่งข้อมูลภายนอกที่โหลดข้อมูลลงในแบบจำลองข้อมูล Excel คุณสามารถตั้งค่าการรีเฟรชตามกำหนดการได้

เมื่อคุณตั้งค่ากำหนดการรีเฟรชด้วยวิธีนี้ จะมีความแตกต่างเพียงอย่างเดียวคือ ข้อมูลที่ได้รับการรีเฟรชจะเข้าไปอยู่ในแบบจำลองข้อมูลของสมุดงานใน OneDrive หรือ SharePoint Online แทนที่จะไปอยู่ในชุดข้อมูลใน Power BI

## <a name="how-do-i-make-sure-data-is-loaded-to-the-excel-data-model"></a>ฉันจะแน่ใจได้อย่างไรว่าข้อมูลได้รับการโหลดไปยังแบบจำลองข้อมูล Excel

เมื่อคุณใช้ Power Query (**รับและแปลงข้อมูล** ใน Excel 2016) เพื่อเชื่อมต่อกับแหล่งข้อมูล คุณจะมีหลายตัวเลือกสำหรับตำแหน่งที่จะโหลดข้อมูล เมื่อต้องการตรวจสอบให้แน่ใจว่า คุณโหลดข้อมูลลงในแบบจำลองข้อมูล คุณต้องเลือก**เพิ่มข้อมูลนี้ลงในตัวเลือกแบบจำลองข้อมูล**ใน**โหลดไปยัง**กล่องโต้ตอบ

> [!NOTE]
> รูปภาพนี้แสดง Excel 2016
>
>

ใน**ตัวนำทาง**คลิก**โหลดไปยัง...**  

![โหลดไปยัง... คำสั่ง](media/refresh-excel-file-onedrive/refresh_loadtodm_1.png)

หรือ ถ้าคุณคลิก**แก้ไข**ใน **ตัวนำทาง** ตัวแก้ไขคิวรีจะเปิดขึ้น ซึ่งคุณสามารถคลิก**ปิด & โหลดไปยัง...**  

![ปิด & โหลดไปยัง... คำสั่ง](media/refresh-excel-file-onedrive/refresh_loadtodm_2.png)

จากนั้นใน**โหลดไปยัง**ตรวจสอบให้แน่ใจว่าคุณเลือก**เพิ่มข้อมูลนี้ลงในแบบจำลองข้อมูล**  

![เพิ่มสิ่งนี้ไปยังกล่องกาเครื่องหมายแบบจำลองข้อมูล](media/refresh-excel-file-onedrive/refresh_loadtodm_3.png)

### <a name="what-if-i-use-get-external-data-in-power-pivot"></a>เกิดอะไรขึ้นถ้าฉันใช้ “รับข้อมูลภายนอกใน Power Pivot”

ไม่มีปัญหา เมื่อใดก็ตามที่คุณใช้ Power Pivot เพื่อเชื่อมต่อ และคิวรีข้อมูลจากแหล่งข้อมูลภายในองค์กร หรือแหล่งข้อมูลออนไลน์ ข้อมูลจะได้รับการโหลดลงในแบบจำลองข้อมูลโดยอัตโนมัติ

## <a name="how-do-i-schedule-refresh"></a>ฉันจะกำหนดเวลารีเฟรชได้อย่างไร

เมื่อคุณตั้งค่ากำหนดการรีเฟรช Power BI จะเชื่อมต่อโดยตรงไปยังแหล่งข้อมูลโดยใช้ข้อมูลการเชื่อมต่อและข้อมูลประจำตัวในชุดข้อมูลเพื่อคิวรีข้อมูลที่อัปเดตแล้ว จากนั้นจึงโหลดข้อมูลที่อัปเดตแล้วลงในชุดข้อมูล การแสดงภาพด้วยข้อมูลในรายงานและแดชบอร์ดที่อิงชุดข้อมูลนั้นในบริการของ Power BI จะได้รับการอัปเดตตามไปด้วย

สำหรับรายละเอียดเกี่ยวกับวิธีการตั้งค่าการรีเฟรชตามกำหนดการ ดูที่[กำหนดค่าการรีเฟรชตามกำหนดการ](refresh-scheduled-refresh.md)

## <a name="when-things-go-wrong"></a>เมื่อเกิดสิ่งผิดปกติขึ้น

เมื่อเกิดสิ่งผิดปกติขึ้น ซึ่งโดยปกติจะเกิดเนื่องจาก Power BI ไม่สามารถลงชื่อเข้าใช้แหล่งข้อมูล หรือถ้าชุดข้อมูลเชื่อมต่อกับแหล่งข้อมูลภายในองค์กร เกตเวย์จะออฟไลน์ ตรวจสอบให้แน่ใจว่า Power BI สามารถลงชื่อเข้าใช้แหล่งข้อมูล ถ้ามีการเปลี่ยนแปลงรหัสผ่านที่คุณลงชื่อเพื่อเข้าใช้แหล่งข้อมูล หรือ Power BI ได้รับการให้ออกจากแหล่งข้อมูล กรุณาลองลงชื่อเข้าใช้แหล่งข้อมูลของคุณอีกครั้งในข้อมูลประจำตัวของแหล่งข้อมูล

โปรดแน่ใจว่าคุณออกจาก**ส่งอีเมล์แจ้งเตือนเมื่อการรีเฟรชล้มเหลวให้ฉันตรวจสอบ** คุณต้องทราบทันทีว่าการรีเฟรชตามกำหนดการล้มเหลวหรือไม่

## <a name="important-notes"></a>หมายเหตุสำคัญ

การรีเฟรชไม่ได้รับการสนับสนุนสำหรับฟีด OData ที่เชื่อมต่อ และคิวรีจาก Power Pivot เมื่อใช้ฟีด OData เป็นแหล่งข้อมูล ให้ใช้ Power Query

## <a name="troubleshooting"></a>แนวทางการแก้ไขปัญหา

การรีเฟรชข้อมูลอาจไม่เป็นไปตามที่คาดไว้ในบางครั้ง โดยทั่วไปแล้วเป็นปัญหาที่เกี่ยวข้องกับเกตเวย์ โปรดดูที่บทความแก้ไขปัญหาเกตเวย์สำหรับเครื่องมือและปัญหาที่ทราบแล้ว

- [การแก้ไขปัญหา เกตเวย์ข้อมูลในองค์กร](service-gateway-onprem-tshoot.md)
- [แก้ไขปัญหาเกตเวย์ Power BI - ส่วนบุคคล](service-admin-troubleshooting-power-bi-personal-gateway.md)

มีคำถามเพิ่มเติมหรือไม่ [ลองไปที่ชุมชน Power BI](https://community.powerbi.com/)
